<?xml version="1.0" encoding="UTF-8"?>
<!--For PDF version (standard)-->
<!-- <?xml-stylesheet href="docbook/xsl/fo/docbook.xsl" type="text/xsl" ?>-->
<!--For PDF version-->
<!-- <?xml-stylesheet href="ONVIF-stylesheets/onvif-specification-fo-us.xsl" type="text/xsl" ?>-->
<!--For online version-->
<?xml-stylesheet href="docbook-css/docbook.xsl" type="text/xsl" ?>
<!--For PDF version - New ONVIF-->
<!--<?xml-stylesheet href="../ONVIFNew-stylesheets/onvif-specification-fo-us.xsl" type="text/xsl" ?>-->
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xml="http://www.w3.org/XML/1998/namespace" xsi:schemaLocation="http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd" version="0.1" xml:id="ONVIF_Profile_Imaging_Client_TS">
  <info>
    <orgname>
      <phrase>
        <trademark class="registered">ONVIF</trademark>
      </phrase>
    </orgname>
    <title>Base Device Test Specification</title>
    <subtitle>Version 21.12</subtitle>
    <date>December 2021</date>
    <copyright>
        <year>2021</year>
      <holder>ONVIF, Inc. All rights reserved.</holder>
    </copyright>
    <address>
      <uri>www.onvif.org</uri>
    </address>
    <legalnotice role="notices">
      <para>
        Recipients of this document may copy, distribute, publish, or display this
        document so long as this copyright notice, license and disclaimer are retained with
        all copies of the document. No license is granted to modify this document.
      </para>
      <para>
        THIS DOCUMENT IS PROVIDED "AS IS," AND THE CORPORATION AND ITS MEMBERS AND THEIR
        AFFILIATES, MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT
        NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
        NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THIS DOCUMENT ARE SUITABLE FOR ANY
        PURPOSE; OR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY PATENTS,
        COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.
      </para>
      <para>
        IN NO EVENT WILL THE CORPORATION OR ITS MEMBERS OR THEIR AFFILIATES BE LIABLE FOR
        ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES,
        ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT, WHETHER OR
        NOT (1) THE CORPORATION, MEMBERS OR THEIR AFFILIATES HAVE BEEN ADVISED OF THE
        POSSIBILITY OF SUCH DAMAGES, OR (2) SUCH DAMAGES WERE REASONABLY FORESEEABLE, AND
        ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT. THE
        FOREGOING DISCLAIMER AND LIMITATION ON LIABILITY DO NOT APPLY TO, INVALIDATE, OR
        LIMIT REPRESENTATIONS AND WARRANTIES MADE BY THE MEMBERS AND THEIR RESPECTIVE
        AFFILIATES TO THE CORPORATION AND OTHER MEMBERS IN CERTAIN WRITTEN POLICIES OF THE
        CORPORATION.
      </para>
    </legalnotice>
    <revhistory>
      <revision>
        <revnumber>1.02.4</revnumber>
        <date>Jun 29, 2011</date>
        <revdescription>
          <para>
            First issue of Base Test Specification
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>11.12</revnumber>
        <date>Dec 22, 2011</date>
        <revdescription>
          <para>
            New version numbering scheme has been applied.
          </para>
          <para>
            Requirement level terms have been removed.
          </para>
          <para>
            Refine/add capabilities related test cases.
          </para>
          <para>
            Add namespace handling test cases in Event and Discovery test
          </para>
          <para>
            Add several Relay Output test cases
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>12.06</revnumber>
        <date>Jun 18, 2012</date>
        <revdescription>
          <para>
            GetServices and Device Management Service Capabilities test cases have been added.
          </para>
          <para>
            HTTP Digest Security test cases have been added.
          </para>
          <para>
            Deprecated most Event test cases with new ones that include validation of WS-Addressing elements.
          </para>
          <para>
            Event Service Capabilities test cases have been added.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>12.12</revnumber>
        <date>Dec 20, 2012</date>
        <revdescription>
          <para>
            BASIC NOTIFICATION INTERFACE – NOTIFY and BASIC NOTIFICATION INTERFACE - NOTIFY FILTER were updated with Test Case ID change.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>13.06</revnumber>
        <date>Jun, 2013</date>
        <revdescription>
          <para>
            SET NETWORK DEFAULT GATEWAY CONFIGURATION - IPV4 and SET NETWORK DEFAULT GATEWAY CONFIGURATION – IPV6 were updated with Test Cases ID change.
          </para>
          <para>
            BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER, BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER, BASIC NOTIFICATION INTERFACE - INVALID TOPIC EXPRESSION, BASIC NOTIFICATION INTERFACE – UNSUBSCRIBE, BASIC NOTIFICATION INTERFACE - RESOURCE UNKNOWN, REALTIME PULLPOINT SUBSCRIPTION - INVALID MESSAGE CONTENT FILTER, REALTIME PULLPOINT SUBSCRIPTION - INVALID TOPIC EXPRESSION, REALTIME PULLPOINT SUBSCRIPTION – UNSUBSCRIBE, REALTIME PULLPOINT SUBSCRIPTION - TIMEOUT were updated with Test Cases ID change.
          </para>
          <para>
            Annex A.17 was updated.
          </para>
          <para>
            Annex A.18 was added.
          </para>
          <para>
            IO COMMAND SETRELAYOUTPUTSETTINGS – INVALID TOKEN and IO COMMAND SETRELAYOUTPUTSTATE – INVALID TOKEN were updated with Test Cases ID change.
          </para>
          <para>
            IPV4 LINK LOCAL ADDRESS was updated.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>13.12</revnumber>
        <date>Dec, 2013</date>
        <revdescription>
          <para>
            New Seek test cases were added:
          </para>
          <para>
            SEEK EVENTS
          </para>
          <para>
            SEEK EVENTS – REVERSE
          </para>
          <para>
            SEEK EVENTS – BEGIN OF BUFFER
          </para>
          <para>
            New IP Filtering test cases were added:
          </para>
          <para>
            GET IP ADDRESS FILTER
          </para>
          <para>
            SET IP ADDRESS FILTER – IPv4
          </para>
          <para>
            ADD IP ADDRESS FILTER – IPv4
          </para>
          <para>
            REMOVE IP ADDRESS FILTER – IPv4
          </para>
          <para>
            New capabilities test case was added:
          </para>
          <para>
            GET SERVICES – ADVANCED SECURITY SERVICE
          </para>
          <para>
            New event test case was added:
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – PULLMESSAGES  AS KEEP-ALIVE
          </para>
          <para>
            The following test cases were updated with Id change
          </para>
          <para>
            IPV4 LINK LOCAL ADDRESS
          </para>
          <para>
            GET NETWORK PROTOCOLS CONFIGURATION
          </para>
          <para>
            SET NETWORK PROTOCOLS CONFIGURATION
          </para>
          <para>
            SET NETWORK PROTOCOLS CONFIGURATION - UNSUPPORTED PROTOCOLS
          </para>
          <para>
            SYSTEM COMMAND SETSYSTEMDATEANDTIME
          </para>
          <para>
            SYSTEM COMMAND SETSYSTEMDATEANDTIME USING NTP
          </para>
          <para>
            BASIC NOTIFICATION INTERFACE - INVALID TOPIC EXPRESSION
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION - INVALID TOPIC EXPRESSION
          </para>
          <para>
            APP_MAX_DELAY was renamed to DISCOVERY_TIMEOUT.
          </para>
          <para>
            Description of DISCOVERY_TIMEOUT was updated.
          </para>
          <para>
            Description in Annex A.7 was updated.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>14.06</revnumber>
        <date>Jun, 2014</date>
        <revdescription>
          <para>
            The following test cases were updated with Id change:
          </para>
          <para>
            DEVICE SCOPES CONFIGURATION
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – PULLMESSAGES  AS KEEP-ALIVE
          </para>
          <para>
            SEEK EVENTS
          </para>
          <para>
            SEEK EVENTS – REVERSE
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>14.12</revnumber>
        <date>Dec, 2014</date>
        <revdescription>
          <para>
            The following test cases were updated with Id change:
          </para>
          <para>
            SECURITY COMMAND CREATEUSERS
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – PULLMESSAGES  AS KEEP-ALIVE
          </para>
          <para>
            The following new test cases were added:
          </para>
          <para>
            GET SERVICES – ACCESS RULES SERVICE
          </para>
          <para>
            GET SERVICES – CREDENTIALS SERVICE
          </para>
          <para>
            GET SYSTEM URIS
          </para>
          <para>
            START SYSTEM RESTORE
          </para>
          <para>
            START SYSTEM RESTORE – INVALID BACKUP FILE
          </para>
          <para>
            GET REMOTE USER
          </para>
          <para>
            SET REMOTE USER
          </para>
          <para>
            The following new annexes were added:
          </para>
          <para>
            Annex A.20 TooManyUsers fault check
          </para>
          <para>
            Annex  A.21	Get service capabilities
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>15.06</revnumber>
        <date>Jun, 2015</date>
        <revdescription>
          <para>
            The following test cases were added:
          </para>
          <para>
            GET SERVICES – SCHEDULE SERVICE
          </para>
          <para>
            The following test cases were updated:
          </para>
          <para>
            IPV4 LINK LOCAL ADDRESS
          </para>
          <para>
            The following new annexes were updated:
          </para>
          <para>
            A.17	Action URI’s for Event Service Messages
          </para>
          <para>
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.01</revnumber>
        <date>Dec, 2015</date>
        <revdescription>
          <para>
            The following test cases were added:
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION - SET SYNCHRONIZATION POINT
          </para>
          <para>
            BASIC NOTIFICATION INTERFACE - SET SYNCHRONIZATION POINT
          </para>
          <para>
            The tests: DEVICE-3-1-14, DEVICE-3-1-8, DEVICE-3-1-15 and IPCONFIG-1-1-5 have been updated.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.06</revnumber>
        <date>Mar 08, 2016</date>
        <revdescription>
          <para>
            The tests EVENT-3-1-26, EVENT-3-1-27 have been added
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.06</revnumber>
        <date>Mar 15, 2016</date>
        <revdescription>
          <para>
            The tests EVENT-3-1-28 - EVENT-3-1-31 have been added
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.06</revnumber>
        <date>May 15, 2016</date>
        <revdescription>
          <para>
            Auxiliary operation section and test case added
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.07</revnumber>
        <date>Jul 08, 2016</date>
        <revdescription>
          <para>
            Used GetServiceCapabilities to find out which auxiliary commands are available (not GetCapabilities)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>16.12</revnumber>
        <date>Dec 08, 2016</date>
        <revdescription>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – DIGITAL INPUT EVENT was moved from ONVIF Base Test specification to ONVIF Device IO Test specification.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.01</revnumber>
        <date>Jan 09, 2017</date>
        <revdescription>
          <para>
            Monitoring Events Item was added (moved from ONVIF Profile Q  Test Specification)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.02</revnumber>
        <date>Feb 06, 2017</date>
        <revdescription>
          <para>
            The following test cases have been updated:
          </para>
          <para>
            EVENT-2-1-24 BASIC NOTIFICATION INTERFACE - SET SYNCHRONIZATION POINT
          </para>
          <para>
            EVENT-3-1-25 REALTIME PULLPOINT SUBSCRIPTION – SET SYNCHRONIZATION POINT
          </para>
          <para>
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.02</revnumber>
        <date>Feb 09, 2017</date>
        <revdescription>
          <para>
            The following test case was added according to #1230:
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – PULLMESSAGES TIMEOUT
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.03</revnumber>
        <date>Feb 20, 2017</date>
        <revdescription>
          <para>
            The following test case were added according to #1274:
          </para>
          <para>
            BASIC NOTIFICATION INTERFACE – CONJUNCTION IN NOTIFY FILTER (OR OPERATION)
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – CONJUNCTION IN PULLMESSAGES FILTER (OR OPERATION)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Mar 02, 2017</date>
        <revdescription>
          <para>
            Last Clock Synchronization change event (SetSystemDateAndTime) was updated according to #1272
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Mar 06, 2017</date>
        <revdescription>
          <para>
            The following test cases were removed (moved into ONVIF Imaging test spec) according to #1352:
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – IMAGE TOO BLURRY
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – IMAGE TOO DARK
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – IMAGE TOO BRIGHT
          </para>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – GLOBAL SCENE CHANGE
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Mar 15, 2017</date>
        <revdescription>
          <para>
            REALTIME PULLPOINT SUBSCRIPTION – RELAY EVENT was removed according to #1364
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Apr 07, 2017</date>
        <revdescription>
          <para>
            GET DYNAMIC DNS CONFIGURATION added according to #1341
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Apr 25, 2017</date>
        <revdescription>
          <para>
            SET DYNAMIC DNS CONFIGURATION added according to #1341
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>May 23, 2017</date>
        <revdescription>
          <para>
            The following test cases were updated according #1412:
          </para>
          <para>
            DEVICE-3-1-4 SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID TIMEZONE
          </para>
          <para>
            DEVICE-3-1-5 SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID DATE
          </para>
          <para>
            The following test case was added according #1374:
          </para>
          <para>
            DEVICE-1-1-30 GET SERVICES AND GET CAPABILITIES CONSISTENCY
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>17.06</revnumber>
        <date>Jun 21, 2017</date>
        <revdescription>
          <para>
            Events Test Cases section and related parts was moved to separate document Event Handling Test Specification.
          </para>
          <para>
            Current document name was changed from Base Test Specification to Base Device Test Specification.
          </para>
          <para>
            The document formating were updated.
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.06</revnumber>
        <date>Jun 21, 2018</date>
        <revdescription>
          <para>Reformatting document using new template</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Aug 16, 2018</date>
        <revdescription>
          <para>The following added according to #1690:</para>
          <para>DEVICE-1-1-31 GET SERVICES - XADDR</para>
          <para>Annex A.23 Check XAddr</para>
          <para>Annex A.24 Configuring HTTPS if Required</para>
          <para>Annex A.25 Configuring HTTPS using Advanced Security</para>
          <para>Annex A.26 Add server certificate assignment with corresponding certification path, self-signed certificate and RSA key pair</para>
          <para>Annex A.27 Add server certificate assignment with corresponding certification path, CA certificate and RSA key pair</para>
          <para>Annex A.28 Create an RSA key pair</para>
          <para>Annex A.29 Subject for a server certificate</para>
          <para>Annex A.30 Provide CA certificate</para>
          <para>Annex A.31 Determine RSA key length</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Oct 1, 2018</date>
        <revdescription>
          <para>
            The following were updated in the scope of #1683:
          </para>
          <para>
            IP Configuration (updated)
          </para>
          <para>
            IPCONFIG-1-1-1 IPV4 STATIC IP (removed)
          </para>
          <para>
            IPCONFIG-2-1-1 IPV6 STATIC IP (removed)
          </para>
          <para>
            DISCOVERY-1-1-1 HELLO MESSAGE (removed)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Nov 14, 2018</date>
        <revdescription>
          <para>
            The following were updated in the scope of #1341:
          </para>
          <para>
            DEVICE-2-1-37 SET DYNAMIC DNS CONFIGURATION (TTL value in 5, 11, 17 steps updated; check in 10, 16, 23 steps changed)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Nov 15, 2018</date>
        <revdescription>
          <para>
            The following were updated in the scope of #1653:
          </para>
          <para>
            Test DEVICE-1-1-26 was renamed ("GET SERVICES – ADVANCED SECURITY SERVICE" was replaced with "GET SERVICES – SECURITY CONFIGURATION SERVICE")
          </para>
          <para>
            DEVICE-1-1-26 GET SERVICES – SECURITY CONFIGURATION SERVICE ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.24 Configuring HTTPS if Required ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.24 Configuring HTTPS using Advanced Security ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.26 Add server certificate assignment with corresponding certification path, self-signed certificate and RSA key pair ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.27 Add server certificate assignment with corresponding certification path, CA certificate and RSA key pair ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.28 Create an RSA key pair ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
          <para>
            Annex A.31 Determine RSA key length ("Advanced Security Service" was replaced with "Security Configuration Service" in many places)
          </para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>18.12</revnumber>
        <date>Dec 21, 2018</date>
        <revdescription>
          <para>Switching Hub description in 'Network Configuration for DUT' section was updated according to #1737</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Sep 03, 2020</date>
        <revdescription>
          <para>The following test case was updated according to #1983</para>
          <para>DEVICE-2-1-37 SET DYNAMIC DNS CONFIGURATION (steps 12 and 15 were updated to accept fault, step 17 was added)</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Sep 25, 2020</date>
        <revdescription>
          <para>Pre-Requisites of the following test cases were updated with adding of User Configuration feature according to #2093</para>
          <para>DEVICE-4-1-1 SECURITY COMMAND GETUSERS</para>
          <para>DEVICE-4-1-3 SECURITY COMMAND CREATEUSERS ERROR CASE</para>
          <para>DEVICE-4-1-4 SECURITY COMMAND DELETEUSERS</para>
          <para>DEVICE-4-1-5 SECURITY COMMAND DELETEUSERS ERROR CASE</para>
          <para>DEVICE-4-1-6 SECURITY COMMAND DELETEUSERS DELETE ALL USERS</para>
          <para>DEVICE-4-1-7 SECURITY COMMAND SETUSER</para>
          <para>DEVICE-4-1-8 SECURITY COMMAND USER MANAGEMENT ERROR CASE</para>
          <para>DEVICE-4-1-9 SECURITY COMMAND CREATEUSERS</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Nov 08, 2020</date>
        <revdescription>
          <para>Pre-Requisites of the following test cases were updated with adding of Network Configuration feature according to #2094</para>
          <para>DEVICE-2-1-1	NETWORK COMMAND HOSTNAME CONFIGURATION</para>
          <para>DEVICE-2-1-3	NETWORK COMMAND SETHOSTNAME TEST ERROR CASE</para>
          <para>DEVICE-2-1-4	GET DNS CONFIGURATION</para>
          <para>DEVICE-2-1-5	SET DNS CONFIGURATION - SEARCHDOMAIN</para>
          <para>DEVICE-2-1-6	SET DNS CONFIGURATION - DNSMANUAL IPV4</para>
          <para>DEVICE-2-1-7	SET DNS CONFIGURATION - DNSMANUAL IPV6</para>
          <para>DEVICE-2-1-8	SET DNS CONFIGURATION - FROMDHCP</para>
          <para>DEVICE-2-1-9	DNS CONFIGURATION - DNSMANUAL INVALID IPV4</para>
          <para>DEVICE-2-1-10	SET DNS CONFIGURATION - DNSMANUAL INVALID IPV6</para>
          <para>DEVICE-2-1-11	GET NTP CONFIGURATION</para>
          <para>DEVICE-2-1-12	SET NTP CONFIGURATION - NTPMANUAL IPV4</para>
          <para>DEVICE-2-1-13	SET NTP CONFIGURATION - NTPMANUAL IPV6</para>
          <para>DEVICE-2-1-14	SET NTP CONFIGURATION - FROMDHCP</para>
          <para>DEVICE-2-1-15	SET NTP CONFIGURATION - NTPMANUAL INVALID IPV4</para>
          <para>DEVICE-2-1-16	SET NTP CONFIGURATION - NTPMANUAL INVALID IPV6</para>
          <para>DEVICE-2-1-17	GET NETWORK INTERFACE CONFIGURATION</para>
          <para>DEVICE-2-1-18	SET NETWORK INTERFACE CONFIGURATION - IPV4</para>
          <para>DEVICE-2-1-19	SET NETWORK INTERFACE CONFIGURATION - IPV6</para>
          <para>DEVICE-2-1-20	SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4</para>
          <para>DEVICE-2-1-21	SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</para>
          <para>DEVICE-2-1-25	GET NETWORK DEFAULT GATEWAY CONFIGURATION</para>
          <para>DEVICE-2-1-28	SET NETWORK DEFAULT GATEWAY CONFIGURATION - INVALID IPV4</para>
          <para>DEVICE-2-1-29	SET NETWORK DEFAULT GATEWAY CONFIGURATION - INVALID IPV6</para>
          <para>DEVICE-2-1-30	SET NETWORK DEFAULT GATEWAY CONFIGURATION - IPV4</para>
          <para>DEVICE-2-1-31	SET NETWORK DEFAULT GATEWAY CONFIGURATION - IPV6</para>
          <para>DEVICE-2-1-32	NETWORK COMMAND SETHOSTNAME TEST</para>
          <para>DEVICE-2-1-33	GET NETWORK PROTOCOLS CONFIGURATION</para>
          <para>DEVICE-2-1-34	SET NETWORK PROTOCOLS CONFIGURATION</para>
          <para>DEVICE-2-1-35	SET NETWORK PROTOCOLS CONFIGURATION - UNSUPPORTED PROTOCOLS</para>
          <para>DEVICE-2-1-36	GET DYNAMIC DNS CONFIGURATION</para>
          <para>DEVICE-2-1-37	SET DYNAMIC DNS CONFIGURATION</para>
          <para>DEVICE-6-1-1	DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR EACH TAG)</para>
          <para>DEVICE-6-1-2	DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR PARENT TAG)</para>
          <para>DEVICE-6-1-3	DEVICE MANAGEMENT - NAMESPACES (NOT STANDARD PREFIXES)</para>
          <para>DEVICE-6-1-4	DEVICE MANAGEMENT - NAMESPACES (DIFFERENT PREFIXES FOR THE SAME NAMESPACE)</para>
          <para>DEVICE-6-1-5	DEVICE MANAGEMENT - NAMESPACES (THE SAME PREFIX FOR DIFFERENT NAMESPACES)</para>
          <para>DEVICE-7-1-1	GET IP ADDRESS FILTER</para>
          <para>DEVICE-7-1-2	SET IP ADDRESS FILTER – IPv4</para>
          <para>DEVICE-7-1-3	ADD IP ADDRESS FILTER – IPv4</para>
          <para>DEVICE-7-1-4	REMOVE IP ADDRESS FILTER – IPv4</para>
          <para>IPCONFIG-1-1-3	IPV4 DHCP</para>
          <para>IPCONFIG-1-1-5	IPV4 LINK LOCAL ADDRESS</para>
          <para>IPCONFIG-2-1-2	IPV6 STATELESS IP CONFIGURATION - ROUTER ADVERTISEMENT</para>
          <para>IPCONFIG-2-1-3	IPV6 STATELESS IP CONFIGURATION - NEIGHBOUR DISCOVERY</para>
          <para>IPCONFIG-2-1-4	IPV6 STATEFUL IP CONFIGURATION</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Nov 08, 2020</date>
        <revdescription>
          <para>Pre-Requisites of the following test cases were updated with adding of Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile Q scope or Profile T scope according to #2094</para>
          <para>DEVICE-3-1-4	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID TIMEZONE</para>
          <para>DEVICE-3-1-5	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID DATE</para>
          <para>DEVICE-3-1-6	SYSTEM COMMAND FACTORY DEFAULT HARD</para>
          <para>DEVICE-3-1-7	SYSTEM COMMAND FACTORY DEFAULT SOFT</para>
          <para>DEVICE-3-1-11	SYSTEM COMMAND SETSYSTEMDATEANDTIME</para>
          <para>DEVICE-3-1-12	SYSTEM COMMAND SETSYSTEMDATEANDTIME USING NTP</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>20.12</revnumber>
        <date>Nov 25, 2020</date>
        <revdescription>
          <para>DEVICE-1-1-1 GET WSDL URL was removed according to #2109</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.06</revnumber>
        <date>Feb 01, 2021</date>
        <revdescription>
          <para>The following test case was updated according to #2124: </para>
          <para>DEVICE-1-1-18 DEVICE SERVICE CAPABILITIES (step 5 added)</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.06</revnumber>
        <date>Feb 08, 2021</date>
        <revdescription>
          <para>The following test cases were updated according to #2122: </para>
          <para>DEVICE-6-1-1	DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR EACH TAG)</para>
          <para>DEVICE-6-1-2	DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR PARENT TAG)</para>
          <para>DEVICE-6-1-3	DEVICE MANAGEMENT - NAMESPACES (NOT STANDARD PREFIXES)</para>
          <para>DEVICE-6-1-4	DEVICE MANAGEMENT - NAMESPACES (DIFFERENT PREFIXES FOR THE SAME NAMESPACE)</para>
          <para>DEVICE-6-1-5	DEVICE MANAGEMENT - NAMESPACES (THE SAME PREFIX FOR DIFFERENT NAMESPACES)</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.06</revnumber>
        <date>Apr 06, 2021</date>
        <revdescription>
          <para>The following test cases were updated according to #2124:</para>
          <para>A.13 Procedure to Turn Off IPv4 DHCP (step 4.4 updated, step 4.5 added)</para>
          <para>A.15 Procedure to Turn Off IPv6 DHCP (step 4.4 updated, step 4.5 added)</para>
          <para>A.8 Restore Network Settings (step 4 updated, step 5 added)</para>
          <para>DEVICE-3-1-8 SYSTEM COMMAND REBOOT (step 5 updated, step 6 added)</para>
          <para>DEVICE-2-1-18 SET NETWORK INTERFACE CONFIGURATION - IPV4 (step 9 updated, step 10 added)</para>
          <para>DEVICE-2-1-19 SET NETWORK INTERFACE CONFIGURATION - IPV6 (step 9 updated, step 10 added)</para>
          <para>DEVICE-9-1-4 Last Reboot event (Status change) (step 10 and step 11 changed)</para>
          <para>IPCONFIG-2-1-2 IPV6 STATELESS IP CONFIGURATION - NEIGHBOUR DISCOVERY (step 9 updated, step 10 added)</para>
          <para>IPCONFIG-2-1-3	IPV6 STATELESS IP CONFIGURATION - ROUTER ADVERTISEMENT	(step 9 updated, step 10 added)</para>
          <para>IPCONFIG-2-1-4	IPV6 STATEFUL IP CONFIGURATION (step 9 updated, step 10 added)</para>
          <para>Discovery added into Pre-Requisite of the following test cases:</para>
          <para>DEVICE-2-1-8 SET DNS CONFIGURATION - FROMDHCP</para>
          <para>DEVICE-2-1-14 SET NTP CONFIGURATION - FROMDHCP</para>
          <para>DEVICE-3-1-14 START SYSTEM RESTORE</para>
          <para>DEVICE-3-1-15 START SYSTEM RESTORE – INVALID BACKUP FILE</para>
          <para>DISCOVERY-1-1-2 HELLO MESSAGE VALIDATION</para>
          <para>DISCOVERY-1-1-3 SEARCH BASED ON DEVICE SCOPE TYPES</para>
          <para>DISCOVERY-1-1-4 SEARCH WITH OMITTED DEVICE AND SCOPE TYPES</para>
          <para>DISCOVERY-1-1-5 RESPONSE TO INVALID SEARCH REQUEST</para>
          <para>DISCOVERY-1-1-6 SEARCH USING UNICAST PROBE MESSAGE</para>
          <para>DISCOVERY-1-1-9 DISCOVERY MODE CONFIGURATION</para>
          <para>DISCOVERY-1-1-10 SOAP FAULT MESSAGE</para>
          <para>DISCOVERY-1-1-11 DEVICE SCOPES CONFIGURATION</para>
          <para>DISCOVERY-2-1-1 DISCOVERY - NAMESPACES (DEFAULT NAMESPACES FOR EACH TAG)</para>
          <para>DISCOVERY-2-1-2 DISCOVERY - NAMESPACES (DEFAULT NAMESPACES FOR PARENT TAG)</para>
          <para>DISCOVERY-2-1-3 DISCOVERY - NAMESPACES (NOT STANDARD PREFIXES)</para>
          <para>DISCOVERY-2-1-4 DISCOVERY - NAMESPACES (DIFFERENT PREFIXES FOR THE SAME NAMESPACE)</para>
          <para>DISCOVERY-2-1-5 DISCOVERY - NAMESPACES (THE SAME PREFIX FOR DIFFERENT NAMESPACES)</para>
          <para>IPCONFIG-1-1-3 IPV4 DHCP</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.06</revnumber>
        <date>May 26, 2021</date>
        <revdescription>
          <para>Profile D was added as Pre-Requisite according to #2157:</para>
          <para>DEVICE-3-1-4	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID TIMEZONE</para>
          <para>DEVICE-3-1-5	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID DATE</para>
          <para>DEVICE-3-1-6	SYSTEM COMMAND FACTORY DEFAULT HARD</para>
          <para>DEVICE-3-1-7	SYSTEM COMMAND FACTORY DEFAULT SOFT</para>
          <para>DEVICE-3-1-11	SYSTEM COMMAND SETSYSTEMDATEANDTIME</para>
          <para>DEVICE-3-1-12	SYSTEM COMMAND SETSYSTEMDATEANDTIME USING NTP</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.12</revnumber>
        <date>Oct 07, 2021</date>
        <revdescription>
          <para>The following tests were moved to Base Device Test Specification according to #2204:</para>
          <para>DEVICE-3-1-16 Firmware Upload</para>
          <para>DEVICE-3-1-17 Invalid Firmware Upload</para>
        </revdescription>
      </revision>
      <revision>
        <revnumber>21.12</revnumber>
        <date>Dec 15, 2021</date>
        <revdescription>
          <para>Profile Q scope was removed from the Pre-Requisites of the following test cases according to #2204</para>
          <para>DEVICE-3-1-4	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID TIMEZONE</para>
          <para>DEVICE-3-1-5	SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID DATE</para>
          <para>DEVICE-3-1-6	SYSTEM COMMAND FACTORY DEFAULT HARD</para>
          <para>DEVICE-3-1-7	SYSTEM COMMAND FACTORY DEFAULT SOFT</para>
          <para>DEVICE-3-1-11	SYSTEM COMMAND SETSYSTEMDATEANDTIME</para>
          <para>DEVICE-3-1-12	SYSTEM COMMAND SETSYSTEMDATEANDTIME USING NTP</para>
        </revdescription>
      </revision>
    </revhistory>
  </info>
  <chapter xml:id="s.intro">
    <title>Introduction</title>
    <para>
      The goal of the ONVIF test specification set is to make it possible to realize fully interoperable
      IP physical security implementation from different vendors. The set of ONVIF test specification describes
      the test cases need to verify the [ONVIF Network Interface Specs] and [ONVIF Conformance] requirements.
      In addition, the test cases are to be basic inputs for some Profile specification requirements.
      It also describes the test framework, test setup, pre-requisites, test policies needed for the execution
      of the described test cases.
    </para>
    <para>
      This ONVIF Base Test Specification acts as a supplementary document to the [ONVIF Network Interface Specs],
      illustrating test cases that need to be executed and passed. And also this specification also acts as an input document
      to the development of test tool which will be used to test the ONVIF device implementation conformance towards ONVIF standard.
      As the test tool performs as a Client during testing, this test tool is referred as ONVIF Client hereafter.
    </para>
    <section xml:id="s.intro.scope">
      <title>Scope</title>
      <para>
        This ONVIF Base Test Specification defines and regulates the conformance testing procedure for the ONVIF conformant devices. Conformance testing is meant to be functional black-box testing. The objective of this specification is to provide the test cases to test individual requirements of ONVIF devices according to ONVIF core services which are defined in [ONVIF Network Interface Specs].
      </para>
      <para>
        The principal intended purposes are:
        <itemizedlist>
          <listitem>
            <para>
              Provide self-assessment tool for implementations.
            </para>
          </listitem>
          <listitem>
            <para>
              Provide comprehensive test suite coverage for [ONVIF Network Interface Specs].
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        This specification does not address the following:
        <itemizedlist>
          <listitem>
            <para>
              Product use cases and non-functional (performance and regression) testing.
            </para>
          </listitem>
          <listitem>
            <para>
              SOAP Implementation Interoperability test i.e. Web Services Interoperability Basic Profile version 2.0 (WS-I BP2.0).
            </para>
          </listitem>
          <listitem>
            <para>
              Network protocol implementation Conformance test for HTTPS, HTTP, RTP and RTSP protocols.
            </para>
          </listitem>
          <listitem>
            <para>
              Wi-Fi Conformance test
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        The set of ONVIF Test Specification will not cover the complete set of requirements as defined in [ONVIF Network Interface Specs]; instead it would cover subset of it.
      </para>
      <para>
        This ONVIF Base Test Specification covers core parts of functional blocks in [ONVIF Network Interface Specs]. The following sections describe the brief overview and scope of each functional block.
      </para>
      <section xml:id="s.intro.scope.ip_configuration">
        <title>IP Configuration</title>
        <para>
          IP Configuration covers the test cases needed for the verification of IP configuration features as mentioned in [ONVIF Network Interface Specs]. IP configuration section defines the ONVIF IP configuration compliance requirements and recommendations.
        </para>
        <para>
          The scope of this specification is to cover following configurations:
          <itemizedlist>
            <listitem>
              <para>
                IPv4 configuration
                <itemizedlist>
                  <listitem>
                    <para>
                      Link-local address configuration
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DHCP configuration
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                IPv6 configuration
                <itemizedlist>
                  <listitem>
                    <para>
                      Stateless IP configuration
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Stateful IP configuration
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <section xml:id="s.intro.scope.device_discovery">
        <title>Device Discovery</title>
        <para>
          Device discovery and location of the device services in the network are achieved using a multicast discovery protocol defined in WS-Discovery. The communication between client and target service is done using Web Services, notably SOAP/UDP.
        </para>
        <para>
          Device Discovery testing tests the following:
          <itemizedlist>
            <listitem>
              <para>
                Device discovery in the ad-hoc network
              </para>
            </listitem>
            <listitem>
              <para>
                Location of one or more device services
              </para>
            </listitem>
            <listitem>
              <para>
                Enable discovery of service by type and within scope
              </para>
            </listitem>
            <listitem>
              <para>
                SOAP 1.2 envelopes
              </para>
            </listitem>
            <listitem>
              <para>
                SOAP 1.2 fault messages
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          Refer to Table 1.1 for Device Discovery tests.
        </para>
        <table>
          <title>Device Discovery</title>
          <tgroup cols="2">
            <colspec colwidth="500*" />
            <colspec colwidth="500*" />
            <thead>
              <row>
                <entry>Feature</entry>
                <entry>Messages</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>Device Discovery</entry>
                <entry>
                  <para>Hello</para>
                  <para>Probe</para>
                  <para>Probe Match</para>
                  <para>Bye</para>
                </entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </section>
      <section xml:id="s.intro.scope.device_management">
        <title>Device Management</title>
        <para>
          Device Management covers the test cases for the verification of the device service as mentioned in [ONVIF Network Interface Specs]. The device service is the entry point to all other services provided by a device.
        </para>
        <para>
          The scope of this specification is to cover interfaces with regard to following subcategories of device service.
          <itemizedlist>
            <listitem>
              <para>
                Capabilities
              </para>
            </listitem>
            <listitem>
              <para>
                Network
              </para>
            </listitem>
            <listitem>
              <para>
                System
              </para>
            </listitem>
            <listitem>
              <para>
                Security
              </para>
            </listitem>
            <listitem>
              <para>
                Input/Output(I/O)
              </para>
            </listitem>
            <listitem>
              <para>
                IP Filtering
              </para>
            </listitem>
            <listitem>
              <para>
                Monitoring Events
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          In addition, the following behavior of a device is confirmed as the representative of all services that are defined by [ONVIF Network Interface Specs].
          <itemizedlist>
            <listitem>
              <para>
                Namespace handling
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <section xml:id="s.intro.scope.security">
        <title>Security</title>
        <para>
          Security covers the test cases needed for the verification of required security features as mentioned in [ONVIF Network Interface Specs]. The scope of this specification is limited to Message level security and Username Token Profile.
        </para>
      </section>
    </section>
  </chapter>
  <chapter xml:id="s.docbook">
    <title>Normative references</title>
    <itemizedlist>
      <listitem>
        <para>[ONVIF Conformance] ONVIF Conformance Process Specification:</para>
        <para>
          <link xlink:href="https://www.onvif.org/profiles/conformance/">https://www.onvif.org/profiles/conformance/</link>
        </para>
      </listitem>
      <listitem>
        <para>[ONVIF Profile Policy] ONVIF Profile Policy:</para>
        <para>
          <link xlink:href="https://www.onvif.org/profiles/">https://www.onvif.org/profiles/</link>
        </para>
      </listitem>
      <listitem>
        <para>[ONVIF Network Interface Specs] ONVIF Network Interface Specification documents:</para>
        <para>
          <link xlink:href="https://www.onvif.org/profiles/specifications/">https://www.onvif.org/profiles/specifications/</link>
        </para>
      </listitem>
      <listitem>
        <para>[ONVIF Core Specs] ONVIF Core Specifications:</para>
        <para>
          <link xlink:href="https://www.onvif.org/profiles/specifications/">https://www.onvif.org/profiles/specifications/</link>
        </para>
      </listitem>
      <listitem>
        <para>[ISO/IEC Directives, Part 2] ISO/IEC Directives, Part 2, Annex H:</para>
        <para>
          <link xlink:href="http://www.iso.org/directives">http://www.iso.org/directives</link>
        </para>
      </listitem>
      <listitem>
        <para>[ISO 16484-5] ISO 16484-5:2014-09 Annex P:</para>
        <para>
          <link xlink:href="https://www.iso.org/obp/ui/#!iso:std:63753:en">https://www.iso.org/obp/ui/#!iso:std:63753:en</link>
        </para>
      </listitem>
      <listitem>
        <para>[SOAP 1.2, Part 1] W3C SOAP 1.2, Part 1, Messaging Framework:</para>
        <para>
          <link xlink:href="http://www.w3.org/TR/soap12-part1/">http://www.w3.org/TR/soap12-part1/</link>
        </para>
      </listitem>
      <listitem>
        <para>[XML-Schema, Part 1] W3C XML Schema Part 1: Structures Second Edition:</para>
        <para>
          <link xlink:href="http://www.w3.org/TR/xmlschema-1/">http://www.w3.org/TR/xmlschema-1/</link>
        </para>
      </listitem>
      <listitem>
        <para>[XML-Schema, Part 2] W3C XML Schema Part 2: Datatypes Second Edition:</para>
        <para>
          <link xlink:href="http://www.w3.org/TR/xmlschema-2/">http://www.w3.org/TR/xmlschema-2/</link>
        </para>
      </listitem>
      <listitem>
        <para>[WS-Security] "Web Services Security: SOAP Message Security 1.1 (WS-Security 2004)", OASIS Standard, February 2006.:</para>
        <para>
          <link xlink:href="http://www.oasis-open.org/committees/download.php/16790/wss-v1.1-spec-os-SOAPMessageSecurity.pdf">http://www.oasis-open.org/committees/download.php/16790/wss-v1.1-spec-os-SOAPMessageSecurity.pdf</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 3986] "Uniform Resource Identifier (URI): Generic Syntax", T. Berners-Lee et. al., January 2005.:</para>
        <para>
          <link xlink:href="http://www.ietf.org/rfc/rfc3986">http://www.ietf.org/rfc/rfc3986</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 1123] "Requirements for Internet Hosts - Application and Support", IETF, R. Braden (Ed), October 1989.:</para>
        <para>
          <link xlink:href="https://www.ietf.org/rfc/rfc1123">https://www.ietf.org/rfc/rfc1123</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 952] "DOD INTERNET HOST TABLE SPECIFICATION", K. Harrenstien et. al., October 1985.:</para>
        <para>
          <link xlink:href="https://www.ietf.org/rfc/rfc952">https://www.ietf.org/rfc/rfc952</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 758] "ASSIGNED NUMBERS", J. Postel, August 1979.:</para>
        <para>
          <link xlink:href="https://www.ietf.org/rfc/rfc758">https://www.ietf.org/rfc/rfc758</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 3927] "Dynamic Configuration of IPv4 Link-Local Addresses", S. Cheshire, B. Aboba and E. Guttman, May 2005.:</para>
        <para>
          <link xlink:href="https://www.ietf.org/rfc/rfc3927">https://www.ietf.org/rfc/rfc3927</link>
        </para>
      </listitem>
      <listitem>
        <para>[RFC 2780] "IANA Allocation Guidelines For Values in the Internet", S. Bradner and V. Paxson, March 2000.:</para>
        <para>
          <link xlink:href="https://www.ietf.org/rfc/rfc2780">https://www.ietf.org/rfc/rfc2780</link>
        </para>
      </listitem>
    </itemizedlist>
  </chapter>
  <chapter xml:id="additions">
    <title>Terms and Definitions</title>
    <section xml:id="additions.conventions">
      <title>Conventions</title>
      <para>
        The key words "shall", "shall not", "should", "should not", "may", "need not",
        "can", "cannot" in this specification are to be interpreted as described in [ISO/IEC
        Directives Part 2].
      </para>
    </section>
    <section xml:id="additions.definitions">
      <title>Definitions</title>
      <para>This section describes terms and definitions used in this document.</para>
      <variablelist>
        <varlistentry>
          <term>Profile</term>
          <listitem>
            <para>See ONVIF Profile Policy.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>ONVIF Device</term>
          <listitem>
            <para>
              Computer appliance or software program that exposes one or multiple
              ONVIF Web Services.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>ONVIF Client</term>
          <listitem>
            <para>
              Computer appliance or software program that uses ONVIF Web
              Services.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>SOAP</term>
          <listitem>
            <para>
              SOAP is a lightweight protocol intended for exchanging structured
              information in a decentralized, distributed environment. It uses XML
              technologies to define an extensible messaging framework providing a
              message construct that can be exchanged over a variety of underlying
              protocols.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Device Test Tool</term>
          <listitem>
            <para>
              ONVIF Device Test Tool that tests ONVIF Device implementation towards
              the ONVIF Test Specification set.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Device Management Service</term>
          <listitem>
            <para>
              Services to configure common Device settings, such as network, security, system, etc.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Capability</term>
          <listitem>
            <para>
              The capability commands allow a client to ask for the services provided by an ONVIF device.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Network</term>
          <listitem>
            <para>
              A network is an interconnected group of devices communicating using the Internet protocol.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Proxy Server</term>
          <listitem>
            <para>
              A server that services the requests of its clients by forwarding requests to other servers. A Proxy provides indirect network connections to its clients.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Switching Hub</term>
          <listitem>
            <para>
              A device for connecting multiple Ethernet devices together, making them act as a single network segment.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Target Service</term>
          <listitem>
            <para>
              An endpoint that makes itself available for discovery.
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>
    <section xml:id="additions.abbreviations">
      <title>Abbreviations</title>
      <para>This section describes abbreviations used in this document.</para>
      <variablelist>
        <varlistentry>
          <term>DP</term>
          <listitem>
            <para>Discovery Proxy</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>DNS</term>
          <listitem>
            <para>Domain Name System</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>DHCP</term>
          <listitem>
            <para>Dynamic Host Configuration Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>HTTP</term>
          <listitem>
            <para>Hyper Text Transport Protocol.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>HTTPS</term>
          <listitem>
            <para>Hyper Text Transport Protocol over Secure Socket Layer</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>WSDL</term>
          <listitem>
            <para>Web Services Description Language.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>XML</term>
          <listitem>
            <para>eXtensible Markup Language.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>WS-I BP 2.0</term>
          <listitem>
            <para>Web Services Interoperability Basic Profile version 2.0</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>
            IP
          </term>
          <listitem>
            <para>Internet Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            IPv4
          </term>
          <listitem>
            <para>Internet Protocol version 4</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            IPv6
          </term>
          <listitem>
            <para>Internet Protocol version 6</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            NTP
          </term>
          <listitem>
            <para>Network Time Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            POSIX
          </term>
          <listitem>
            <para>Portable Operating System Interface</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            RTCP
          </term>
          <listitem>
            <para>RTP Control Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            RTSP
          </term>
          <listitem>
            <para>Real Time Streaming Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            RTP
          </term>
          <listitem>
            <para>Real-time Transport Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            SDP
          </term>
          <listitem>
            <para>Session Description Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            TCP
          </term>
          <listitem>
            <para>Transport Control Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            UTC
          </term>
          <listitem>
            <para>Coordinated Universal Time</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            UDP
          </term>
          <listitem>
            <para>User Datagram Protocol</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            URI
          </term>
          <listitem>
            <para>Uniform Resource Identifier</para>
          </listitem>
        </varlistentry>



      </variablelist>
    </section>
  </chapter>
  <chapter xml:id="overview">
    <title>Test Overview</title>
    <para>
      This section describes about the test setup and prerequisites needed,
      and the test policies that should be followed for test case execution.
    </para>
    <section xml:id="overview.test_setup">
      <title>Test Setup</title>
      <section xml:id="overview.test_setup.network_configuration">
        <title>Network Configuration for DUT</title>
        <para>
          The generic test configuration for the execution of test cases defined in this document is as shown below (Figure 4.1).
        </para>
        <para>
          Based on the individual test case requirements, some of the entities in the below setup may not be needed for the execution of those corresponding test cases.
        </para>
        <figure>
          <title>Test Configuration for DUT</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="test_network.png" format="PNG" scalefit="0"/>
            </imageobject>
            <textobject>
              <phrase>Test Configuration for DUT</phrase>
            </textobject>
          </mediaobject>
        </figure>
        <para>
          <emphasis role="bold">DUT:</emphasis> ONVIF device to be tested. Hereafter, this is referred to as DUT (Device Under Test).
        </para>
        <para>
          <emphasis role="bold">ONVIF Client (Test Tool):</emphasis> Tests are executed by this system and it controls the behavior of the DUT. It handles both expected and unexpected behavior.
        </para>
        <para>
          <emphasis role="bold">HTTP Proxy:</emphasis> provides facilitation in case of RTP and RTSP tunneling over HTTP.
        </para>
        <para>
          <emphasis role="bold">Wireless Access Point:</emphasis> provides wireless connectivity to the devices that support wireless connection.
        </para>
        <para>
          <emphasis role="bold">DNS Server:</emphasis> provides DNS related information to the connected devices.
        </para>
        <para>
          <emphasis role="bold">DHCP Server:</emphasis> provides IPv4 Address to the connected devices.
        </para>
        <para>
          <emphasis role="bold">NTP Server:</emphasis> provides time synchronization between ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Switching Hub:</emphasis> provides network connectivity among all the test equipments in the test environment. All devices should be connected to the Switching Hub.
          When running multiple test instances in parallel on the same network, the Switching Hub should be configured to use filtering in order to avoid multicast traffic being flooded to all ports, because this may affect test stability.
        </para>
        <para>
          <emphasis role="bold">Router:</emphasis> provides router advertisements for IPv6 configuration.
        </para>
      </section>
    </section>
    <section xml:id="overview.prerequisites">
      <title>Prerequisites</title>
      <para>
        The pre-requisites for executing the test cases described in this Test Specification are:
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              The DUT shall be configured with an IPv4 address.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT shall be IP reachable [in the test configuration].
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT shall be able to be discovered by the Test Tool.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT shall be configured with the time i.e. manual configuration of UTC time and if NTP is supported by the DUT, then NTP time shall be synchronized with NTP Server.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT time and Test tool time shall be synchronized with each other either manually or by common NTP server
            </para>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <section xml:id="overview.test_policy">
      <title>Test Policy</title>
      <para>
        This section describes the test policies specific to the test case execution of each functional block.
      </para>
      <para>
        The DUT shall adhere to the test policies defined in this section.
      </para>
      <section xml:id="overview.test_policy.ip_configuration">
        <title>IP Configuration</title>
        <para>
          The device under test shall be discovered by the ONVIF Client that exists in the testing environment.
        </para>
        <para>
          The device under test shall support SetNetworkInterfaces method.
        </para>
        <para>
          The device under test that supports Link-Local address of IPv4 shall support SetZeroConfiguration method.
        </para>
        <para>
          The device under test shall be configured with routable IPv4 address.
        </para>
        <para>
          The following tests are related to IPv4:
          <itemizedlist>
            <listitem>
              <para>
                Static IP configuration
              </para>
            </listitem>
            <listitem>
              <para>
                Dynamic IP configuration of Link-Local address
              </para>
            </listitem>
            <listitem>
              <para>
                Dynamic IP configuration (DHCP)
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          The following tests are related to IPv6:
          <itemizedlist>
            <listitem>
              <para>
                Stateless IP configuration which accepts Router Advertisement.
              </para>
            </listitem>
            <listitem>
              <para>
                Stateless IP configuration which uses Neighbor Discovery.
              </para>
            </listitem>
            <listitem>
              <para>
                Stateful IP configuration (DHCPv6)
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          The device under test shall have at least one network interface that provides IPv4 connectivity. And it should have at least one network interface that provides IPv6 connectivity.
        </para>
        <para>
          The device under test that has multiple network interfaces (Wired Ethernet i.e. 802.3af and Wireless Ethernet i.e. 802.11a/b/g/n), initial testing will be performed on the Wired Ethernet network interface. After completion of all testing on the Wired Ethernet network interface, all tests shall be repeated on Wireless Ethernet network interface.
        </para>
        <para>
          ONVIF Test Specification restricts all testing to Wired Ethernet and/or Wireless Ethernet network interface, other interfaces like USB, Bluetooth etc are outside the scope of the testing.
        </para>
        <para>
          Please refer to <link linkend="tc.ip_configuration">Section 5</link> for IP Configuration Test Cases.
        </para>
      </section>
      <section xml:id="overview.test_policy.device_discovery">
        <title>Device Discovery</title>
        <para>
          The device under test shall be discovered by the ONVIF Client that exists in the testing environment.
        </para>
        <para>
          Failing to discover the device on the network results in failure of the test procedure.
        </para>
        <para>
          Failing to locate the device services on the network results in failure of the test procedure.
        </para>
        <para>
          Failing to select the device for interaction results in failure of the test procedure.
        </para>
        <para>
          Detection of undefined namespace required for Core Specification results in failure of the test procedure.
        </para>
        <para>
          In certain test cases, the client may check the discovery mode and change it to "discoverable" to perform the test. At the end of the test procedure it resets the discovery mode value.
        </para>
        <para>
          Please refer to <link linkend="tc.device_discovery">Section 6</link> for Device Discovery Test Cases.
        </para>
      </section>
      <section xml:id="overview.test_policy.device_management">
        <title>Device Management</title>
        <para>
        </para>
        <para>
          The device under test shall demonstrate device, media and event capability. A DUT that does not display mandatory device capability results in failure of test procedure.
        </para>
        <para>
          Some commands like CreateUsers, SetUser, etc may have restricted access. In this case ONVIF Client should execute the test cases in the administrative mode.
        </para>
        <para>
          If DUT does not support Media service, then (GET CAPABILITIES for MEDIA) shall be responded with SOAP 1.2 fault message (env:Receiver, ter:ActionNotSupported, ter:NoSuchService).
        </para>
        <para>
          If DUT does not support PTZ, then (GET CAPABILITIES for PTZ) shall be responded with SOAP 1.2 fault message (env:Receiver, ter:ActionNotSupported, ter:NoSuchService).
        </para>
        <para>
          Refer to <link linkend="Annex_InvalidHostname">Annex A.2</link> for valid host name.
        </para>
        <para>
          The Monitoring Events section covers the test cases needed for check of monitoring property events.
        </para>
        <para>
          DUT shall give the Event Service entry point by GetServices command. Otherwise these test cases will be skipped.
        </para>
        <para>
          DUT can support the following property Monitoring Events:
          <itemizedlist>
            <listitem>
              <para>
                tns1:Monitoring/ProcessorUsage
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Monitoring/OperatingTime/LastReset
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Monitoring/OperatingTime/LastReboot
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Monitoring/OperatingTime/LastClockSynchronization
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Monitoring/Backup/Last
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Device/HardwareFailure/FanFailure
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Device/HardwareFailure/PowerSupplyFailure
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Device/HardwareFailure/StorageFailure
              </para>
            </listitem>
            <listitem>
              <para>
                tns1:Device/HardwareFailure/TemperatureCritical
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          If DUT supports at least one Monitoring event:
          <itemizedlist>
            <listitem>
              <para>
                DUT shall support GetEventProperties command and return all supported events in TopicSet.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT shall support Pull Point Subscription and Topic Expression filter.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT shall generate property events with initial state after subscription was done.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT shall generate property events with current state after corresponding properties were changed.
              </para>
            </listitem>
            <listitem>
              <para>
                The following tests are performed
                <itemizedlist>
                  <listitem>
                    <para>
                      Getting of Processor Usage event and generate Processor Usage property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Last Reset event and generate Last Reset property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Last Reset event and generate Last Reboot property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Generate Last Reboot property event after device reboot
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Last Clock Synchronization event and generate Last Clock Synchronization property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Generate Last Clock Synchronization property event after clock synchronization via SetSystemDateAndTime command
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Generate Last Clock Synchronization property event after clock synchronization with NTP server
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Last Backup event and generate Last Backup property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Fan Failure event and generate Fan Failed property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Power Supply Failure event and generate Power Supply Failed property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Storage Failure event and generate Storage Failed property event with initial state
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Getting of Critical Temperature event and generate Critical Temperature property event with initial state
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          Please refer to <link linkend="tc.device_management">Section 7</link> for Device Management Test Cases.
        </para>
      </section>
      <section xml:id="overview.test_policy.security">
        <title>Security</title>
        <para>
          The DUT shall support WS-Security User token profile. Consequently, the DUT shall support user profiles that conform to the User token profile and handling of these users via Device Management.
        </para>
        <para>
          The details of Access rights and Access policies are outside the scope of this document. However, ONVIF Client shall be able to access any given part of any given service supported by the DUT with a user with Administrator rights.
        </para>
        <para>
          Please refer to <link linkend="tc.security">Section 8</link> for Security Test Cases.
        </para>
      </section>
      <section xml:id="overview.test_policy.authentication">
        <title>Authentication method selection as a testing framework</title>
        <para>
          According to the later version of [ONVIF Network Interface Specs], it requires ONVIF client to support both HTTP digest and WS-UsernameToken functionality as authentication functionality. Therefore, ONVIF Client (ONVIF Device Test Tool in this context) as a testing framework shall properly select authentication method between the two based on the response from DUT toward specific request. The following is the deterministic procedure on which authentication method is to be selected.
        </para>
        <para>
          Procedure:
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                ONVIF Client invokes a specific command which is under testing without any user credentials (no WS-UsernameToken, no HTTP digest authentication header).
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returns a correct response, then ONVIF Client determines that DUT does not require any user authentication toward the command according to the configured security policy.
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returns HTTP 401 Unauthorized error along with WWW-Authentication: Digest header, then ONVIF Client determines that DUT supports HTTP digest authentication. ONVIF Client shall provide with the proper level of user credential to continue the test procedure.
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returns SOAP fault (Sender/NotAuthorized) message, then ONVIF Client determines that WS-UsernameToken is supported by DUT. ONVIF Client shall provide with the proper level of user credential to continue the test procedure.
              </para>
            </listitem>
          </orderedlist>
        </para>
      </section>
    </section>
  </chapter>
  <!--IP Configuration Test Cases-->
  <chapter xml:id="tc.ip_configuration">
    <title>IP Configuration Test Cases</title>
    <!--IPv4-->
    <section xml:id="tc.ip_configuration.ipv4">
      <title>IPv4</title>
      <!--IPCONFIG-1-1-3-->
      <section xml:id="tc.IPCONFIG-1-1-3" version="16.07">
        <title>IPV4 DHCP</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> IPCONFIG-1-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> IP Configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> DHCP IPv4 Configuration
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To test IPv4 DHCP Configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client, DUT, and DHCPv4 server
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start DHCPv4 server.
              </para>
            </listitem>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := first interface from <emphasis role="italic">networkInterfacesList1</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv4.DHCP = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem xml:id="tc.IPCONFIG-1-1-3.7.1">
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.Enabled skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.Link skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.MTU skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv4.Enabled := true
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv4.Manual.Address := another address in the same subnet as an original address
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv4.Manual.PrefixLength := current IPv4 prefix of the DUT
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv4.DHCP := false
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv6.Enabled = false
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv6.AcceptRouterAdvert skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv6.Manual skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.IPv6.DHCP skipped
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NetworkInterface.Extension skipped
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">rebootNeeded</emphasis> = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                            <itemizedlist>
                              <listitem>
                                <para>
                                  Message
                                </para>
                              </listitem>
                            </itemizedlist>
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-1-1-3.8">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.Manual skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.DHCP := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Enabled = false
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.AcceptRouterAdvert skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.DHCP skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                <itemizedlist>
                  <listitem>
                    <para>
                      EndpointReference
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Types =: <emphasis role="italic">types</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Scopes
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MetadataVersion
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4 is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Enabled = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Config.FromDHCP is skipped, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Config.DHCP = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-3.21">21</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-1-1-3.21">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--IPCONFIG-1-1-5-->
      <section xml:id="tc.IPCONFIG-1-1-5" version="16.01">
        <title>IPV4 LINK LOCAL ADDRESS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> IPCONFIG-1-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> IP Configuration (ONVIF Core Specification), Set zero configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetZeroConfiguration, GetZeroConfiguration, Link-Local IPv4 Configuration
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To test IPv4 Link-Local Address Configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Dynamic IP configuration as per [RFC 3927] is supported by DUT. Routable IPv4 address is configured.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := first interface from <emphasis role="italic">networkInterfacesList1</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetZeroConfiguration</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetZeroConfigurationResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      ZeroConfiguration =: <emphasis role="italic">initialZeroConfiguration</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-1-1-5.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetZeroConfiguration</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Enabled := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetZeroConfigurationResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client waits until <emphasis role="italic">timeout1</emphasis> timeout expires.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetZeroConfiguration</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetZeroConfigurationResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      ZeroConfiguration =: <emphasis role="italic">updatedZeroConfiguration</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedZeroConfiguration</emphasis>.Enabled = failed, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-5.16">16</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedZeroConfiguration</emphasis>.InterfaceToken != <emphasis role="italic">defaultNetworkSettings</emphasis>.@token, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-5.16">16</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedZeroConfiguration</emphasis>.Addresses is skipped, FAIL the test and go to step <link linkend="tc.IPCONFIG-1-1-5.16">16</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-1-1-5.16">
              <para>
                ONVIF Client restores the original zero configuration settings.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetZeroConfigurationResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetZeroConfigurationResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
    </section>
    <!--IPv6-->
    <section xml:id="tc.ip_configuration.ipv6">
      <title>IPv6</title>
      <!--IPCONFIG-2-1-2-->
      <section xml:id="tc.IPCONFIG-2-1-2" version="14.12">
        <title>IPV6 STATELESS IP CONFIGURATION - ROUTER ADVERTISEMENT</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> IPCONFIG-2-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> IP Configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> Static IPv6 Stateless Configuration which Accepts Router Advertisement
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To test IPv6 Stateless IP Configuration which Accepts Router Advertisement.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. IPv6 is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList1</emphasis> list with specified IPv6.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-2.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4 skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.AcceptRouterAdvert := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.DHCP := Off
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            
            

            <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6 is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Enabled = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.AcceptRouterAdvert = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.FromRA is skipped, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.DHCP != Off, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-2.20">19</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-2.20">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--IPCONFIG-2-1-3-->
      <section xml:id="tc.IPCONFIG-2-1-3" version="14.12">
        <title>IPV6 STATELESS IP CONFIGURATION - NEIGHBOUR DISCOVERY</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> IPCONFIG-2-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> IP Configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> Static IPv6 Stateless Configuration which uses Neighbor Discovery
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To test IPv6 Stateless IP Configuration which uses Neighbor Discovery.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. IPv6 is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList1</emphasis> list with specified IPv6.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-3.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4 skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.AcceptRouterAdvert skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.DHCP := Off
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            
           <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6 is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Enabled = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.LinkLocal is skipped, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.DHCP != Off, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-3.19">18</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-3.19">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--IPCONFIG-2-1-4-->
      <section xml:id="tc.IPCONFIG-2-1-4" version="14.12">
        <title>IPV6 STATEFUL IP CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> IPCONFIG-2-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> IP Configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> IPv6 Stateful Configuration (DHCP)
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To test IPv6 Stateful IP Configuration (DHCPv6).
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. IPv6 is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client, DUT, and DHCPv6 Server
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start DHCPv6 server.
              </para>
            </listitem>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList1</emphasis> list with specified IPv6.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-4.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4 skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.AcceptRouterAdvert skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.DHCP := Stateful
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>            
            <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6 is skipped or empty, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Enabled = false, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.FromDHCP is skipped, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.DHCP != Stateful, FAIL the test and go to step <link linkend="tc.IPCONFIG-2-1-4.20">19</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.IPCONFIG-2-1-4.20">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
    </section>
  </chapter>
  <!--Device Discovery Test Cases-->
  <chapter xml:id="tc.device_discovery">
    <title>Device Discovery Test Cases</title>
    <!--DISCOVERY-1-1-2-->
    <section xml:id="tc.DISCOVERY-1-1-2" version="?">
      <title>HELLO MESSAGE VALIDATION</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-2
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Endpoint reference, Hello, Types, Scopes, Reboot
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Hello
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify the mandatory XML elements Device type, Scope types, Endpoint Reference and Meta data version in the Hello message. 
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request to reboot the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT sends <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for the user defined boot time to receive <emphasis role="bold">Hello</emphasis> message from DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will verify the mandatory XML elements in the DUT <emphasis role="bold">Hello</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send multicast <emphasis role="bold">Hello</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">Hello</emphasis> message with one or more mandatory XML elements (EndpointReference, Types, and Scopes).
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">Hello</emphasis> message with mandatory device type and scope types (type, location, hardware and name).
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">Hello</emphasis> message with a namespace of the Types value.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
      </para>
    </section>
    <!--DISCOVERY-1-1-3-->
    <section xml:id="tc.DISCOVERY-1-1-3" version="?">
      <title>SEARCH BASED ON DEVICE SCOPE TYPES</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-3
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Services overview, Types, Scopes, Probe and Probe Match, Get scope parameters
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Probe, ProbeMatch
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To search the DUT based on the mandatory scope types (type, location, hardware and name).
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT scope list does not have one or more mandatory scope entries.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
            </para>
          </listitem>
          <listitem>
            <para>
              In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
      </para>
    </section>
    <!--DISCOVERY-1-1-4-->
    <section xml:id="tc.DISCOVERY-1-1-4" version="?">
      <title>SEARCH WITH OMITTED DEVICE AND SCOPE TYPES</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-4
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Services overview, Types, Scopes, Probe and Probe Match
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Probe, ProbeMatch
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To search the DUT with device and scope types being omitted. 
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will transmit multicast <emphasis role="bold">Probe</emphasis> request with device type and scope type inputs omitted.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by the DUT.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
            </para>
          </listitem>
          <listitem>
            <para>
              In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; of including IPv6 address.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that it has same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
      </para>
    </section>
    <!--DISCOVERY-1-1-5-->
    <section xml:id="tc.DISCOVERY-1-1-5" version="?">
      <title>RESPONSE TO INVALID SEARCH REQUEST</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-5
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Probe and Probe Match
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Probe
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT does not reply to the invalid multicast Probe request (invalid device and scope types). 
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will transmit multicast <emphasis role="bold">Probe</emphasis> request with invalid device and scope types.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did send <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
      </para>
    </section>
    <!--DISCOVERY-1-1-6-->
    <section xml:id="tc.DISCOVERY-1-1-6" version="?">
      <title>SEARCH USING UNICAST PROBE MESSAGE</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-6
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify DUT behavior for Unicast Probe request.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> All Tests <link linkend="tc.DISCOVERY-1-1-3">DISCOVERY-1-1-3</link>, <link linkend="tc.DISCOVERY-1-1-4">DISCOVERY-1-1-4</link>, <link linkend="tc.DISCOVERY-1-1-5">DISCOVERY-1-1-5</link> to be repeated with Unicast Probe request.
      </para>
    </section>
    <!--DISCOVERY-1-1-8-->
    <section xml:id="tc.DISCOVERY-1-1-8" version="?">
      <title>BYE MESSAGE</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-8
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Bye, Reboot
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Bye
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT transmits Bye message before the system reboot. 
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Bye message is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">SystemReboot</emphasis> request to reboot the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT sends <emphasis role="bold">SystemRebootResponse</emphasis> message (example message string = "Rebooting in x seconds").
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT issued a <emphasis role="bold">Bye</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for the user defined boot time before proceeding to execute the next test case.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">Bye</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--DISCOVERY-1-1-9-->
    <section xml:id="tc.DISCOVERY-1-1-9" version="?">
      <title>DISCOVERY MODE CONFIGURATION</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-9
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Probe and Probe Match, Reboot, Get discovery mode, Set discovery mode
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> GetDiscoveryMode, SetDiscoveryMode
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify DUT behavior for Discovery mode configuration.
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">GetDiscoveryMode</emphasis> request to verify discovery mode of the DUT.
            </para>
          </listitem>
          <listitem xml:id="tc.DISCOVERY-1-1-9.4">
            <para>
              Verify that the DUT sends <emphasis role="bold">GetDiscoveryModeResponse</emphasis> message (DiscoveryMode = Discoverable).
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">SetDiscoveryMode</emphasis> request to set discovery mode of the DUT to Non-Discoverable.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT sends <emphasis role="bold">SetDiscoveryModeResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">GetDiscoveryMode</emphasis> request to verify discovery mode of the DUT.
            </para>
          </listitem>
          <listitem xml:id="tc.DISCOVERY-1-1-9.8">
            <para>
              Verify that the DUT sends <emphasis role="bold">GetDiscoveryModeResponse</emphasis> message (DiscoveryMode = NonDiscoverable).
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will transmit multicast <emphasis role="bold">Probe</emphasis> request with device type and scope type inputs omitted.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">SystemReboot</emphasis> request to reboot the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT sends <emphasis role="bold">SystemRebootResponse</emphasis> message (example message string = "Rebooting in x seconds").
            </para>
          </listitem>
          <listitem xml:id="tc.DISCOVERY-1-1-9.13">
            <para>
              Verify that the DUT did not send <emphasis role="bold">Bye</emphasis> or <emphasis role="bold">Hello</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for the user defined boot time before proceeding to execute the next step.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">SetDiscoveryMode</emphasis> request to set discovery mode of the DUT to Discoverable.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT sends <emphasis role="bold">SetDiscoveryModeResponse</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">GetDiscoveryModeResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT <emphasis role="bold">GetDiscoveryModeResponse</emphasis> did not have a Discovery mode parameter of Discoverable at step <link linkend="tc.DISCOVERY-1-1-9.4">4</link>.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">SetDiscoveryModeResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT <emphasis role="bold">GetDiscoveryModeResponse</emphasis> did not have a Discovery mode parameter of NonDiscoverable at step <link linkend="tc.DISCOVERY-1-1-9.8">8</link>.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT sent <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT sent <emphasis role="bold">Bye</emphasis> or <emphasis role="bold">Hello</emphasis> message at step <link linkend="tc.DISCOVERY-1-1-9.13">13</link>.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
      </para>
    </section>
    <!--DISCOVERY-1-1-10-->
    <section xml:id="tc.DISCOVERY-1-1-10" version="?">
      <title>SOAP FAULT MESSAGE</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-10
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> SOAP Fault Messages
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> Probe
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT generates a SOAP 1.2 fault message to the invalid Unicast Probe request (Invalid matching rule). 
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will transmit Unicast <emphasis role="bold">Probe</emphasis> request with invalid matching type rule.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT generates a SOAP 1.2 fault message (MatchingRuleNotSupported).
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send SOAP 1.2 fault message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send correct SOAP 1.2 fault message (fault code, namespace etc).
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for Invalid SOAP 1.2 fault message definition.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> Refer [RFC 3986] for scope matching definitions.
      </para>
    </section>
    <!--DISCOVERY-1-1-11-->
    <section xml:id="tc.DISCOVERY-1-1-11" version="?">
      <title>DEVICE SCOPES CONFIGURATION</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-1-1-11
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Hello, Probe and Probe Match, Get scope parameters, Set scope parameters, Add scope parameters, Remove scope parameters
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> AddScopes, SetScopes, RemoveScopes
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify DUT behavior for scope parameter configuration.
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scope types.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT replies with the list of scopes types in the <emphasis role="bold">GetScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem xml:id="tc.DISCOVERY-1-1-11.5">
            <para>
              ONVIF Client will invoke <emphasis role="bold">SetScopes</emphasis> request to replace existing list with a list of new scope.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT replies with <emphasis role="bold">SetScopesResponse</emphasis> message indicating success.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for 2 seconds.
            </para>
          </listitem>
          <listitem xml:id="tc.DISCOVERY-1-1-11.8">
            <para>
              ONVIF Client will invoke <emphasis role="bold">AddScopes</emphasis> request to add new scope types to the existing scope list.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT replies with <emphasis role="bold">AddScopesResponse</emphasis> message indicating success.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT sends Multicast <emphasis role="bold">Hello</emphasis> message to indicate the change in the metadata (i.e. addition of new scope types to the existing list).
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke Multicast <emphasis role="bold">Probe</emphasis> request to search the DUT with newly added scope types.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT issued a <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke <emphasis role="bold">RemoveScopes</emphasis> request to delete the newly configured scope types.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT replies with <emphasis role="bold">RemoveScopesResponse</emphasis> message indicating success.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT sends Multicast <emphasis role="bold">Hello</emphasis> message to indicate the change in the metadata (i.e. deletion of scope types from the existing list).
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client will invoke Multicast <emphasis role="bold">Probe</emphasis> request to search the DUT with deleted scope types.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT scope list does not have one or more mandatory scope entry.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">SetScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">AddScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send multicast <emphasis role="bold">Hello</emphasis> message after the change in its metadata (addition/deletion of scope types) with a complete list of current scopes.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send mandatory XML elements (device, new scope type, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">RemoveScopesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyScopes" for the SetScopes (step <link linkend="tc.DISCOVERY-1-1-11.5">5</link>) or AddScopes (step <link linkend="tc.DISCOVERY-1-1-11.8">8</link>) command. Such SOAP 1.2 fault message shall be treated as PASS case for this test.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> Whenever there is a change in the metadata of the Target Service, "MetadataVersion" is incremented by >=1.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for Invalid SOAP 1.2 fault message definition.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> Refer [RFC 3986] for scope matching definitions.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
      </para>
    </section>
    <!--Namespace Handling-->
    <section xml:id="tc.device_discovery.namespace_handling">
      <title>Namespace Handling</title>
      <!--DISCOVERY-2-1-1-->
      <section xml:id="tc.DISCOVERY-2-1-1" version="?">
        <title>DISCOVERY - NAMESPACES (DEFAULT NAMESPACES FOR EACH TAG)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-2-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that DUT accepts requests for Device Discovery with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT scope list does not have one or more mandatory scope entries.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
              </para>
            </listitem>
            <listitem>
              <para>
                In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have default namespaces definition in each tag (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DISCOVERY-2-1-2-->
      <section xml:id="tc.DISCOVERY-2-1-2" version="?">
        <title>DISCOVERY - NAMESPACES (DEFAULT NAMESPACES FOR PARENT TAG)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-2-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Discovery with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT scope list does not have one or more mandatory scope entries.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
              </para>
            </listitem>
            <listitem>
              <para>
                In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have default namespaces definition in parent tag (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DISCOVERY-2-1-3-->
      <section xml:id="tc.DISCOVERY-2-1-3" version="?">
        <title>DISCOVERY - NAMESPACES (NOT STANDARD PREFIXES)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-2-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that DUT accepts requests for Device Discovery with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT scope list does not have one or more mandatory scope entries.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
              </para>
            </listitem>
            <listitem>
              <para>
                In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with non-standard prefixes (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DISCOVERY-2-1-4-->
      <section xml:id="tc.DISCOVERY-2-1-4" version="?">
        <title>DISCOVERY - NAMESPACES (DIFFERENT PREFIXES FOR THE SAME NAMESPACE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-2-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that DUT accepts requests for Device Discovery with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT scope list does not have one or more mandatory scope entries.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
              </para>
            </listitem>
            <listitem>
              <para>
                In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with different prefixes for the same namespace (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DISCOVERY-2-1-5-->
      <section xml:id="tc.DISCOVERY-2-1-5" version="?">
        <title>DISCOVERY - NAMESPACES (THE SAME PREFIX FOR DIFFERENT NAMESPACES)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DISCOVERY-2-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> ws-discovery.wsdl, devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that DUT accepts requests for Device Discovery with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetScopes</emphasis> request to retrieve existing scopes list.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT replies with the list of scopes types in <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will transmit the multicast <emphasis role="bold">Probe</emphasis> request with different scope types (type, location, hardware and name).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetScopesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT scope list does not have one or more mandatory scope entries.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send mandatory XML elements (device type, scope list, service address and scope matching rule) in the <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message within the time out period of DISCOVERY_TIMEOUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a namespace of the Types value.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with fixed entry point to &lt;d:XAddrs&gt; element ("http://&lt;onvif_host&gt;/onvif/device_service").
              </para>
            </listitem>
            <listitem>
              <para>
                In case of IPv6, the DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with &lt;d:XAddrs&gt; including IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message with a correct XML element RelatesTo that has the same value as MessageID of <emphasis role="bold">Probe</emphasis> request (not to omit "urn" namespace).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidDeviceTypeAndScope">Annex A.1</link> for Device and Scope Types definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_discovery_timeout_value">Annex A.7</link> for the value of DISCOVERY_TIMEOUT.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with the same prefixes for different namespaces (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
    </section>
  </chapter>
  <!--Device Management Test Cases-->
  <chapter xml:id="tc.device_management">
    <title>Device Management Test Cases</title>
    <!--Capabilities-->
    <section xml:id="tc.device_management.capabilities">
      <title>Capabilities</title>
      <!--DEVICE-1-1-1-->
      <!--<section xml:id="tc.DEVICE-1-1-1">
        <title>GET WSDL URL</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get WSDL URL
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetWsdlUrl
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve complete XML schema and WSDL definitions of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetWsdlUrl</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetWsdlUrlResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      WsdlUrl := <emphasis role="italic">wsdlUrl</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">wsdlUrl</emphasis> is not valid URI, FAIL the test.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetWsdlUrlResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>-->
      <!--DEVICE-1-1-2-->
      <section xml:id="tc.DEVICE-1-1-2">
        <title>ALL CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify all Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := All
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities1</emphasis>.Device is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities1</emphasis>.Events is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Media is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Media is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If PTZ is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.PTZ is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Imaging is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Imaging is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Analytics is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Analytics is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If DeviceIO is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Extension.DeviceIO is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category list skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities1</emphasis>.Device is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities1</emphasis>.Events is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Media is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Media is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If PTZ is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.PTZ is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Imaging is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Imaging is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If Analytics is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Analytics is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If DeviceIO is supported by the DUT and <emphasis role="italic">capabilities1</emphasis>.Extension.DeviceIO is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-3-->
      <section xml:id="tc.DEVICE-1-1-3">
        <title>DEVICE CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Device Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis>  GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := Device
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.XAddr is not valid URI, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Analytics is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Imaging is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Media is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.PTZ is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-4-->
      <section xml:id="tc.DEVICE-1-1-4">
        <title>MEDIA CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Media Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := Media
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Media Service is supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            Capabilities =: <emphasis role="italic">capabilities</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media is not specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.XAddr is not valid URI, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Device is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Imaging is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Events is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.PTZ is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Media Service is not supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT returns <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send the <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault message, if Media Service is not supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message, if Media Service is supported by the DUT.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-5-->
      <section xml:id="tc.DEVICE-1-1-5">
        <title>EVENT CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities.
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify event capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := Events
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.XAddr is not valid URI, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Analytics is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Imaging is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Media is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.PTZ is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-6-->
      <section xml:id="tc.DEVICE-1-1-6">
        <title>PTZ CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities.
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify PTZ capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := PTZ
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If PTZ Service is supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            Capabilities =: <emphasis role="italic">capabilities</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.PTZ is not specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.PTZ.XAddr is not valid URI, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Device is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Imaging is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Events is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If PTZ Service is not supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT returns <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send the <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault message, if PTZ Service is not supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message, if PTZ Service is supported by the DUT.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-9-->
      <section xml:id="tc.DEVICE-1-1-9">
        <title>SOAP FAULT MESSAGE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-9
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange.
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT generates SOAP 1.2 fault message to the invalid GetCapabilities message (invalid capability category).
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := invalid capability category
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns SOAP 1.2 fault.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send the SOAP 1.2 fault message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for Invalid SOAP 1.2 fault message definition.
        </para>
      </section>
      <!--DEVICE-1-1-10-->
      <section xml:id="tc.DEVICE-1-1-10">
        <title>IMAGING CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-10
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Imaging Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := Imaging
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Imaging Service is supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            Capabilities =: <emphasis role="italic">capabilities</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Imaging is not specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Imaging.XAddr is not valid URI, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Device is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.PTZ is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Events is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Imaging Service is not supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT returns <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send the <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault message, if Imaging Service is not supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message, if Imaging Service is supported by the DUT.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-11-->
      <section xml:id="tc.DEVICE-1-1-11">
        <title>ANALYTICS CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Analytics Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT.
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := Analytics
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Analytics Service is supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            Capabilities =: <emphasis role="italic">capabilities</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics is not specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics.XAddr is not valid URI, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Imaging is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Device is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.PTZ is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Events is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media is specified, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Analytics Service is not supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT returns <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send the <emphasis role="bold">env:Receiver/ter:ActionNotSupported/ter:NoSuchService</emphasis> SOAP 1.2 fault message, if Analytics Service is not supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message, if Analytics Service is supported by the DUT.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-13-->
      <section xml:id="tc.DEVICE-1-1-13">
        <title>GET SERVICES – DEVICE SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-13
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Device Management Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/device/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">deviceServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/device/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">deviceServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/device/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">deviceServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/device/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">deviceServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">deviceServ</emphasis>.Capabilities does not contain valid Capabilities element for Device Management service from "http://www.onvif.org/ver10/device/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>

          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-14-->
      <section xml:id="tc.DEVICE-1-1-14">
        <title>GET SERVICES – MEDIA SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-14
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Media Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Media Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/media/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">mediaServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/media/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">mediaServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/media/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">mediaServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/media/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">mediaServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">mediaServ</emphasis>.Capabilities does not contain valid Capabilities element for Media service from "http://www.onvif.org/ver10/media/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>

          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-15-->
      <section xml:id="tc.DEVICE-1-1-15">
        <title>GET SERVICES – PTZ SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-15
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that PTZ Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. PTZ Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/ptz/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">ptzServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver20/ptz/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">ptzServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/ptz/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">ptzServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver20/ptz/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">ptzServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">ptzServ</emphasis>.Capabilities does not contain valid Capabilities element for PTZ service from "http://www.onvif.org/ver20/ptz/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>

          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-16-->
      <section xml:id="tc.DEVICE-1-1-16">
        <title>GET SERVICES – EVENT SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-16
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Event Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/events/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">eventsServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/events/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">eventsServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/events/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">eventsServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/events/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">eventsServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">eventsServ</emphasis>.Capabilities does not contain valid Capabilities element for Event service from "http://www.onvif.org/ver10/events/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-17-->
      <section xml:id="tc.DEVICE-1-1-17">
        <title>GET SERVICES – IMAGING SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-17
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Imaging Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Imaging Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/imaging/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">imagingServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver20/imaging/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">imagingServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/imaging/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">imagingServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver20/imaging/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">imagingServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">imagingServ</emphasis>.Capabilities does not contain valid Capabilities element for Imaging service from "http://www.onvif.org/ver20/imaging/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-18-->
      <section xml:id="tc.DEVICE-1-1-18">
        <title>DEVICE SERVICE CAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-18
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServiceCapabilities (for Device Management service)
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Device Management Service Capabilities of the DUT.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">Capabilities</emphasis>.System.DiscoveryNotSupported = true and <emphasis role="italic">Capabilities</emphasis>.Device.System.DiscoveryBye = true, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-19-->
      <section xml:id="tc.DEVICE-1-1-19">
        <title>GET SERVICES AND GET DEVICE SERVICE CAPABILITIES CONSISTENCY</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-19
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetServiceCapabilities (for Device Management Service)
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Get Services and Device Management Service Capabilities consistency.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">deviceServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/device/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">deviceCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-1-1-19.8">
              <para>
                If <emphasis role="italic">deviceCapabilities</emphasis> are not equal to <emphasis role="italic">deviceServ</emphasis>.Capabilities.Capabilities, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The following fields are compared at step <link linkend="tc.DEVICE-1-1-19.8">8</link>:
          <itemizedlist>
            <listitem>
              <para>
                Network
                <itemizedlist>
                  <listitem>
                    <para>
                      IPFilter
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ZeroConfiguration
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      IPVersion6
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DynDNS
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Dot11Configuration
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HostnameFromDHCP
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NTP
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                System
                <itemizedlist>
                  <listitem>
                    <para>
                      DiscoveryBye
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DiscoveryResolve
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FirmwareUpgrade
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HttpFirmwareUpgrade
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HttpSupportInformation
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HttpSystemBackup
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HttpSystemLogging
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteDiscovery
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SystemBackup
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SystemLogging
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Security
                <itemizedlist>
                  <listitem>
                    <para>
                      TLS1.0
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TLS1.1
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TLS1.2
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      OnboardKeyGeneration
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      AccessPolicyConfig
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Dot1X
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteUserHandling
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      X.509Token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SAMLToken
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      KerberosToken
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UsernameToken
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HttpDigest
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RELToken
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DefaultAccessPolicy
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SupportedEAPMethod
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Misc
                <itemizedlist>
                  <listitem>
                    <para>
                      AuxiliaryCommands
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-20-->
      <section xml:id="tc.DEVICE-1-1-20">
        <title>GET SERVICES – REPLAY SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-20
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Replay Service with using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Replay Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/replay/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">replayServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/replay/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">replayServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/replay/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">replayServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/replay/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">replayServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">replayServ</emphasis>.Capabilities does not contain valid Capabilities element for Replay service from "http://www.onvif.org/ver10/replay/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-21-->
      <section xml:id="tc.DEVICE-1-1-21">
        <title>GET SERVICES – RECORDING SEARCH SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-21
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Recording Search Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Recording Search Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/search/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">searchServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/search/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">searchServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/search/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">searchServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/search/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">searchServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">searchServ</emphasis>.Capabilities does not contain valid Capabilities element for Recording Search service from "http://www.onvif.org/ver10/search/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-22-->
      <section xml:id="tc.DEVICE-1-1-22">
        <title>GET SERVICES – RECORDING CONTROL SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-22
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Recording Control Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Recording Control Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/recording/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">recordingServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/recording/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">recordingServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/recording/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">recordingServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/recording/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">recordingServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">recordingServ</emphasis>.Capabilities does not contain valid Capabilities element for Recording Control service from "http://www.onvif.org/ver10/recording/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-23-->
      <section xml:id="tc.DEVICE-1-1-23">
        <title>GET SERVICES – RECEIVER SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-23
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Receiver Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. Receiver Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/receiver/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">receiverServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/receiver/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">receiverServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/receiver/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">receiverServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/receiver/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">receiverServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">receiverServ</emphasis>.Capabilities does not contain valid Capabilities element for Receiver service from "http://www.onvif.org/ver10/receiver/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-24-->
      <section xml:id="tc.DEVICE-1-1-24">
        <title>GET SERVICES – ACCESS CONTROL SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-24
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that Access Control Service is received using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Access Control Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/accesscontrol/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">accessControlServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/accesscontrol/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessControlServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/accesscontrol/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">accessControlServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/accesscontrol/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessControlServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessControlServ</emphasis>.Capabilities does not contain valid Capabilities element for Access Control service from "http://www.onvif.org/ver10/accesscontrol/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-25-->
      <section xml:id="tc.DEVICE-1-1-25">
        <title>GET SERVICES – DOOR CONTROL SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-25
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Door Control Service using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Door Control Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/doorcontrol/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">doorControlServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/doorcontrol/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">doorControlServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/doorcontrol/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">doorControlServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/doorcontrol/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">doorControlServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">doorControlServ</emphasis>.Capabilities does not contain valid Capabilities element for Door Control service from "http://www.onvif.org/ver10/doorcontrol/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-26-->
      <section xml:id="tc.DEVICE-1-1-26">
        <title>GET SERVICES – SECURITY CONFIGURATION SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-26
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Security Configuration Service using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Security Configuration Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/advancedsecurity/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">securityConfigurationServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/advancedsecurity/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">securityConfigurationServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/advancedsecurity/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">securityConfigurationServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/advancedsecurity/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">securityConfigurationServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">securityConfigurationServ</emphasis>.Capabilities does not contain valid Capabilities element for Security Configuration Service from "http://www.onvif.org/ver10/advancedsecurity/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-27-->
      <section xml:id="tc.DEVICE-1-1-27">
        <title>GET SERVICES – ACCESS RULES SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-27
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Access Rules Service using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Access Rules Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/accessrules/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">accessRulesServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/accessrules/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessRulesServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/accessrules/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">accessRulesServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/accessrules/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessRulesServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">accessRulesServ</emphasis>.Capabilities does not contain valid Capabilities element for Access Rules service from "http://www.onvif.org/ver10/accessrules/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-28-->
      <section xml:id="tc.DEVICE-1-1-28">
        <title>GET SERVICES – CREDENTIAL SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-28
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Credential Service using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Credential Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/credential/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">credentialServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/credential/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">credentialServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/credential/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">credentialServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/credential/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">credentialServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">credentialServ</emphasis>.Capabilities does not contain valid Capabilities element for Credential service from "http://www.onvif.org/ver10/credential/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-29-->
      <section xml:id="tc.DEVICE-1-1-29">
        <title>GET SERVICES – SCHEDULE SERVICE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-29
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify getting Schedule Service using GetServices request.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Schedule Service is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/schedule/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">scheduleServ</emphasis> := item from <emphasis role="italic">listOfServicesWithoutCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/schedule/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">scheduleServ</emphasis>.Capabilities is specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServicesWithCapabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">listOfServicesWithCapabilities</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/schedule/wsdl", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">scheduleServ</emphasis> := item from <emphasis role="italic">listOfServicesWithCapabilities</emphasis> list with Namespace = "http://www.onvif.org/ver10/schedule/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">scheduleServ</emphasis>.Capabilities is not specified, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">scheduleServ</emphasis>.Capabilities does not contain valid Schedule element for Credential service from "http://www.onvif.org/ver10/schedule/wsdl" namespace, FAIL the test and skip other steps.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-30-->
      <section xml:id="tc.DEVICE-1-1-30">
        <title>GET SERVICES AND GET CAPABILITIES CONSISTENCY</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-30
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetCapabilities
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Get Services and Get Capabilities consistency.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. GetCapabilities is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServices</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Category[0] := All
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--Device Management-->
            <listitem>
              <para>
                Set <emphasis role="italic">deviceServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/device/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">deviceServCapabilities</emphasis> := <emphasis role="italic">deviceServ</emphasis>.Capabilities.Capabilities.
              </para>
            </listitem>
            <!--Device Management - Network-->
            <!--Device Management - Network - IPFilter-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.IPFilter is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Network.IPFilter = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPFilter = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.IPFilter = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPFilter is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPFilter = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Network - ZeroConfiguration-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.ZeroConfiguration is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Network.ZeroConfiguration = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@ZeroConfiguration = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.ZeroConfiguration = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@ZeroConfiguration is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@ZeroConfiguration = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Network - IPVersion6-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.IPVersion6 is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Network.IPVersion6 = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPVersion6 = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.IPVersion6 = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPVersion6 is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@IPVersion6 = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Network - DynDNS-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.DynDNS is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Network.DynDNS = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@DynDNS = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.DynDNS = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@DynDNS is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@DynDNS = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Network - Extension-->
            <!--Device Management - Network - Extension - Dot11Configuration-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.Extension.Dot11Configuration is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Network.Extension.Dot11Configuration = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@Dot11Configuration = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Network.Extension.Dot11Configuration = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@Dot11Configuration is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Network.@Dot11Configuration = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System-->
            <!--Device Management - System - DiscoveryResolve-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryResolve is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryResolve = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryResolve = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryResolve = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryResolve is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryResolve = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - DiscoveryBye-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryBye is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryBye = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryBye = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.DiscoveryBye = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryBye is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@DiscoveryBye = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - RemoteDiscovery-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.RemoteDiscovery is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.RemoteDiscovery = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@RemoteDiscovery = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.RemoteDiscovery = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@RemoteDiscovery is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@RemoteDiscovery = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - SystemBackup-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.SystemBackup is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.SystemBackup = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemBackup = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.SystemBackup = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemBackup is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemBackup = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - SystemLogging-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.SystemLogging is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.SystemLogging = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemLogging = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.SystemLogging = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemLogging is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@SystemLogging = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - FirmwareUpgrade-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.FirmwareUpgrade is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.FirmwareUpgrade = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@FirmwareUpgrade = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.FirmwareUpgrade = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@FirmwareUpgrade is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@FirmwareUpgrade = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - Extension-->
            <!--Device Management - System - Extension - HttpFirmwareUpgrade-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpFirmwareUpgrade is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpFirmwareUpgrade = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpFirmwareUpgrade = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpFirmwareUpgrade = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpFirmwareUpgrade is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpFirmwareUpgrade = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - Extension - HttpSystemBackup-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemBackup is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemBackup = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemBackup = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemBackup = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemBackup is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemBackup = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - Extension - HttpSystemLogging-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemLogging is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemLogging = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemLogging = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSystemLogging = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemLogging is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSystemLogging = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - System - Extension - HttpSupportInformation-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSupportInformation is skipped or <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSupportInformation = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSupportInformation = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.System.Extension.HttpSupportInformation = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSupportInformation is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.System.@HttpSupportInformation = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - IO-->
            <!--Device Management - Security-->
            <!--Device Management - Security - TLS1.1-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.1 is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.1 = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.1 = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.1 = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.1 is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.1 = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - TLS1.2-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.2 is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.2 = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.2 = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.TLS1.2 = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.2 is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.2 = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - OnboardKeyGeneration-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.OnboardKeyGeneration is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.OnboardKeyGeneration = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@OnboardKeyGeneration = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.OnboardKeyGeneration = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@OnboardKeyGeneration is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@OnboardKeyGeneration = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - AccessPolicyConfig-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.AccessPolicyConfig is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.AccessPolicyConfig = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@AccessPolicyConfig = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.AccessPolicyConfig = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@AccessPolicyConfig is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@AccessPolicyConfig = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - X.509Token-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.X.509Token is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.X.509Token = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@X.509Token = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.X.509Token = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@X.509Token is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@X.509Token = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - SAMLToken-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.SAMLToken is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.SAMLToken = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SAMLToken = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.SAMLToken = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SAMLToken is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SAMLToken = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - KerberosToken-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.KerberosToken is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.KerberosToken = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@KerberosToken = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.KerberosToken = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@KerberosToken is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@KerberosToken = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - RELToken-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.RELToken is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.RELToken = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RELToken = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.RELToken = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RELToken is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RELToken = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - Extension-->
            <!--Device Management - Security - Extension - TLS1.0-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.TLS1.0 is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.TLS1.0 = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.0 = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.TLS1.0 = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.0 is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@TLS1.0 = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - Extension - Extension-->
            <!--Device Management - Security - Extension - Extension - Dot1X-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.Dot1X is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.Dot1X = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@Dot1X = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.Dot1X = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@Dot1X is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@Dot1X = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - Extension - Extension - SupportedEAPMethod (int list)-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.SupportedEAPMethod is skipped:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SupportedEAPMethods is not empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.SupportedEAPMethod is not empty:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SupportedEAPMethods is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SupportedEAPMethods is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      For each <emphasis role="italic">supportedEAPMethod1</emphasis> from <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.SupportedEAPMethod list:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@SupportedEAPMethods does not contain <emphasis role="italic">supportedEAPMethod1</emphasis>, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Device Management - Security - Extension - Extension - RemoteUserHandling-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.RemoteUserHandling is skipped or <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.RemoteUserHandling = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RemoteUserHandling = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Device.Security.Extension.Extension.RemoteUserHandling = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RemoteUserHandling is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.Security.@RemoteUserHandling = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Events-->
            <listitem>
              <para>
                Set <emphasis role="italic">eventsServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/events/wsdl".
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">eventsServCapabilities</emphasis> := <emphasis role="italic">eventsServ</emphasis>.Capabilities.Capabilities.
              </para>
            </listitem>
            <!--Events - WSSubscriptionPolicySupport (mandatory)-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSSubscriptionPolicySupport = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSSubscriptionPolicySupport = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSSubscriptionPolicySupport = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSSubscriptionPolicySupport is skipped or <emphasis role="italic">eventsServCapabilities</emphasis>.@WSSubscriptionPolicySupport = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Events - WSPullPointSupport(mandatory)-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSPullPointSupport = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPullPointSupport = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSPullPointSupport = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPullPointSupport is skipped or <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPullPointSupport = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Events - WSPausableSubscriptionManagerInterfaceSupport(mandatory)-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSPausableSubscriptionManagerInterfaceSupport = false:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPausableSubscriptionManagerInterfaceSupport = true, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis>.Events.WSPausableSubscriptionManagerInterfaceSupport = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPausableSubscriptionManagerInterfaceSupport is skipped or <emphasis role="italic">eventsServCapabilities</emphasis>.@WSPausableSubscriptionManagerInterfaceSupport = false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Analytics-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Analytics element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/analytics/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">analyticsServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver20/analytics/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">analyticsServCapabilities</emphasis> := <emphasis role="italic">analyticsServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Analytics - RuleSupport(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics.RuleSupport = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">analyticsServCapabilities</emphasis>.@RuleSupport = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics.RuleSupport = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">analyticsServCapabilities</emphasis>.@RuleSupport is skipped or <emphasis role="italic">analyticsServCapabilities</emphasis>.@RuleSupport = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Analytics - AnalyticsModuleSupport(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics.AnalyticsModuleSupport = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">analyticsServCapabilities</emphasis>.@AnalyticsModuleSupport = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Analytics.AnalyticsModuleSupport = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">analyticsServCapabilities</emphasis>.@AnalyticsModuleSupport is skipped or <emphasis role="italic">analyticsServCapabilities</emphasis>.@AnalyticsModuleSupport = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Imaging-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Imaging element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/imaging/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Media-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Media element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/media/wsdl"", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">mediaServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/media/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">mediaServCapabilities</emphasis> := <emphasis role="italic">mediaServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Media - StreamingCapabilities(mandatory)-->
                  <!--Media - StreamingCapabilities(mandatory) - RTPMulticast-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTPMulticast is skipped or <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTPMulticast = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTPMulticast = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTPMulticast = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTPMulticast is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.StreamingCapabilities.@RTPMulticast = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Media - StreamingCapabilities(mandatory) - RTP_TCP-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_TCP is skipped or <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_TCP = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTP_TCP = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_TCP = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTP_TCP is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.StreamingCapabilities.@RTP_TCP = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Media - StreamingCapabilities(mandatory) - RTP_RTSP_TCP-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_RTSP_TCP is skipped or <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_RTSP_TCP = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTP_RTSP_TCP = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.StreamingCapabilities.RTP_RTSP_TCP = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.StreamingCapabilities.@RTP_RTSP_TCP is skipped or <emphasis role="italic">deviceServCapabilities</emphasis>.StreamingCapabilities.@RTP_RTSP_TCP = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Media - Extension-->
                  <!--Media - Extension - ProfileCapabilities-->
                  <!--Media - Extension - ProfileCapabilities - MaximumNumberOfProfiles(int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Media.Extension.ProfileCapabilities.MaximumNumberOfProfiles is not skipped:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">mediaServCapabilities</emphasis>.ProfileCapabilities.@MaximumNumberOfProfiles is skipped or <emphasis role="italic">mediaServCapabilities</emphasis>.ProfileCapabilities.@MaximumNumberOfProfiles != <emphasis role="italic">capabilities</emphasis>.Media.Extension.ProfileCapabilities.MaximumNumberOfProfiles, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--PTZ-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains PTZ element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver20/ptz/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Extension - DeviceIO-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Extension.DeviceIO element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.0em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/deviceIO/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">deviceIOServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/deviceIO/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">deviceIOServCapabilities</emphasis> := <emphasis role="italic">deviceIOServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Extension - DeviceIO - VideoSources(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoSources = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoSources > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoSources > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoSources is skipped or <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoSources != <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoSources, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - DeviceIO - VideoOutputs(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoOutputs = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoOutputs > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoOutputs > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoOutputs is skipped or <emphasis role="italic">deviceIOServCapabilities</emphasis>.@VideoOutputs != <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.VideoOutputs, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - DeviceIO - AudioSources(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioSources = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioSources > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioSources > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioSources is skipped or <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioSources != <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioSources, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - DeviceIO - AudioOutputs(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioOutputs = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioOutputs > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioOutputs > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioOutputs is skipped or <emphasis role="italic">deviceIOServCapabilities</emphasis>.@AudioOutputs != <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.AudioOutputs, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - DeviceIO - RelayOutputs(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.RelayOutputs = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@RelayOutputs > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.RelayOutputs > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">deviceIOServCapabilities</emphasis>.@RelayOutputs is skipped or <emphasis role="italic">deviceIOServCapabilities</emphasis>.@RelayOutputs != <emphasis role="italic">capabilities</emphasis>.Extension.DeviceIO.RelayOutputs, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--OUT OF SCOPE: Extension - Display-->
            <!--Extension - Recording-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Extension.Recording element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/recording/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">recordingServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/recording/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">recordingServCapabilities</emphasis> := <emphasis role="italic">recordingServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Extension - Recording - DynamicRecordings(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Recording.DynamicRecordings = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicRecordings = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Recording.DynamicRecordings = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicRecordings is skipped or <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicRecordings = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - Recording - DynamicTracks(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Recording.DynamicTracks = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicTracks = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Recording.DynamicTracks = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicTracks is skipped or <emphasis role="italic">recordingServCapabilities</emphasis>.@DynamicTracks = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Extension - Search-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Extension.Search element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/search/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">searchServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/search/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">searchServCapabilities</emphasis> := <emphasis role="italic">searchServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Extension - Search - MetadataSearch(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Search.MetadataSearch = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">searchServCapabilities</emphasis>.@MetadataSearch = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Search.MetadataSearch = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">searchServCapabilities</emphasis>.@MetadataSearch is skipped or <emphasis role="italic">searchServCapabilities</emphasis>.@MetadataSearch = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Extension - Replay-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Extension.Replay element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/replay/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--Extension - Receiver-->
            <listitem>
              <para>
                If <emphasis role="italic">capabilities</emphasis> contains Extension.Receiver element:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.0em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">listOfServices</emphasis> does not contain item with Namespace = "http://www.onvif.org/ver10/receiver/wsdl", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">receiverServ</emphasis> := item from <emphasis role="italic">listOfServices</emphasis> list with Namespace = "http://www.onvif.org/ver10/receiver/wsdl".
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set <emphasis role="italic">receiverServCapabilities</emphasis> := <emphasis role="italic">receiverServ</emphasis>.Capabilities.Capabilities.
                    </para>
                  </listitem>
                  <!--Extension - Receiver - RTP_Multicast(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_Multicast = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_Multicast = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_Multicast = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_Multicast is skipped or <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_Multicast = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - Receiver - RTP_TCP(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_TCP = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_TCP = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_TCP = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_TCP is skipped or <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_TCP = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - Receiver - RTP_RTSP_TCP(mandatory)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_RTSP_TCP = false:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_RTSP_TCP = true, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.RTP_RTSP_TCP = true:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_RTSP_TCP is skipped or <emphasis role="italic">receiverServCapabilities</emphasis>.@RTP_RTSP_TCP = false, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - Receiver - SupportedReceivers(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.SupportedReceivers = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@SupportedReceivers > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.SupportedReceivers > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@SupportedReceivers != <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.SupportedReceivers, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <!--Extension - Receiver - MaximumRTSPURILength(mandatory,int)-->
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.MaximumRTSPURILength = 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@MaximumRTSPURILength > 0, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.MaximumRTSPURILength > 0:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">receiverServCapabilities</emphasis>.@MaximumRTSPURILength is skipped or <emphasis role="italic">receiverServCapabilities</emphasis>.@MaximumRTSPURILength != <emphasis role="italic">capabilities</emphasis>.Extension.Receiver.MaximumRTSPURILength, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <!--OUT OF SCOPE: Extension - AnalyticsDevice-->
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-1-1-31-->
      <section xml:id="tc.DEVICE-1-1-31">
        <title>GET SERVICES - XADDR</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-1-1-31
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> GetServices (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify XAddr in Get ServicesResponse.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices is supported by the DUT. If DUT supports HTTPS, then HTTPS is configured on the DUT, if TLS Server is not supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-1-1-31.3">
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message over HTTP with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      IncludeCapability := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                <itemizedlist>
                  <listitem>
                    <para>
                      Service list =: <emphasis role="italic">listOfServices</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set the following
                <itemizedlist>
                  <listitem>
                    <para>
                      <emphasis role="italic">uriScheme</emphasis> := "http"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      <emphasis role="italic">uriHost</emphasis> := host of uri used for <emphasis role="bold" service="skip">GetServices</emphasis> request at step <xref linkend="tc.DEVICE-1-1-31.3"/> (IP or hostname)
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      <emphasis role="italic">uriHostPort</emphasis> := host port of uri used for <emphasis role="bold" service="skip">GetServices</emphasis> request at step <xref linkend="tc.DEVICE-1-1-31.3"/>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                For each Service <emphasis role="italic">service</emphasis> in <emphasis role="italic">listOfServices</emphasis> repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client checks <emphasis role="italic">service</emphasis>.XAddr uri by following the procedure mentioned in <xref linkend="Annex_HelperCheckXAddr"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">xAddr</emphasis> :=  <emphasis role="italic">service</emphasis>.XAddr - XAddr to check
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">uriScheme</emphasis> - Uri Scheme
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">uriHost</emphasis> - Uri host
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">uriHostPort</emphasis> - Uri host port
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>




                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If HTTPS feature is supported by the DUT:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client configures HTTPS if required by following the procedure mentioned in <xref linkend="Annex_HelperCheckAndConfigureHTTPS"/>.
                    </para>
                  </listitem>
                  <listitem xml:id="tc.DEVICE-1-1-31.7.2" xreflabel="7.2">
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetServices</emphasis> message over HTTPS with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            IncludeCapability := false
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetServicesResponse</emphasis> message with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>
                            Service list =: <emphasis role="italic">listOfServices</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Set the following
                      <itemizedlist>
                        <listitem>
                          <para>
                            <emphasis role="italic">uriScheme</emphasis> := "https"
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            <emphasis role="italic">uriHost</emphasis> := host of uri used for <emphasis role="bold" service="skip">GetServices</emphasis> request at step <xref linkend="tc.DEVICE-1-1-31.7.2"/> (IP or hostname)
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            <emphasis role="italic">uriHostPort</emphasis> := host port of uri used for <emphasis role="bold" service="skip">GetServices</emphasis> request at step <xref linkend="tc.DEVICE-1-1-31.7.2"/>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      For each Service <emphasis role="italic">service</emphasis> in <emphasis role="italic">listOfServices</emphasis> repeat the following steps:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            ONVIF Client checks <emphasis role="italic">service</emphasis>.XAddr uri by following the procedure mentioned in <xref linkend="Annex_HelperCheckXAddr"/> with the following input and output parameters
                            <itemizedlist>
                              <listitem>
                                <para>
                                  in <emphasis role="italic">xAddr</emphasis> :=  <emphasis role="italic">service</emphasis>.XAddr - XAddr to check
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  in <emphasis role="italic">uriScheme</emphasis> - Uri Scheme
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  in <emphasis role="italic">uriHost</emphasis> - Uri host
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  in <emphasis role="italic">uriHostPort</emphasis> - Uri host port
                                </para>
                              </listitem>
                            </itemizedlist>
                          </para>
                        </listitem>




                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>

          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetServicesResponse</emphasis> message.
              </para>
            </listitem>

          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> see [RFC3986] for details of uri syntax.
        </para>
      </section>
    </section>
    <!--Network-->
    <section xml:id="tc.device_management.network">
      <title>Network</title>
      <!--DEVICE-2-1-1-->
      <section xml:id="tc.DEVICE-2-1-1">
        <title>NETWORK COMMAND HOSTNAME CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get hostname (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetHostname
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve hostname of the DUT using GetHostname command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetHostname</emphasis> request to retrieve Hostname of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetHostnameResponse</emphasis> from the DUT (FromDHCP = true or false, Name = Hostname).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetHostnameResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-3-->
      <section xml:id="tc.DEVICE-2-1-3">
        <title>NETWORK COMMAND SETHOSTNAME TEST ERROR CASE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get system date and time (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> Set hostname
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of DUT for invalid hostname configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Testing environment (DHCP server) should not change the IP address of DUT during this test case execution.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetHostname</emphasis> request to get the Hostname of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns configured currently Hostname settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetHostname</emphasis> request (Name = "Onvif_test1") to configure the hostname.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidHostname</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify hostname from DUT through <emphasis role="bold">GetHostname</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid hostname in <emphasis role="bold">GetHostnameResponse</emphasis> message (FromDHCP = true or false, Name = Hostname).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send a correct fault code in the SOAP 1.2 fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidHostname</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetHostnameResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "Onvif_test1" as its Hostname.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> Hostname "Onvif_test1" is just an example.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidHostname">Annex A.2</link> for Invalid Hostname.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for SOAP 1.2 fault message definitions.
        </para>
      </section>
      <!--DEVICE-2-1-4-->
      <section xml:id="tc.DEVICE-2-1-4">
        <title>GET DNS CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve DNS configurations of DUT through GetDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDNS</emphasis> request to retrieve DNS configurations of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetDNSResponse</emphasis> from the DUT (DNSInformation [FromDHCP = true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of DNS Servers manually configured]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP = true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of DNS Servers manually configured]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-5-->
      <section xml:id="tc.DEVICE-2-1-5">
        <title>SET DNS CONFIGURATION - SEARCHDOMAIN</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure DNS Search Domain setting at the DUT using SetDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDNS</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = false, SearchDomain = "domain.name").
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetDNSResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DNS configurations at the DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> message (DNSInformation [FromDHCP = false, SearchDomain = "domain.name"]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request to restore the original settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP = false, SearchDomain = "domain.name"]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-6-->
      <section xml:id="tc.DEVICE-2-1-6">
        <title>SET DNS CONFIGURATION - DNSMANUAL IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure IPv4 DNS server address setting at the DUT using SetDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv4DHCP">Annex A.13</link>).
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDNS</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = false, DNSManual = IPv4, "10.1.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetDNSResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DNS configurations in DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> message (DNSInformation [FromDHCP = false, DNSManual = IPv4, "10.1.1.1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP = false, DNSManual = IPv4, "10.1.1.1"]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-7-->
      <section xml:id="tc.DEVICE-2-1-7">
        <title>SET DNS CONFIGURATION - DNSMANUAL IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-7
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure IPv6 DNS server address setting at the DUT using SetDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv6DHCP">Annex A.15</link>). IPv6 is implemented by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDNS</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = false, DNSManual = IPv6, "2001:1:1:1:1:1:1:1").
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetDNSResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DNS configurations at the DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> message (DNSInformation [FromDHCP = false, DNSManual = IPv6, "2001:1:1:1:1:1:1:1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP = false, DNSManual = IPv6, "2001:1:1:1:1:1:1:1"]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-8-->
      <section xml:id="tc.DEVICE-2-1-8">
        <title>SET DNS CONFIGURATION - FROMDHCP</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-8
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure DNS FromDHCP setting in DUT through SetDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Discovery is supported by the DUT. DHCP is enabled (see Annex A.12 and A.14).
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDNS</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = true).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetDNSResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DNS configurations in the DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> message (DNSInformation [FromDHCP = true, DNSFromDHCP = list of DNS Servers obtained from DHCP]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP = true, DNSFromDHCP = list of DNS Servers obtained from DHCP, the list can be empty if the DHCP server does not deliver DNS Addresses]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-9-->
      <section xml:id="tc.DEVICE-2-1-9">
        <title>SET DNS CONFIGURATION - DNSMANUAL INVALID IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-9
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of DUT for invalid DNS IPv4 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv4DHCP">Annex A.13</link>).
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = false, DNSManual = IPv4, "10.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve DNS configurations from DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT sends valid DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> 	message (DNSInformation [FromDHCP=true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of manual DNS Servers]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "10.1.1" as DNS Server address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP=true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of manual DNS Servers]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-10-->
      <section xml:id="tc.DEVICE-2-1-10">
        <title>SET DNS CONFIGURATION - DNSMANUAL INVALID IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-10
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for invalid DNS IPv6 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv6DHCP">Annex A.15</link>). IPv6 is implemented by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> request (FromDHCP = false, DNSManual = IPv6, "FF02:1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve DNS configurations from DUT through <emphasis role="bold">GetDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid DNS configurations in the <emphasis role="bold">GetDNSResponse</emphasis> message (DNSInformation [FromDHCP=true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of manual DNS Servers]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "FF02:1" as DNS Server address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. DNSInformation [FromDHCP=true or false, SearchDomain = domain to search if hostname is not fully qualified, DNSFromDHCP = list of DNS Servers obtained from DHCP, DNSManual = list of manual DNS Servers]) in the <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-11-->
      <section xml:id="tc.DEVICE-2-1-11">
        <title>GET NTP CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve NTP Server settings of the DUT through GetNTP command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. NTP is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNTP</emphasis> request to retrieve NTP Server settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetNTPResponse</emphasis> from the DUT (NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]) in the <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-12-->
      <section xml:id="tc.DEVICE-2-1-12">
        <title>SET NTP CONFIGURATION - NTPMANUAL IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-12
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure NTP IPv4 address settings on a DUT using SetNTP command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv4DHCP">Annex A.13</link>).NTP is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNTP</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request (FromDHCP = false, NTPManual [Type = IPv4, IPv4Address = "10.1.1.1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNTPResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the NTP Server settings in DUT through <emphasis role="bold">GetNTP</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT sends its NTP Server settings in the <emphasis role="bold">GetNTPResponse</emphasis> message (NTPInformation [FromDHCP= false, NTPManual [Type = IPv4, IPv4Address = "10.1.1.1"]]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct NTP Server information (i.e. NTPInformation [FromDHCP=false, NTPManual [Type = IPv4, IPv4Address = "10.1.1.1"]]) in <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-13-->
      <section xml:id="tc.DEVICE-2-1-13">
        <title>SET NTP CONFIGURATION - NTPMANUAL IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-13
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure NTP IPv6 address settings on a DUT using SetNTP command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv6DHCP">Annex A.15</link>).NTP is supported by the DUT. IPv6 is implemented by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNTP</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request (FromDHCP = false, NTPManual [Type = IPv6, IPv6Address = "2001:1:1:1:1:1:1:1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNTPResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the NTP Server settings in DUT through <emphasis role="bold">GetNTP</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its NTP Server settings in the <emphasis role="bold">GetNTPResponse</emphasis> message (NTPInformation [FromDHCP= false, NTPManual [Type = IPv6, IPv6Address = "2001:1:1:1:1:1:1:1"]]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request to restore the original settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct NTP Server information (i.e. NTPInformation [FromDHCP=false, NTPManual [Type = IPv6, IPv6Address = "2001:1:1:1:1:1:1:1"]]) in <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-14-->
      <section xml:id="tc.DEVICE-2-1-14">
        <title>SET NTP CONFIGURATION - FROMDHCP</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-14
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure DUT's NTP settings via DHCP server using SetNTP command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is enabled (see Annex A.12 and A.14). NTP is supported by the DUT. Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNTP</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request (FromDHCP = true).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNTPResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the NTP Server settings in DUT through <emphasis role="bold">GetNTP</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its NTP Server settings in the <emphasis role="bold">GetNTPResponse</emphasis> message (NTPInformation [FromDHCP= true, NTPFromDHCP = list of NTP Servers obtained from DHCP]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. NTPInformation [FromDHCP = true, NTPFromDHCP = list of NTP Servers obtained from DHCP, the list can be empty if the DHCP server does not deliver NTP Addresses]) in the <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-15-->
      <section xml:id="tc.DEVICE-2-1-15">
        <title>SET NTP CONFIGURATION - NTPMANUAL INVALID IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-15
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for invalid NTP IPv4 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv4DHCP">Annex A.13</link>). NTP is supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request (FromDHCP = false, NTPManual [Type = IPv4, IPv4Address = "10.1.1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve NTP Server configurations from DUT through <emphasis role="bold">GetNTP</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid NTP Server configurations in the <emphasis role="bold">GetNTPResponse</emphasis> message (NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "10.1.1" as NTP Server address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct NTP Server information (i.e. NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]) in <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
      </section>
      <!--DEVICE-2-1-16-->
      <section xml:id="tc.DEVICE-2-1-16">
        <title>SET NTP CONFIGURATION - NTPMANUAL INVALID IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-16
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set NTP settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNTP
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for invalid NTP IPv6 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DHCP is disabled (see <link linkend="Annex_HelperTurnOffIPv6DHCP">Annex A.15</link>). NTP is supported by DUT. IPv6 is implemented by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNTP</emphasis> request (FromDHCP = false, NTPManual [Type = IPv6, IPv6Address = "FF02:1"]).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve NTP Server configurations from DUT through <emphasis role="bold">GetNTP</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid NTP Server configurations in the <emphasis role="bold">GetNTPResponse</emphasis> message (NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "FF02:1" as NTP Server address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct NTP Server information (i.e. NTPInformation [FromDHCP = true or false, NTPFromDHCP = list of NTP Servers obtained from DHCP, NTPManual = list of NTP Servers manually configured]) in <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-17-->
      <section xml:id="tc.DEVICE-2-1-17">
        <title>GET NETWORK INTERFACE CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-17
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get network interface configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetNetworkInterfaces
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve network interface configurations of DUT through GetNetworkInterfaces command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkInterfaces</emphasis> request to retrieve network interface configuration settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> from DUT (NetworkInterfaces = list of network interfaces).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network interface information (i.e. NetworkInterfaces = list of network interfaces) in <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-18-->
      <section xml:id="tc.DEVICE-2-1-18">
        <title>SET NETWORK INTERFACE CONFIGURATION - IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-18
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network interface configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkInterfaces
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure IPv4 address setting on a DUT using SetNetworkInterfaces command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. ONVIF Client knows the available network interface token of DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := first interface from <emphasis role="italic">networkInterfacesList1</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-18.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.Manual.Address := another address in the same subnet as an original address
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.Manual.PrefixLength := current IPv4 prefix of the DUT
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4.DHCP := false
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6 skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>           
            
            <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.5em"?>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client uses value of NetworkInterface.IPv4.Manual.Address from step <xref linkend="tc.DEVICE-2-1-18.6"/> as ID of the DUT for further steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4 is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Enabled = false, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Config.Manual is skipped, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Config.Manual is not equal to address at step <link linkend="tc.DEVICE-2-1-18.6">6</link>, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv4.Config.DHCP = true, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-18.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-18.RestoreNetwork" xreflabel="19">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-2-1-19-->
      <section xml:id="tc.DEVICE-2-1-19">
        <title>SET NETWORK INTERFACE CONFIGURATION - IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-19
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network interface configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkInterfaces
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> Network Configuration is supported by the DUT. To configure IPv6 address setting on a DUT through SetNetworkInterfaces command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList1</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList1</emphasis> list with specified IPv6.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-19.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Link skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.MTU skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv4 skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Enabled := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.AcceptRouterAdvert := <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv6.Config.AcceptRouterAdvert
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual.Address := "2001:1:1:1:1:1:1:1"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.Manual.PrefixLength := 64
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.IPv6.DHCP := Off
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      NetworkInterface.Extension skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">rebootNeeded</emphasis> = true:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Message
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            
            
            <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT sends <emphasis role="bold">Hello</emphasis> message from a newly configured address:
                      <itemizedlist>
                        <listitem>
                          <para>
                            EndpointReference
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Types =: <emphasis role="italic">types</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Scopes
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            XAddrs =: <emphasis role="italic">xAddrs</emphasis>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MetadataVersion
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">types</emphasis> is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xAddrs</emphasis> is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList2</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Set <emphasis role="italic">updatedNetworkSettings</emphasis> := item from <emphasis role="italic">networkInterfacesList2</emphasis> list with @token = <emphasis role="italic">defaultNetworkSettings</emphasis>.@token.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6 is skipped or empty, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Enabled = false, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.Manual is skipped, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.Manual is not equal to address at step <link linkend="tc.DEVICE-2-1-19.6">6</link>, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedNetworkSettings</emphasis>.IPv6.Config.DHCP != Off, FAIL the test and go to step <xref linkend="tc.DEVICE-2-1-19.RestoreNetwork"/>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-19.RestoreNetwork" xreflabel="19">
              <para>
                ONVIF Client restores the original settings  by following the procedure mentioned in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> with the following input and output parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">defaultNetworkSettings</emphasis> - Original default network settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-2-1-20-->
      <section xml:id="tc.DEVICE-2-1-20">
        <title>SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-20
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network interface configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkInterfaces
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for invalid IPv4 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request to retrieve the configured network interfaces of the device.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns its network interface settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkInterfaces</emphasis> request (InterfaceToken = available network interface, NetworkInterface.IPv4.Enable = true, NetworkInterface.IPv4.Manual.Address = "10.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve network interface configurations from DUT through <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT sends valid network interface configurations in the <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv4Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "10.1.1" as DUT IPv4 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network interface information (i.e. NetworkInterfaces = list of network interfaces) in <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
      </section>
      <!--DEVICE-2-1-21-->
      <section xml:id="tc.DEVICE-2-1-21">
        <title>
          SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6
        </title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-21
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network interface configuration (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkInterfaces
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for invalid IPv6 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request to get the network interface settings of the device.
              </para>
            </listitem>
            <listitem>
              <para>
                The device returns its network interfaces.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkInterfaces</emphasis> request (InterfaceToken = available network interface, NetworkInterface.IPv6.Enable = true, NetworkInterface.IPv6.Manual.Address = "FF02:1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve network interface configurations from DUT through <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid network interface configurations in the <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "FF02:1" as DUT IPv6 address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network interface information (i.e. NetworkInterfaces = list of network interfaces) in <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-33-->
      <section xml:id="tc.DEVICE-2-1-33">
        <title>GET NETWORK PROTOCOLS CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-33
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get network protocols (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetNetworkProtocols
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve network protocols configurations of the DUT using GetNetworkProtocols command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkProtocols</emphasis> request to retrieve configured network protocols of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> from DUT (NetworkProtocols = list of configured network protocols).
              </para>
            </listitem>
            <listitem>
              <para>
                Check that the mandatory HTTP protocol is present on the list.
              </para>
            </listitem>
            <listitem>
              <para>
                Check that the RTSP protocol is present on the list, if Real-time Streaming or Replay Service is supported by the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information in the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message (i.e. NetworkProtocols = list of configured network protocols, contains HTTP and contains RTSP Real-time Streaming or Replay Service is supported by the DUT).
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-34-->
      <section xml:id="tc.DEVICE-2-1-34">
        <title>SET NETWORK PROTOCOLS CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-34
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network protocols (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkProtocols
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure network protocols setting on a DUT using SetNetworkProtocols command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkProtocols</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If RTSP protocol is not supported, skip other steps and go to the next test.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkProtocols</emphasis> request (NetworkProtocols [Name = RTSP, Enabled = true, Port = 10554]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNetworkProtocolsResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the network protocols settings in DUT through <emphasis role="bold">GetNetworkProtocols</emphasis> request.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-34.8">
              <para>
                The DUT sends its network protocols settings in the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message (NetworkProtocols [Name = RTSP, Enabled = true, Port = 10554]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkProtocols</emphasis> request (NetworkProtocols [Name = RTSP, Enabled = false, Port = 10554]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNetworkProtocolsResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the network protocols settings in DUT through <emphasis role="bold">GetNetworkProtocols</emphasis> request.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-34.12">
              <para>
                DUT sends its network protocols settings in the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message (NetworkProtocols [Name = RTSP, Enabled = false, Port = integer]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkProtocols</emphasis> request to restore the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network protocols information (i.e. NetworkProtocols [Name = RTSP, Enabled = true, Port = 10554]) in <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message at step <link linkend="tc.DEVICE-2-1-34.8">8</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network protocols information (i.e. NetworkProtocols [Name = RTSP, Enabled = false, Port = integer]) in <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message at step <link linkend="tc.DEVICE-2-1-34.12">12</link>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-35-->
      <section xml:id="tc.DEVICE-2-1-35">
        <title>SET NETWORK PROTOCOLS CONFIGURATION - UNSUPPORTED PROTOCOLS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-35
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set network protocols (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkProtocols
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of the DUT for unsupported protocols configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. DUT does not support all protocols.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client will retrieve network protocol configurations from the DUT through <emphasis role="bold">GetNetworkProtocols</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends network protocol configurations in the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message (NetworkProtocols = supported protocols).
              </para>
            </listitem>
            <listitem>
              <para>
                If HTTPS is not on the list of supported protocols, select HTTPS for the test as Protocol1. Otherwise, if RTSP is not on the list of supported protocols, select RTSP for the test as Protocol1. Otherwise, skip other steps and go to the next test.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkProtocols</emphasis> request (NetworkProtocols [Name = Protocol1, Enabled = true, Port = 10554]).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:ServiceNotSupported</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve network protocol configurations from DUT through <emphasis role="bold">GetNetworkProtocols</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid network protocol configurations in the <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message (NetworkProtocols = supported protocols).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:ServiceNotSupported</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned unsupported protocols in <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct network protocols information (i.e. NetworkProtocols = supported protocols) in <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-25-->
      <section xml:id="tc.DEVICE-2-1-25">
        <title>GET NETWORK DEFAULT GATEWAY CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-25
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get default gateway (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetNetworkDefaultGateway
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve default gateway setting of DUT through GetNetworkDefaultGateway command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request to retrieve default gateway settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> from DUT (IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway address).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct default gateway information (i.e. IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway address) in <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-28-->
      <section xml:id="tc.DEVICE-2-1-28">
        <title>SET NETWORK DEFAULT GATEWAY CONFIGURATION - INVALID IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-28
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set default gateway (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkDefaultGateway
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of DUT for invalid default gateway IPv4 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request (IPv4Address = "10.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidGatewayAddress</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve default gateway configurations from DUT through <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid default gateway configurations in the <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message (IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway addresses).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send a correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidGatewayAddress</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "10.1.1" as IPv4 default gateway address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct default gateway information (i.e. IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway addresses) in <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
      </section>
      <!--DEVICE-2-1-29-->
      <section xml:id="tc.DEVICE-2-1-29">
        <title>SET NETWORK DEFAULT GATEWAY CONFIGURATION - INVALID IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-29
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set default gateway (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkDefaultGateway
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify behavior of DUT for invalid default gateway IPv6 address configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. IPv6 is implemented by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request (IPv6Address = "FF02:1").
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidGatewayAddress</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                Retrieve default gateway configurations from DUT through <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends valid default gateway configurations in the <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message (IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway addresses).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct fault code in the SOAP fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidGatewayAddress</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returned "FF02:1" as IPv6 default gateway address.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct default gateway information (i.e. IPv4Address = list of IPv4 default gateway address, IPv6Address = list of IPv6 default gateway addresses) in <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-30-->
      <section xml:id="tc.DEVICE-2-1-30">
        <title>SET NETWORK DEFAULT GATEWAY CONFIGURATION - IPV4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-30
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set default gateway (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkDefaultGateway
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure default gateway IPv4 address setting on a DUT using SetNetworkDefaultGateway command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will follow the procedure described in <link linkend="Annex_HelperTurnOffIPv4DHCP">Annex A.13</link> to turn off IPv4 DHCP and set manual IP configuration.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request to retrieve the original settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> (original settings).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request (IPv4Address = "10.1.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNetworkDefaultGatewayResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the configured default gateways settings in DUT through <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT sends its configured default gateways settings in the <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message (IPv4Address = "10.1.1.1").
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request to restore the original network default gateway settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will follow the procedure described in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> to turn on IPv4 DHCP to restore IP configuration.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct default gateway information (i.e. IPv4Address = "10.1.1.1") in <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_ipv4_address">Annex A.6</link> valid IPv4 address definition.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-2-1-31-->
      <section xml:id="tc.DEVICE-2-1-31">
        <title>SET NETWORK DEFAULT GATEWAY CONFIGURATION - IPV6</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-31
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set default gateway (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetNetworkDefaultGateway
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure default gateway IPv6 address setting on a DUT using SetNetworkDefaultGateway command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. IPv6 is implemented by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will follow the procedure described in <link linkend="Annex_HelperTurnOffIPv6DHCP">Annex A.15</link> to turn off IPv6 DHCP and set manual IP configuration.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request to retrieve the original settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> (original settings).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request (IPv6Address = "2001:1:1:1:1:1:1:1").
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetNetworkDefaultGatewayResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the configured default gateways settings in DUT through <emphasis role="bold">GetNetworkDefaultGateway</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends its configured default gateways settings in the <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message (IPv6Address = "2001:1:1:1:1:1:1:1").
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetNetworkDefaultGateway</emphasis> request to restore the original network default gateway settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will follow the procedure described in <link linkend="Annex_HelperRestoreNetworkSettings">Annex A.8</link> to turn on IPv6 DHCP to restore IP configuration.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct default gateway information (i.e. IPv6Address = "2001:1:1:1:1:1:1:1") in <emphasis role="bold">GetNetworkDefaultGatewayResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-32-->
      <section xml:id="tc.DEVICE-2-1-32">
        <title>NETWORK COMMAND SETHOSTNAME TEST</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-32
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set hostname (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetHostname
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure hostname on the DUT using SetHostname command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Testing environment (DHCP server) should not change the IP address of DUT during this test case execution.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetHostname</emphasis> request to retrieve original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetHostname</emphasis> request (Name = "Onvif-Test0-oNvif-Onv12", whose length is equal to 23 bytes) to configure the hostname.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetHostnameResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the hostname configurations in DUT through <emphasis role="bold">GetHostname</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends hostname configuration in the <emphasis role="bold">GetHostnameResponse</emphasis> message (FromDHCP = false, Name = "Onvif-Test0-oNvif-Onv12").
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetHostname</emphasis> request to restore original settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetHostnameResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetHostnameResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send a correct hostname (i.e. "Onvif-Test0-oNvif-Onv123-Onvif12") in the <emphasis role="bold">GetHostnameResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidHostname">Annex A.2</link> for valid host names.
        </para>
      </section>
      <!--DEVICE-2-1-36-->
      <section xml:id="tc.DEVICE-2-1-36">
        <title>GET DYNAMIC DNS CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-36
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get dynamic DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetDynamicDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve dynamic DNS settings of DUT through GetDynamicDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Device supports DynamicDNS feature.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetDynamicDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DynamicDNSInformation
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send a <emphasis role="bold">GetDynamicDNSResponse</emphasis>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-2-1-37-->
      <section xml:id="tc.DEVICE-2-1-37">
        <title>SET DYNAMIC DNS CONFIGURATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-2-1-37
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set dynamic DNS settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetDynamicDNS
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure dynamic DNS settings of DUT through SetDynamicDNS command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. Device supports DynamicDNS feature.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetDynamicDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DynamicDNSInformation =: <emphasis role="italic">initialDynamicDNSSettings</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetDynamicDNS</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Type  := NoUpdate
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Name skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TTL := PT20S if <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field, otherwise skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">SetDynamicDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetDynamicDNS</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DynamicDNSInformation =: <emphasis role="italic">updatedDynamicDNSSettings</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.Type value is not equal to "NoUpdate", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.TTL value is not equal to PT20S, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>

            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetDynamicDNS</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Type  := ServerUpdates
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Name skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TTL := PT25S if <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field, otherwise skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-37.SetServerUpdatesResponse">
              <para>
                The DUT responds with a <emphasis role="bold">SetDynamicDNSResponse</emphasis> message or with SOAP 1.2 fault message.
              </para>
            </listitem>

            <listitem>
              <para>
                If <emphasis role="bold">SetDynamicDNSResponse</emphasis> was returned
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDynamicDNS</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            DynamicDNSInformation =: <emphasis role="italic">updatedDynamicDNSSettings</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.Type value is not equal to "ServerUpdates", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.TTL value is not equal to PT25S, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>


            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetDynamicDNS</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Type := ClientUpdates
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Name := "Onvif-Test0-oNvif-Onv12"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TTL := PT30S if <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field, otherwise skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-2-1-37.SetClientUpdatesResponse">
              <para>
                The DUT responds with a <emphasis role="bold">SetDynamicDNSResponse</emphasis> message or with SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="bold">SetDynamicDNSResponse</emphasis> was returned
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDynamicDNS</emphasis> request.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            DynamicDNSInformation =: <emphasis role="italic">updatedDynamicDNSSettings</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.Type value is not equal to "ClientUpdates", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.Name value is not equal to "Onvif-Test0-oNvif-Onv12", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">initialDynamicDNSSettings</emphasis> contains TTL field:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">updatedDynamicDNSSettings</emphasis>.TTL value is not equal to PT30S, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returned SOAP 1.2 fault message on both step <xref linkend="tc.DEVICE-2-1-37.SetServerUpdatesResponse"/> and step <xref linkend="tc.DEVICE-2-1-37.SetClientUpdatesResponse"/>, FAIL the test and restore the DUT settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetDynamicDNS</emphasis> to restore dynamic DNS settings with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Type := <emphasis role="italic">initialDynamicDNSSettings</emphasis>.Type
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Name := <emphasis role="italic">initialDynamicDNSSettings</emphasis>.Name
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TTL := <emphasis role="italic">initialDynamicDNSSettings</emphasis>.TTL
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">SetDynamicDNSResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send a <emphasis role="bold">GetDynamicDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send a <emphasis role="bold">SetDynamicDNSResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
    </section>
    <!--System-->
    <section xml:id="tc.device_management.system">
      <title>System</title>
      <!--DEVICE-3-1-1-->
      <section xml:id="tc.DEVICE-3-1-1">
        <title>SYSTEM COMMAND GETSYSTEMDATEANDTIME</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get system date and time (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve DUT system date and time using GetSystemDateAndTime command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetSystemDateAndTime</emphasis> request to get DUT system date and time.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify system date and time configurations of DUT in <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message (DateTimeType = Manual or NTP, DayLightSavings = true or false, TimeZone = POSIX 1003.1, UTC DateTime = Hour:Min:Sec, Year:Month:Day and LocalDateTime = Hour:Min:Sec, Year:Month:Day).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send DateTimeType and DayLightSavings information in the <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> If system date and time are set manually, then DUT shall return UTCDateTime or LocalDateTime in the GetSystemDateAndTimeResponse message.
        </para>
      </section>
      <!--DEVICE-3-1-4-->
      <section xml:id="tc.DEVICE-3-1-4">
        <title>SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID TIMEZONE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set system date and time (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of the DUT for invalid TimeZone configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">initialSystemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--SetSystemDateAndTime-->
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := Manual
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone.TZ := "INVALIDTIMEZONE"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Time.Hour := current UTC hour
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Time.Minute := current UTC minute
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Time.Second := current UTC second
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Date.Year := current UTC year
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Date.Month := current UTC month
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime.Date.Day := current UTC day
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--SetSystemDateAndTimeResponse-->
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidTimeZone</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">systemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--Check-->
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.TimeZone.TZ is specified and equal to "INVALIDTIMEZONE", FAIL the test and go to step <link linkend="tc.DEVICE-3-1-4.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.UTCDateTime is skipped, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-4.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.UTCDateTime has invalid value for date or time, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-4.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.LocalDateTime is specified and has invalid value for date or time, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-4.13">13</link>.
              </para>
            </listitem>
            <!--SetSystemDateAndTime-->
            <listitem xml:id="tc.DEVICE-3-1-4.13">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DateTimeType
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DaylightSavings
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone := <emphasis role="italic">initialSystemDateAndTime</emphasis>.TimeZone
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">initialSystemDateAndTime</emphasis>.DateTimeType = Manual:
                      <itemizedlist>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Hour := current UTC hour
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Minute := current UTC minute
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Second := current UTC second
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Year := current UTC year
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Month := current UTC month
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Day := current UTC day
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                    <para>
                      otherwise, UTCDateTime is skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                DUT responds with <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send the <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidTimeZone</emphasis> SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidTimeZone">Annex A.3</link> for Invalid TimeZone.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for invalid SOAP 1.2 fault message definitions.
        </para>
      </section>
      <!--DEVICE-3-1-5-->
      <section xml:id="tc.DEVICE-3-1-5">
        <title>SYSTEM COMMAND SETSYSTEMDATEANDTIME TEST FOR INVALID DATE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set system date and time (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of the DUT for invalid system date and time configuration.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">initialSystemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--SetSystemDateAndTime-->
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := Manual
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := true
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone.TZ := "PST8PDT,M3.2.0,M11.1.0"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime := invalid date and time
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--SetSystemDateAndTimeResponse-->
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidDateTime</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">systemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <!--Check-->
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.TimeZone.TZ is specified and <emphasis role="italic">systemDateAndTime</emphasis>.TimeZone.TZ has invalid value, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-5.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.UTCDateTime is skipped, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-5.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.UTCDateTime has invalid value for date or time, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-5.13">13</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemDateAndTime</emphasis>.LocalDateTime is specified and has invalid value for date or time, FAIL the test and go to step <link linkend="tc.DEVICE-3-1-5.13">13</link>.
              </para>
            </listitem>
            <!--SetSystemDateAndTime-->
            <listitem xml:id="tc.DEVICE-3-1-5.13">
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DateTimeType
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DaylightSavings
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone := <emphasis role="italic">initialSystemDateAndTime</emphasis>.TimeZone
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">initialSystemDateAndTime</emphasis>.DateTimeType = Manual:
                      <itemizedlist>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Hour := current UTC hour
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Minute := current UTC minute
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Time.Second := current UTC second
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Year := current UTC year
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Month := current UTC month
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            UTCDateTime.Date.Day := current UTC day
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                    <para>
                      otherwise, UTCDateTime is skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                DUT responds with <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send the <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:InvalidDateTime</emphasis> SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_InvalidFault">Annex A.4</link> for invalid SOAP 1.2 fault message definitions.
        </para>
      </section>

      <!--DEVICE-3-1-6-->
      <section xml:id="tc.DEVICE-3-1-6">
        <title>SYSTEM COMMAND FACTORY DEFAULT HARD</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Factory default (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetSystemFactoryDefault
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To reload all parameters of the DUT to their default values using SetSystemFactoryDefault command. This test is for hard factory default.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetSystemFactoryDefault</emphasis> request (FactoryDefaultType = Hard).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">SetSystemFactoryDefaultResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends Multicast <emphasis role="bold">Hello</emphasis> message after hard reset.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetSystemFactoryDefaultResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">Hello</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> After Hard Reset certain DUTs are not IP-reachable. In such situation DUT shall be configured with an IPv4 address, shall be IP reachable in the test network and other relevant configurations to be done for further tests.
        </para>
      </section>
      <!--DEVICE-3-1-7-->
      <section xml:id="tc.DEVICE-3-1-7">
        <title>SYSTEM COMMAND FACTORY DEFAULT SOFT</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-7
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Factory default (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To reload all parameters of the DUT to their default values using SetSystemFactoryDefault command. This test is for soft factory default.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetSystemFactoryDefault</emphasis> request (FactoryDefaultType = Soft).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetSystemFactoryDefaultResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will verify that DUT is accessible after soft reset. ONVIF Client will send Multicast <emphasis role="bold">Probe</emphasis> request several times (i.e. 50 times at an interval of 5 seconds).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends a <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetSystemFactoryDefaultResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message (i.e. DUT cannot be discovered).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> After a soft reset some DUTs require some configurations to be done for further tests.
        </para>
      </section>
      <!--DEVICE-3-1-8-->
      <section xml:id="tc.DEVICE-3-1-8">
        <title>SYSTEM COMMAND REBOOT</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-8
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Reboot
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SystemReboot
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To reboot the DUT through SystemReboot command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SystemReboot</emphasis> request to reset the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SystemRebootResponse</emphasis> message (example message string = "Rebooting in x seconds").
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT supports Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.5em"?>
                  <listitem>
                    <para>
                      The DUT will send Multicast <emphasis role="bold">Hello</emphasis> message after it is successfully rebooted.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will wait for <emphasis role="bold">Hello</emphasis> message sent from newly configured address by the DUT. Then ONVIF Client will verify the <emphasis role="bold">Hello</emphasis> message and start using this newly configured address for further communications with DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will send Unicast <emphasis role="bold">Probe</emphasis> message to discover the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT will send a <emphasis role="bold">ProbeMatch</emphasis> message.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will verify the <emphasis role="bold">ProbeMatch</emphasis> message sent by the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If DUT does not support Discovery:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="3.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client uses initial IP address of the DUT for further test cases.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">Hello</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> If Bye message is supported by the DUT, then the DUT shall send multicast Bye message before the reboot.
        </para>
      </section>
      <!--DEVICE-3-1-9-->
      <section xml:id="tc.DEVICE-3-1-9">
        <title>SYSTEM COMMAND DEVICE INFORMATION</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-9
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Device Information
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetDeviceInformation
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve device information of the DUT using GetDeviceInformation command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetDeviceInformation</emphasis> request to retrieve device information such as manufacture, model and firmware version etc.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetDeviceInformationResponse</emphasis> from the DUT (Manufacture, Model, Firmware version, Serial Number and Hardware Id).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDeviceInformationResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send one or more mandatory information items in the <emphasis role="bold">GetDeviceInformationResponse</emphasis> message (mandatory information - Manufacturer, Model, Firmware Version, Serial Number and Hardware Id).
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-3-1-10-->
      <section xml:id="tc.DEVICE-3-1-10">
        <title>SYSTEM COMMAND GETSYSTEMLOG</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-10
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get system logs
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetSystemLog
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve the DUT system and access logs using GetSystemLog command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemLog</emphasis> request (System) to retrieve system log from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetSystemLogResponse</emphasis> message from the DUT or <emphasis role="bold">env:Sender/ter:InvalidArgs/ter:SystemlogUnavailable</emphasis> SOAP 1.2 fault, if system log is unavailable.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemLog</emphasis> request (Access) to retrieve system log from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetSystemLogResponse</emphasis> message from the DUT or <emphasis role="bold">env:Sender/ter:InvalidArgs/ter:AccesslogUnavailable</emphasis> SOAP 1.2 fault, if system log is unavailable.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemLogResponse</emphasis> message or SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">GetSystemLogResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent incorrect SOAP 1.2 fault message (fault code, namespace, etc.).
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-3-1-11-->
      <section xml:id="tc.DEVICE-3-1-11">
        <title>SYSTEM COMMAND SETSYSTEMDATEANDTIME</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set system date and time
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To set the DUT system date and time using SetSystemDateAndTime command, date and time are entered manually.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request to retrieve original system date and type settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetSystemDateAndTime</emphasis> request (DateTimeType = Manual, DayLightSavings = false, UTCDateTime = Hour:Min:Sec, Year:Month:Day) to configure the date and time in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DUT date and time configurations through <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT sends system date and time configurations in the <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message (DateTimeType = Manual, DayLightSavings = true, TimeZone = POSIX 1003.1, UTCDateTime = Hour:Min:Sec, Year:Month:Day).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request (original DateTimeType Settings, original DayLightSavings, original TimeZone, current UTCDateTime for synchronize time if DateTimeType = Manual) to restore original system date and type settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send expected system date and time configuration (DateTimeType = "Manual", DayLightSavings = true, TimeZone = POSIX 1003.1, UTCDateTime = Hour:Min:Sec, Year:Month:Day) in the <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-3-1-12-->
      <section xml:id="tc.DEVICE-3-1-12">
        <title>SYSTEM COMMAND SETSYSTEMDATEANDTIME USING NTP</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-12
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set system date and time
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetSystemDateAndTime
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To set the DUT system date and time using SetSystemDateAndTime command via NTP.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Profile S scope or Profile G scope or Profile C scope or Profile A scope or Profile T scope or Profile D scope. NTP is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client, DUT and NTP
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNTP</emphasis> request to retrieve original NTP settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis> request to retrieve original system date and type settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNTP</emphasis> request (FromDHCP=false, NTPManual = IPv4, valid NTP server address) to configure DUT with proper NTP server.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetSystemDateAndTime</emphasis> request (DateTimeType = NTP, DayLightSavings = true or false, TimeZone = POSIX 1003.1) to configure the time in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT shall obtain and configure time via NTP.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the DUT date and time configurations through <emphasis role="bold">GetSystemDateAndTime</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends system date and time configurations in the <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message (DateTimeType = NTP, DayLightSavings = true or false, TimeZone = POSIX 1003.1, UTCDateTime = Hour:Min:Sec, Year:Month:Day).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request (original DateTimeType Settings, original DayLightSavings, original TimeZone, current UTCDateTime for synchronize time if DateTimeType=Manual) to restore original system date and type settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetNTP</emphasis> request (original NTP Settings) to restore NTP settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send expected system date and time configuration (DateTimeType = NTP, DayLightSavings = true or false, TimeZone = POSIX 1003.1, UTCDateTime = Hour:Min:Sec, Year:Month:Day) in the <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-3-1-13-->
      <section xml:id="tc.DEVICE-3-1-13">
        <title>GET SYSTEM URIS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-13
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get System URIs (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetSystemUris
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Get System Uris.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> System backup and restore using HTTP GET and POST is supported by the DUT as indicated by the System.HttpSystemBackup capability or retrieval of system log using HTTP GET is supported by the DUT as indicated by the System.HttpSystemLogging capability or retrieval of support information using HTTP GET is supported by the DUT as indicated by the System.HttpSupportInformation capability.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT supports GetServices command:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client gets the service capabilities by following the procedure mentioned in <link linkend="Annex_HelperGetServiceCapabilities">Annex A.18</link> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            out <emphasis role="italic">cap1</emphasis> - Device Management Service Capabilities
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Go to the step <link linkend="tc.DEVICE-3-1-13.5">5</link>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT does not support GetServices command:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client gets the device service capabilities by following the procedure mentioned in <link linkend="Annex_HelperGetDeviceCapabilities">Annex A.19</link> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            out <emphasis role="italic">cap2</emphasis> - Device Management Capabilities
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-3-1-13.5">
              <para>
                ONVIF client invokes <emphasis role="bold">GetSystemUris</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemUrisResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemLogUris list =: <emphasis role="italic">systemLogUrisList</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SupportInfoUri =: <emphasis role="italic">supportInfoUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SystemBackupUri =: <emphasis role="italic">systemBackupUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Extension
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If ((DUT supports GetServices command) and (<emphasis role="italic">cap1</emphasis>.System.HttpSystemLogging = true)) or ((DUT does not support GetServices command) and (<emphasis role="italic">cap2</emphasis>.System.Extension.HttpSystemLogging = true)):
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">systemLogUrisList</emphasis> is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      For each SystemLog.Uri <emphasis role="italic">uri</emphasis> from <emphasis role="italic">systemLogUrisList</emphasis> repeat the following steps:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            ONVIF client invokes <emphasis role="bold">HTTP GET</emphasis> to <emphasis role="italic">uri</emphasis>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> response:
                            <itemizedlist>
                              <listitem>
                                <para>
                                  HTTP Body =: <emphasis role="italic">systemLog</emphasis>
                                </para>
                              </listitem>
                            </itemizedlist>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">systemLog</emphasis> is empty, FAIL the test and skip other steps.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If ((DUT supports GetServices command) and (<emphasis role="italic">cap1</emphasis>.System.HttpSupportInformation = true)) or ((DUT does not support GetServices command) and (<emphasis role="italic">cap2</emphasis>.System.Extension.HttpSupportInformation = true)):
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">supportInfoUri</emphasis> is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF client invokes <emphasis role="bold">HTTP GET</emphasis> to <emphasis role="italic">supportInfoUri</emphasis>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> response:
                      <itemizedlist>
                        <listitem>
                          <para>
                            HTTP Body =: <emphasis role="italic">supportInf</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">supportInf</emphasis> is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If ((DUT supports GetServices command) and (<emphasis role="italic">cap1</emphasis>.System.HttpSystemBackup = true)) or ((DUT does not support GetServices command) and (<emphasis role="italic">cap2</emphasis>.System.Extension.HttpSystemBackup = true)):
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">systemBackupUri</emphasis> is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF client invokes <emphasis role="bold">HTTP GET</emphasis> to <emphasis role="italic">systemBackupUri</emphasis>.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> response:
                      <itemizedlist>
                        <listitem>
                          <para>
                            HTTP Body =: <emphasis role="italic">systemBackup</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">systemBackup</emphasis> is empty, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemUrisResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">HTTP 200 OK</emphasis> response.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> Note: HTTP GET requests could require authentication.
        </para>
      </section>
      <!--DEVICE-3-1-14-->
      <section xml:id="tc.DEVICE-3-1-14">
        <title>START SYSTEM RESTORE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-14
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Start system restore (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> StartSystemRestore
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Start System Restore.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> System backup and restore using HTTP GET and POST is supported by the DUT as indicated by the System.HttpSystemBackup capability. Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">GetSystemUris</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetSystemUrisResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemLogUris list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SupportInfoUri
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      SystemBackupUri =: <emphasis role="italic">systemBackupUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Extension
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemBackupUri</emphasis> is empty, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">HTTP GET</emphasis> to <emphasis role="italic">systemBackupUri</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      HTTP Body =: <emphasis role="italic">systemBackup</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">systemBackup</emphasis> is empty, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">StartSystemRestore</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">StartSystemRestoreResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      UploadUri =: <emphasis role="italic">uploadUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ExpectedDownTime =: <emphasis role="italic">expectedDownTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">HTTP POST</emphasis> to <emphasis role="italic">uploadUri</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      HTTP Header [Content-Type] := "application/octet-stream"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HTTP Body := <emphasis role="italic">systemBackup</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client waits <emphasis role="italic">expectedDownTime</emphasis> + <emphasis role="italic">timeout1</emphasis> for <emphasis role="bold">Hello</emphasis> message sent from newly configured address by the DUT. Then ONVIF Client starts using this newly configured address for further communications with DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes Unicast <emphasis role="bold">Probe</emphasis> message with the following parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Types empty
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Scopes empty
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">ProbeMatch</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemUrisResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">StartSystemRestoreResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">HTTP 200 OK</emphasis> response.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">ProbeMatch</emphasis> response.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> HTTP GET and HTTP POST requests could require authentication.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-3-1-15-->
      <section xml:id="tc.DEVICE-3-1-15">
        <title>START SYSTEM RESTORE – INVALID BACKUP FILE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-15
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Start system restore (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> StartSystemRestore
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Start System Restore in the case if backup file is invalid.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> System backup and restore using HTTP GET and POST is supported by the DUT as indicated by the System.HttpSystemBackup capability. Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Set systemBackup := [random data]
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">StartSystemRestore</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">StartSystemRestoreResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      UploadUri =: <emphasis role="italic">uploadUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ExpectedDownTime =: <emphasis role="italic">expectedDownTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">HTTP POST</emphasis> to <emphasis role="italic">uploadUri</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      HTTP Header [Content-Type] := "application/octet-stream"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      HTTP Body := <emphasis role="italic">systemBackup</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 415 Unsupported Media Type</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client waits Reboot timeout.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client sends <emphasis role="bold">Probe</emphasis> message and if DUT does not respond with <emphasis role="bold">ProbeMatch</emphasis> mesage then go to the step <link linkend="tc.DEVICE-3-1-15.10">10</link>, if DUT responds then finish the test.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-3-1-15.10">
              <para>
                ONVIF Client waits for <emphasis role="bold">Hello</emphasis> message sent from newly configured address by the DUT. Then ONVIF Client starts using this newly configured address for further communications with DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">StartSystemRestoreResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">HTTP 415 Unsupported Media Type</emphasis> response.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> HTTP POST request could require authentication.
        </para>
      </section>
      <!--DEVICE-3-1-16-->
      <section xml:id="tc.DEVICE-3-1-16">
        <title>Firmware Upload</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-16
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Firmware Upload via HTTP
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> StartFirmwareUgrade
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the firmware upgrade is correctly executed.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices command is supported by the DUT. HttpFirmwareUpgrade feature is supported by the DUT as indicated by the System.HttpFirmwareUpgrade. Location of Compatible firmware file is provided.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Sequence:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>ONVIF Client invokes GetUsers without any authentication.</para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 401 Unauthorized</emphasis> error.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetUsers</emphasis> with user with the user level Administrator credantials.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetUsersResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>UserList</para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">StartFirmwareUpgrade</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">StartFirmwareUpgradeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      UploadUri =: <emphasis role="italic">uploadUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UploadDelay =: <emphasis role="italic">uploadDuration</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ExpectedDownTime =: <emphasis role="italic">downTimeDuration</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client waits for time <emphasis role="italic">uploadDuration</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">HTTP POST</emphasis> to <emphasis role="italic">uploadUri</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>HTTP Header [Content-Type] := "application/octet-stream"</para>
                  </listitem>
                  <listitem>
                    <para>HTTP Body := compatible firmware file</para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 200 OK</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                If BYE message is supported by the DUT as indicated by the System.DiscoveryBye capabilities, the DUT will send Multicast
                <emphasis role="bold">BYE</emphasis> message before rebooting with parameters
                <itemizedlist>
                  <listitem>
                    <para>EndpointReference.Address equal to unique endpoint reference of the DUT</para>
                  </listitem>
                  <listitem>
                    <para>Types list</para>
                  </listitem>
                  <listitem>
                    <para>Scopes list</para>
                  </listitem>
                  <listitem>
                    <para>XAddrs list</para>
                  </listitem>
                  <listitem>
                    <para>MetadataVersion</para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps
              </para>
              <para>
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      The DUT will send Multicast <emphasis role="bold">Hello</emphasis> message after it is successfully rebooted with parameters:
                      <itemizedlist>
                        <listitem>
                          <para>EndpointReference.Address equal to unique endpoint reference of the DUT</para>
                        </listitem>
                        <listitem>
                          <para>Types list</para>
                        </listitem>
                        <listitem>
                          <para>Scopes list</para>
                        </listitem>
                        <listitem>
                          <para>XAddrs list := xaddrsList</para>
                        </listitem>
                        <listitem>
                          <para>MetadataVersion</para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">xaddrsList</emphasis> contains URI address with not a LinkLocal IPv4 address from ONVIF Client subnet, go to step 15.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">timeout1</emphasis> timeout expires for step 5 without Hello with URI address with not a LinkLocal IPv4 address from ONVIF Client subnet, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>ONVIF client waits for 5 seconds after Hello was received.</para>
            </listitem>
            <listitem>
              <para>ONVIF Client invokes GetUsers without any authentication.</para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 401 Unauthorized</emphasis> error.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetUsers</emphasis> with user with the user level Administrator credantials.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetUsersResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>UserList </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT passed all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT allowed Anonymous access to the <emphasis role="bold">GetUsers</emphasis> command.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">StartFirmwareUpgradeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not response with <emphasis role="bold">HTTP 200 OK</emphasis> to HTTP POST request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">Bye</emphasis> message with EndpointReference.Address equal to unique endpoint reference of the DUT in case Bye message was supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> Reboot Timeout will be used for waiting for the Bye message from the DUT. Reboot Timeout will be taken from the Reboot Timeout field of ONVIF Device Test Tool.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be selected as maximum of (<emphasis role="italic">downTimeDuration</emphasis>, Reboot Timeout), where Reboot Timeout will be taken from the Reboot Timeout field of ONVIF Device Test Tool.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4 address from Hello shall be used for further test cases.
        </para>
      </section>
      <!--DEVICE-3-1-17-->
      <section xml:id="tc.DEVICE-3-1-17">
        <title>Invalid Firmware Upload</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-3-1-17
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Firmware Upload via HTTP
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> StartFirmwareUgrade
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the firmware upgrade fails with the expected error code.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices command is supported by the DUT. HttpFirmwareUpgradefeature is supported by the DUT as indicated by the System.HttpFirmwareUpgrade. Discovery is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Sequence:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">StartFirmwareUpgrade</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">StartFirmwareUpgradeResponse</emphasis> message with parameters<itemizedlist>
                  <listitem>
                    <para>
                      UploadUri =: <emphasis role="italic">uploadUri</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>UploadDelay =: duration</para>
                  </listitem>
                  <listitem>
                    <para>ExpectedDownTime</para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client waits for time <emphasis role="italic">duration</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">HTTP POST</emphasis> to <emphasis role="italic">uploadUri</emphasis> with parameters
              </para>
              <itemizedlist>
                <listitem>
                  <para>HTTP Header [Content-Type] := "application/octet-stream"</para>
                </listitem>
                <listitem>
                  <para>HTTP Body := invalid firmware file</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">HTTP 415</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>ONVIF client waits Reboot timeout.</para>
            </listitem>
            <listitem>
              <para>ONVIF Client sends <emphasis role="bold">Probe</emphasis> message and if DUT does not respond with <emphasis role="bold">ProbeMatch</emphasis> mesage then go to the step 10. If DUT responds, then finish the test.</para>
            </listitem>
            <listitem>
              <para>ONVIF Client waits for Hello message sent from newly configured address by the DUT. Then ONVIF Client starts using this newly configured address for further communications with DUT.</para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT passed all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
        </para>
        <para>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">StartFirmwareUpgradeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not response with <emphasis role="bold">HTTP 415</emphasis> to HTTP POST request.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>

      </section>
    <!--Security-->
    <section xml:id="tc.device_management.security">
      <title>Security</title>
      <!--DEVICE-4-1-1-->
      <section xml:id="tc.DEVICE-4-1-1">
        <title>SECURITY COMMAND GETUSERS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of GetUsers command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> The ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (Username, UserLevel).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> DUT may respond with none or more than one users.
        </para>
      </section>
      <!--DEVICE-4-1-3-->
      <section xml:id="tc.DEVICE-4-1-3">
        <title>SECURITY COMMAND CREATEUSERS ERROR CASE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Create Users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> CreateUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of CreateUsers command, if a user being created already exists.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator)
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = User) to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:OperationProhibited/ter:UsernameClash</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest4" Password = "OnvifTest123" UserLevel = Operator, Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = User) to create the users in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:OperationProhibited/ter:UsernameClash</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator)
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1") to delete the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct SOAP 1.2 fault message (<emphasis role="bold">env:Sender/ter:OperationProhibited/ter:UsernameClash</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT creates the user "OnvifTest1" with Level = User.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT creates the user "OnvifTest4".
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command. Such SOAP 1.2 fault message shall be treated as PASS case for this test.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return a greater number of users than actually created in this test case i.e. default users if any might be returned.
        </para>
      </section>
      <!--DEVICE-4-1-4-->
      <section xml:id="tc.DEVICE-4-1-4">
        <title>SECURITY COMMAND DELETEUSERS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Delete users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> DeleteUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of DeleteUsers command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator, Username = "OnvifTest2" Password = "OnvifTest123" UserLevel = Operator, Username = "OnvifTest3" Password = "OnvifTest123" UserLevel = User) to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator, Username = "OnvifTest2" UserLevel = Operator, Username = "OnvifTest3" UserLevel = User).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1"), to delete the user.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends the updated user list (Username = "OnvifTest2" UserLevel = Operator, Username = "OnvifTest3" UserLevel = User).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest2", Username = "OnvifTest3") to delete the users.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends the <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (Returns the default users, if any).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not create the users.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not delete the users.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command. Such SOAP 1.2 fault message shall be treated as PASS case for this test.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return a greater number of users than actually created in this test case i.e. default users if any might be returned.
        </para>
      </section>
      <!--DEVICE-4-1-5-->
      <section xml:id="tc.DEVICE-4-1-5">
        <title>SECURITY COMMAND DELETEUSERS ERROR CASE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Delete users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> DeleteUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of the DeleteUsers command, if a non-existing user is deleted.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-4-1-5.5">
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1", Username = "OnvifTest2"), to delete user.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:UsernameMissing</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1"), to delete the user.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Returns default users, if any).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct SOAP 1.2 fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:UsernameMissing</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT deletes the user "OnvifTest1" at step <link linkend="tc.DEVICE-4-1-5.5">5</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command. Such SOAP 1.2 fault message shall be treated as PASS case for this test.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return a greater number of users than actually created in this test case i.e. default users if any might be returned.
        </para>
      </section>
      <!--DEVICE-4-1-6-->
      <section xml:id="tc.DEVICE-4-1-6">
        <title>SECURITY COMMAND DELETEUSERS DELETE ALL USERS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Delete users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> DeleteUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of the DeleteUsers command, when all the users are deleted.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> The ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Returns default users, if any).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = Default Users), to delete the default users if there are any.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message or <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:FixedUser</emphasis> SOAP 1.2 fault message. Depending upon the implementation DUT may respond with SOAP 1.2 fault message or send empty response.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send correct SOAP 1.2 fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:FixedUser</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return the default users, if any.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> It is not possible to recover the default user if it was deleted during the test case execution.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The original user, used to access the DUT, shall be restored in case all users were deleted.
        </para>
      </section>
      <!--DEVICE-4-1-7-->
      <section xml:id="tc.DEVICE-4-1-7">
        <title>SECURITY COMMAND SETUSER</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-7
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetUser
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetUser command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator, Username = "OnvifTest2" Password = "OnvifTest123" UserLevel = Operator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator, Username = "OnvifTest2" UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetUser</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest321" UserLevel = "Operator"), to update the user settings in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username= "OnvifTest1" UserLevel = Operator, Username = "OnvifTest2" UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetUser</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator, Username = "OnvifTest2" Password = "OnvifTest321" UserLevel = Operator), to update user settings in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = OnvifTest1 UserLevel = Operator, Username = OnvifTest2 UserLevel = User).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1", Username = "OnvifTest2") to delete the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not update the settings of the user(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command. In this case test shall be executed with the default users if any.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return more number of users than actually created in this test case, i.e. default users if any might be returned.
        </para>
      </section>
      <!--DEVICE-4-1-8-->
      <section xml:id="tc.DEVICE-4-1-8">
        <title>SECURITY COMMAND USER MANAGEMENT ERROR CASE</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-8
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetUser
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of the SetUser command when updating the settings of non-existing user.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> The ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request to retrieve the user list from the DUT
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetUser</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = User, Username = "OnvifTest5" Password = "OnvifTest123" UserLevel = User) to update the user settings in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:UsernameMissing</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1"), to delete the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request to retrieve the user list form the DUT
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (returns default users, if any).
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct SOAP 1.2 fault message (<emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:UsernameMissing</emphasis>).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT updates the settings of the user "OnvifTest1".
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command. In this case, test shall be executed with the default users if any.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return a greater number of users than actually created in this test case, i.e. default users if any might be returned.
        </para>
      </section>
      <!--DEVICE-4-1-9-->
      <section xml:id="tc.DEVICE-4-1-9">
        <title>SECURITY COMMAND CREATEUSERS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-9
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Create users (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> CreateUsers
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of CreateUsers command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> The ONVIF Client may need to operate in administrator mode to execute this test case. User Configuration feature is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the initial user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Operator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-4-1-9.6">
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1", UserLevel = Operator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest2" Password = "OnvifTest123" UserLevel = User) to create the user in the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-4-1-9.10">
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request, to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends the <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1" UserLevel = Operator, Username = "OnvifTest2" UserLevel = User).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1", Username = "OnvifTest2") to delete the users in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-4-1-9.16">
              <para>
                ONVIF Client will invoke <emphasis role="bold">CreateUsers</emphasis> request (Username = "OnvifTest1" Password = "OnvifTest123" UserLevel = Administrator), to create the user in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetUsers</emphasis> request to retrieve the user list from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">GetUsersResponse</emphasis> message (Username = "OnvifTest1", UserLevel = Administrator).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">DeleteUsers</emphasis> request (Username = "OnvifTest1") to delete the users in the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT creates a user either at step <link linkend="tc.DEVICE-4-1-9.6">6</link> or at step <link linkend="tc.DEVICE-4-1-9.10">10</link> or at step <link linkend="tc.DEVICE-4-1-9.16">16</link> successfully or the DUT creates users at step <link linkend="tc.DEVICE-4-1-9.6">6</link>, step <link linkend="tc.DEVICE-4-1-9.10">10</link> and step <link linkend="tc.DEVICE-4-1-9.16">16</link> successfully.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreateUsersResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">DeleteUsersResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return SOAP Fault 1.2 "TooManyUsers" for the CreateUsers command if the capability MaxUsers is not present or equals the size of the users list. Such SOAP 1.2 fault message shall be treated as PASS case in this case. See <link linkend="Annex_HelperTooManyUsersFaultCheck">Annex A.17</link> TooManyUsers fault check for details.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> The DUT may return a greater number of users than actually created in this test case, i.e. default users if any might be returned.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> At some DUTs it might not be possible to create user with all levels. So if the DUT successfully creates a user either at step <link linkend="tc.DEVICE-4-1-9.6">6</link> or step <link linkend="tc.DEVICE-4-1-9.10">10</link> or step <link linkend="tc.DEVICE-4-1-9.16">16</link> successfully, then this test case shall be treated as PASS case.
        </para>
      </section>
      <!--DEVICE-4-1-10-->
      <section xml:id="tc.DEVICE-4-1-10">
        <title>GET REMOTE USER</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-10
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get remote user (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetRemoteUser
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Get Remote User.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Remote user handlin is supported by the DUT as indicated by the Security.RemoteUserHandling capability.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">GetRemoteUser</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetRemoteUserResponse</emphasis> message with parameters.
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser =: <emphasis role="italic">remoteUser</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">remoteUser</emphasis> is not empty and <emphasis role="italic">remoteUser</emphasis>.Password is not skkiped, FAIL the test.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-4-1-11-->
      <section xml:id="tc.DEVICE-4-1-11">
        <title>SET REMOTE USER</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-4-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set remote user (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRemoteUser
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify Set Remote User.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Remote user handling is supported by the DUT as indicated by the Security.RemoteUserHandling capability.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">SetRemoteUser</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser.Username := "ONVIFRemoteUser"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteUser.Password := "ONVIFRemotePassword"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteUser.UseDerivedPassword := true
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">GetRemoteUser</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetRemoteUserResponse</emphasis> message with parameters.
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser =: <emphasis role="inalic">remoteUser</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis> is empty, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.User is not equal to "ONVIFRemoteUser", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.UseDerivedPassword is not equal to true, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.Password is not skkiped, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">SetRemoteUser</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser.Username := "ONVIFRemoteUser"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteUser.Password := "ONVIFRemotePassword"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      RemoteUser.UseDerivedPassword := false
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">GetRemoteUser</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetRemoteUserResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser =: <emphasis role="inalic">remoteUser</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis> is empty, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.User is not equal to "ONVIFRemoteUser", FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.UseDerivedPassword is not equal to false, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="inalic">remoteUser</emphasis>.Password is not skkiped, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">SetRemoteUser</emphasis> request with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">SetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF client invokes <emphasis role="bold">GetRemoteUser</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetRemoteUserResponse</emphasis> message with parameters.
                <itemizedlist>
                  <listitem>
                    <para>
                      RemoteUser =: <emphasis role="inalic">remoteUser</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If remoteUser is not empty, FAIL the test.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRemoteUserResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
    </section>
    <!--I/O-->
    <section xml:id="tc.device_management.io">
      <title>I/O</title>
      <!--DEVICE-5-1-1-->
      <section xml:id="tc.DEVICE-5-1-1">
        <title>IO COMMAND GETRELAYOUTPUTS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get relay outputs (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetRelayOutputs
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve DUT relay outputs using GetRelayOutputs command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve relay outputs supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message from the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent at least two RelayOutputs with the same token.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent an empty list of RelayOutputs.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-2-->
      <section xml:id="tc.DEVICE-5-1-2">
        <title>RELAY OUTPUTS COUNT IN GETRELAYOUTPUTS AND GETCAPABILITIES</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get relay outputs, Capability exchange (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetRelayOutputs
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To check that the number of Relay outputs is the same in <emphasis role="bold">GetRelayOutputsResponse</emphasis> message and in <emphasis role="bold">GetCapabilitiesResponse</emphasis>.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> request (Device) to retrieve device capabilities.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetCapabilitiesResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve relay outputs supported by the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message from the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent Relay Outputs, its number in <emphasis role="bold">GetRelayOutputsResponse</emphasis> message differs from the one in Device.IO.RelayOutputs from <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-3-->
      <section xml:id="tc.DEVICE-5-1-3">
        <title>IO COMMAND SETRELAYOUTPUTSETTINGS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get relay outputs, Set relay output settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetRelayOutputs, SetRelayOutputSettings
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputSettings command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.6">
              <para>
                If the DUT supports Bistable Mode with Open Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Bistable, DelayTime = time1, IdleState = open) to set new relay output settings. If the DUT does not support Bistable Mode with Open Idle state, then go to the step <link linkend="tc.DEVICE-5-1-3.10">10</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.8">
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetRelayOutputsResponse</emphasis> message from the DUT. Check that values correspond the values from step <link linkend="tc.DEVICE-5-1-3.6">6</link> (except DelayTime value).
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.10">
              <para>
                If the DUT supports Bistable Mode with Closed Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Bistable, DelayTime = time1, IdleState = closed) to set new relay output settings. If the DUT does not support Bistable Mode with Closed Idle state, then go to the step <link linkend="tc.DEVICE-5-1-3.14">14</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputSettings</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetRelayOutputSettingsResponse</emphasis> message from the DUT. Check that values correspond the values from step <link linkend="tc.DEVICE-5-1-3.10">10</link> (except DelayTime value).
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.14">
              <para>
                If the DUT supports Monostable Mode with Closed Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time2, IdleState = open) to set new relay output settings. If the DUT does not support Monostable Mode with Closed Idle state, then go to the step <link linkend="tc.DEVICE-5-1-3.18">18</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputSettings</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetRelayOutputSettingsResponse</emphasis> message from the DUT. Check that values correspond the values from step <link linkend="tc.DEVICE-5-1-3.14">14</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.18">
              <para>
                If the DUT supports Monostable Mode with Open Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time2, IdleState = closed) to set new relay output settings. If the DUT does not support Monostable Mode with Open Idle state, then go to the step <link linkend="tc.DEVICE-5-1-3.22">22</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputSettings</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.21">
              <para>
                Verify <emphasis role="bold">GetRelayOutputSettingsResponse</emphasis> message from the DUT. Check that values correspond the values from step <link linkend="tc.DEVICE-5-1-3.18">18</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-3.22">
              <para>
                Repeat <link linkend="tc.DEVICE-5-1-3.6">6</link>-<link linkend="tc.DEVICE-5-1-3.21">21</link> for all relay outputs from the list.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct changed settings in <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not support at least one of the following: Bistable Mode with Open Idle state, Bistable Mode with Closed Idle state, Monostable Mode with Open Idle state, Monostable Mode with Closed Idle state
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-5-->
      <section xml:id="tc.DEVICE-5-1-5">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – BISTABLE MODE (OPENED IDLE STATE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputState command in case of bistable mode and opened idle state.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Bistable, DelayTime = time1, IdleState = open).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active)
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = inactive).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send a valid <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-6-->
      <section xml:id="tc.DEVICE-5-1-6">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – BISTABLE MODE (CLOSED IDLE STATE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputState command in case of bistable mode and closed idle state.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Bistable, DelayTime = time1, IdleState = closed).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = inactive).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-7-->
      <section xml:id="tc.DEVICE-5-1-7">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – MONOSTABLE MODE (OPENED IDLE STATE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-7
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputState command in case of monostable mode and opened idle state.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time1, IdleState = open).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
                Wait until time out time1 expires.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-8-->
      <section xml:id="tc.DEVICE-5-1-8">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – MONOSTABLE MODE (CLOSED IDLE STATE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-8
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputState command in case of monostable mode and closed idle state.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time1, IdleState = closed).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Wait until time out time1 expires.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-9-->
      <section xml:id="tc.DEVICE-5-1-9">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – MONOSTABLE MODE (INACTIVE BEFORE DELAYTIME EXPIRED)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-9
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve DUT system date and time using GetSystemDateAndTime command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs are supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve a list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">GetRelayOutputsResponse</emphasis> message with list of all available relay outputs and their settings.
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT supports Monostable Mode with Open Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time1, IdleState = open) to set new relay output settings. If the DUT does not support Monostable Mode with Open Idle state, then go to the step <link linkend="tc.DEVICE-5-1-9.12">12</link>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = inactive), when time1 is not expired yet.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Wait until timeout time1 expires.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-5-1-9.12">
              <para>
                If the DUT supports Monostable Mode with Closed Idle state, ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (RelayOutputToken, Mode = Monostable, DelayTime = time1, IdleState = closed) to set new relay output settings. If the DUT does not support Monostable Mode with Open Idle state, then skip other steps of the test.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sends the <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = active).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (RelayOutputToken, LogicalState = inactive), when time1 is not expired yet.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Wait until time out time1 will expire.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetRelayOutputsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send valid <emphasis role="bold">SetRelayOutputSettingsResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetRelayOutputStateResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not change relay state as expected.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
      <!--DEVICE-5-1-11-->
      <section xml:id="tc.DEVICE-5-1-11">
        <title>IO COMMAND SETRELAYOUTPUTSETTINGS – INVALID TOKEN</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set relay output settings (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputSettings
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputSettings command in case of invalid token.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client sends a <emphasis role="bold">GetRelayOutputs</emphasis> request to retrieve the available relay outputs.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns its relay outputs.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputSettings</emphasis> request (invalid RelayOutputToken).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:RelayToken</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent incorrect SOAP 1.2 fault message (fault code, namespace, etc.).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> Other faults than specified in the test are acceptable though the specified are preferable.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_name_max_len">Annex A.16</link> for Name and Token Parameters Length limitations.
        </para>
      </section>
      <!--DEVICE-5-1-12-->
      <section xml:id="tc.DEVICE-5-1-12">
        <title>IO COMMAND SETRELAYOUTPUTSTATE – INVALID TOKEN</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-5-1-12
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Trigger relay output (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetRelayOutputState
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify the behavior of SetRelayOutputState command in the case of invalid token.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Relay Outputs supported by DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">SetRelayOutputState</emphasis> request (invalid RelayOutputToken).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT returns <emphasis role="bold">env:Sender/ter:InvalidArgVal/ter:RelayToken</emphasis> SOAP 1.2 fault.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send SOAP 1.2 fault message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT sent incorrect SOAP 1.2 fault message (fault code, namespace, etc.).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> Other faults than specified in the test are acceptable though the specified are preferable.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_name_max_len">Annex A.16</link> for Name and Token Parameters Length limitations.
        </para>
      </section>
    </section>
    <!--Namespace Handling-->
    <section xml:id="tc.device_management.namespace_handling">
      <title>Namespace Handling</title>
      <!--DEVICE-6-1-1-->
      <section xml:id="tc.DEVICE-6-1-1">
        <title>DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR EACH TAG)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-6-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetDNS</emphasis> message (FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]) to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">SetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT and verify DNS configurations in the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> message to restore the original settings of the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is not supported by the DUT and Metadata feature under Media2 Service is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configurations list by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfigurationsList"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Each Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConfList</emphasis> - Metadata Configurations list
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client sets Metadata Configuration with default namespaces definition in each tag by following the procedure mentioned in <xref linkend="Annex_HelperSetMetadataConfiguration"/> with the following input parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0] - Metadata Configuration
                          </para>
                        </listitem>
                       <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Each Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configuration by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfiguration"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Each Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0].@token - Token of Metadata Configuration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConf</emphasis> - Metadata Configuration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
 <listitem>
                          <para>
                            If <emphasis role="italic">metadataConf</emphasis>.Name != "TestName1", restore DUT settings and FAIL the test.
                          </para>
                        </listitem>                
                </orderedlist>
              </para>
            </listitem>
          <listitem>
                          <para>
                            ONVIF Client restores DUT settings.
                          </para>
                        </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send the correct information in the <emphasis role="bold">GetDNSResponse</emphasis> message (i.e. FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have default namespaces definition in each tag (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DEVICE-6-1-2-->
      <section xml:id="tc.DEVICE-6-1-2">
        <title>DEVICE MANAGEMENT - NAMESPACES (DEFAULT NAMESPACES FOR PARENT TAG)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-6-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
                    <para>
                      Start an ONVIF Client.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Start the DUT.
                    </para>
                  </listitem>
            <listitem>
              <para>
                If Network Configuration is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>                  
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetDNS</emphasis> message (FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]) to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">SetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT and verify DNS configurations in the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> message to restore the original settings of the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is not supported by the DUT and Metadata feature under Media2 Service is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configurations list by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfigurationsList"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Parent Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConfList</emphasis> - Metadata Configurations list
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client sets Metadata Configuration with default namespaces definition in parent tag by following the procedure mentioned in <xref linkend="Annex_HelperSetMetadataConfiguration"/> with the following input parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0] - Metadata Configuration
                          </para>
                        </listitem>
                       <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Parent Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configuration by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfiguration"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Defaults Namespaces Definition in Parent Tag" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0].@token - Token of Metadata Configuration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConf</emphasis> - Metadata Configuration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
 <listitem>
                          <para>
                            If <emphasis role="italic">metadataConf</emphasis>.Name != "TestName1", restore DUT settings and FAIL the test.
                          </para>
                        </listitem>                
                </orderedlist>
              </para>
            </listitem>
          <listitem>
                          <para>
                            ONVIF Client restores DUT settings.
                          </para>
                        </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send the correct information in the <emphasis role="bold">GetDNSResponse</emphasis> message (i.e. FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have default namespaces definition in parent tag (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DEVICE-6-1-3-->
      <section xml:id="tc.DEVICE-6-1-3">
        <title>DEVICE MANAGEMENT - NAMESPACES (NOT STANDARD PREFIXES)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-6-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetDNS</emphasis> message (FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]) to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">SetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT and verify DNS configurations in the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> message to restore the original settings of the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is not supported by the DUT and Metadata feature under Media2 Service is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configurations list by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfigurationsList"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Non-Standard Prefixes" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConfList</emphasis> - Metadata Configurations list
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client sets Metadata Configuration with Non-Standard Prefixes namespaces definition by following the procedure mentioned in <xref linkend="Annex_HelperSetMetadataConfiguration"/> with the following input parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0] - Metadata Configuration
                          </para>
                        </listitem>
                       <listitem>
                          <para>
                            in "Non-Standard Prefixes" - option for namespaces declaration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configuration by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfiguration"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Non-Standard Prefixes" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0].@token - Token of Metadata Configuration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConf</emphasis> - Metadata Configuration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
 <listitem>
                          <para>
                            If <emphasis role="italic">metadataConf</emphasis>.Name != "TestName1", restore DUT settings and FAIL the test.
                          </para>
                        </listitem>                
                </orderedlist>
              </para>
            </listitem>
        <listitem>
                          <para>
                            ONVIF Client restores DUT settings.
                          </para>
                        </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send the correct information in the <emphasis role="bold">GetDNSResponse</emphasis> message (i.e. FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with not standard prefixes (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DEVICE-6-1-4-->
      <section xml:id="tc.DEVICE-6-1-4">
        <title>DEVICE MANAGEMENT - NAMESPACES (DIFFERENT PREFIXES FOR THE SAME NAMESPACE)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-6-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetDNS</emphasis> message (FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]) to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">SetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT and verify DNS configurations in the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> message to restore the original settings of the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is not supported by the DUT and Metadata feature under Media2 Service is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configurations list by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfigurationsList"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Different Prefixes for the Same Namespace" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConfList</emphasis> - Metadata Configurations list
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client sets Metadata Configuration with Different Prefixes for the Same Namespace namespaces declaration by following the procedure mentioned in <xref linkend="Annex_HelperSetMetadataConfiguration"/> with the following input parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0] - Metadata Configuration
                          </para>
                        </listitem>
                       <listitem>
                          <para>
                            in "Different Prefixes for the Same Namespace" - option for namespaces declaration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configuration by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfiguration"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Different Prefixes for the Same Namespace" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0].@token - Token of Metadata Configuration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConf</emphasis> - Metadata Configuration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
 <listitem>
                          <para>
                            If <emphasis role="italic">metadataConf</emphasis>.Name != "TestName1", restore DUT settings and FAIL the test.
                          </para>
                        </listitem>                
                </orderedlist>
              </para>
            </listitem>
          <listitem>
                          <para>
                            ONVIF Client restores DUT settings.
                          </para>
                        </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send the correct information in the <emphasis role="bold">GetDNSResponse</emphasis> message (i.e. FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with different prefixes for the same namespace (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
      <!--DEVICE-6-1-5-->
      <section xml:id="tc.DEVICE-6-1-5">
        <title>DEVICE MANAGEMENT - NAMESPACES (THE SAME PREFIX FOR DIFFERENT NAMESPACES)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-6-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> XML namespaces definition
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> None.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetDNS</emphasis> message (FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]) to retrieve the original settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">SetDNSResponse</emphasis> message from the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">GetDNS</emphasis> message to retrieve the settings of the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Verify the <emphasis role="bold">GetDNSResponse</emphasis> message from the DUT and verify DNS configurations in the DUT.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client will invoke <emphasis role="bold">SetDNS</emphasis> message to restore the original settings of the DUT.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If Network Configuration is not supported by the DUT and Metadata feature under Media2 Service is supported by the DUT
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width=2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configurations list by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfigurationsList"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Same Prefixes for Different Namespaces" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConfList</emphasis> - Metadata Configurations list
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client sets Metadata Configuration with Same Prefixes for Different Namespaces namespaces declaration by following the procedure mentioned in <xref linkend="Annex_HelperSetMetadataConfiguration"/> with the following input parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0] - Metadata Configuration
                          </para>
                        </listitem>
                       <listitem>
                          <para>
                            in "Same Prefixes for Different Namespaces" - option for namespaces declaration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      ONVIF Client retrieves Metadata Configuration by following the procedure mentioned in <xref linkend="Annex_HelperGetMetadataConfiguration"/> with the following input and output parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            in "Same Prefixes for Different Namespaces" - option for namespaces declaration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            in <emphasis role="italic">metadataConfList</emphasis>[0].@token - Token of Metadata Configuration
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            out <emphasis role="italic">metadataConf</emphasis> - Metadata Configuration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
 <listitem>
                          <para>
                            If <emphasis role="italic">metadataConf</emphasis>.Name != "TestName1", restore DUT settings and FAIL the test.
                          </para>
                        </listitem>                
                </orderedlist>
              </para>
            </listitem>
          <listitem>
                          <para>
                            ONVIF Client restores DUT settings.
                          </para>
                        </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetDNSResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send the correct information in the <emphasis role="bold">GetDNSResponse</emphasis> message (i.e. FromDHCP = false, DNSManual = ["IPv4", "DNS IP"]).
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> All requests to the DUT shall have namespaces definition with the same prefixes for different namespaces (see examples in <link linkend="Annex_namespaces_examples">Annex A.11</link>).
        </para>
      </section>
    </section>
    <!--IP Filtering-->
    <section xml:id="tc.device_management.ip_filtering">
      <title>IP Filtering</title>
      <!--DEVICE-7-1-1-->
      <section xml:id="tc.DEVICE-7-1-1">
        <title>GET IP ADDRESS FILTER</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-7-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Get IP address filter (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetIPAddressFilter
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To retrieve IP address filter settings for the DUT using GetIPAddressFilter command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. The device supports device access control based on IP filtering rules (denied or accepted ranges of IP addresses)
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve IP address filter settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetIPAddressFilterResponse</emphasis> from the DUT (IPAddressFilter [Type = ‘Allow’ or ‘Deny’, IPv4Address = list of IPv4 filter addresses, IPv6Address = list of IPv6 filter addresses]).
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returned IPv4Address, validate IPv4Address.Address and IPv4Address.PrefixLength. Check that IPv4Address.Address represented at dot-decimal notation format. Check that 0 >= IPv4Address.PrefixLength >= 32.
              </para>
            </listitem>
            <listitem>
              <para>
                Check that IPv4Address.Address along with IPv4Address.PrefixLength is a valid range of IPv4 addresses according to Classless Inter-Domain Routing (CIDR) method.
              </para>
            </listitem>
            <listitem>
              <para>
                If the DUT returned IPv6Address, validate IPv6Address.Address and IPv6Address.PrefixLength. Check that IPv6Address.Address represented as eight groups of four hexadecimal digits (or simplified). Check that 0 >= IPv6Address.PrefixLength >= 128.
              </para>
            </listitem>
            <listitem>
              <para>
                Check that IPv6Address.Address along with IPv6Address.PrefixLength is a valid range of IPv4 addresses according to Classless Inter-Domain Routing (CIDR) method.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct information (i.e. IPAddressFilter [Type = Allow or Deny, IPv4Address = list of IPv4 filter addresses, IPv6Address = list of IPv6 filter addresses]) in the GetIPAddressFilterResponse message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct IPv4Address (IPv4Address.Address represented at dot-decimal notation format, 0 >= IPv4Address.PrefixLength >= 32)
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct IPv4Address range.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct IPv6Address (IPv6Address.Address represented as eight groups of four hexadecimal digits (or simplified, 0 >= IPv6Address.PrefixLength >= 128)
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send correct IPv6Address range.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> See <link linkend="Annex_empty_ip_address">Annex A.10</link> for valid expression in terms of empty IP address.
        </para>
      </section>
      <!--DEVICE-7-1-2-->
      <section xml:id="tc.DEVICE-7-1-2">
        <title>SET IP ADDRESS FILTER – IPv4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-7-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Set IP address filter (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SetIPAddressFilter
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To configure IP address filter settings for the DUT using SetIPAddressFilter command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. The device supports device access control based on IP filtering rules (denied or accepted ranges of IP addresses)
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve the original settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message from the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetIPAddressFilter</emphasis> request (IPAddressFilter [Type = Deny, IPv4Address = IPv4Address1]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetIPAddressFilterResponse</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve updated settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message from the DUT. Check that the settings were applied.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetIPAddressFilter</emphasis> request (IPAddressFilter [Type = Allow, IPv4Address = IPv4Address2]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetIPAddressFilterResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve updated settings of DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message from the DUT. Check that the settings were applied.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client restores the original settings of DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not apply new settings after sending <emphasis role="bold">SetIPAddressFilter</emphasis> command.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4Address1 shall be different from the current IP address of ONVIF Client.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4Address2 shall be the same with current IP address of ONVIF Client.
        </para>
      </section>
      <!--DEVICE-7-1-3-->
      <section xml:id="tc.DEVICE-7-1-3">
        <title>ADD IP ADDRESS FILTER – IPv4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-7-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Add IP address to filter (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> AddIPAddressFilter
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To add IP filter address to the DUT using AddIPAddressFilter command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. The device supports device access control based on IP filtering rules (denied or accepted ranges of IP addresses)
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve IP address filter settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetIPAddressFilterResponse</emphasis> from the DUT (IPAddressFilter [Type = CurrentType (Allow or Deny), IPv4Address = list of IPv4 filter addresses, IPv6Address = list of IPv6 filter addresses]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetIPAddressFilter</emphasis> request message (IPAddressFilter [Type = Deny, IPv4Address empty list]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetIPAddressFilterResponse</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">AddIPAddressFilter</emphasis> request (IPAddressFilter [Type = Deny, IPv4Address = IPv4Address1]) message to add IP filter address to the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">AddIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-7-1-3.9">
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve updated IP address filter settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetIPAddressFilterResponse</emphasis> from DUT (IPAddressFilter [Type = Deny, IPv4Address = IPv4Address1]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client restores the original settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">AddIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not return a new IP address at step <link linkend="tc.DEVICE-7-1-3.9">9</link>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4Address1 shall be different from the current IP address of ONVIF Client.
        </para>
      </section>
      <!--DEVICE-7-1-4-->
      <section xml:id="tc.DEVICE-7-1-4">
        <title>REMOVE IP ADDRESS FILTER – IPv4</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-7-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Remove IP address from filter (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> RemoveIPAddressFilter
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To remove IP filter address from the DUT using RemoveIPAddressFilter command.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Network Configuration is supported by the DUT. The device supports device access control based on IP filtering rules (denied or accepted ranges of IP addresses)
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve IP address filter settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify the <emphasis role="bold">GetIPAddressFilterResponse</emphasis> from the DUT (IPAddressFilter [Type = CurrentType (Allow or Deny), IPv4Address = list of IPv4 filter addresses, IPv6Address = list of IPv6 filter addresses]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">SetIPAddressFilter</emphasis> request (IPAddressFilter [Type = Deny, IPv4Address = IPv4Address1]).
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">SetIPAddressFilterResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve updated settings of the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message from the DUT. Check that the settings were applied.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">RemoveIPAddressFilter</emphasis> request (IPAddressFilter [Type = Allow, IPv4Address = IPv4Address1]) to remove IP filter address in the list.
              </para>
            </listitem>
            <listitem>
              <para>
                Verify that the DUT sends <emphasis role="bold">RemoveIPAddressFilterResponse</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client will invoke <emphasis role="bold">GetIPAddressFilter</emphasis> request to retrieve updated IP address filter settings of the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-7-1-4.12">
              <para>
                Verify the <emphasis role="bold">GetIPAddressFilterResponse</emphasis> from the DUT (IPAddressFilter [Type = Deny, IPv4Address = empty list]).
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client restores the original settings of the DUT.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">RemoveIPAddressFilterResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send an empty IPv4Address list at step <link linkend="tc.DEVICE-7-1-4.12">12</link>.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4Address1 shall be different from the current IP address of ONVIF Client.
        </para>
      </section>
    </section>
    <!--Auxiliary Operation-->
    <section xml:id="tc.device_management.auxiliary_operation">
      <title>Auxiliary Operation</title>
      <!--DEVICE-8-1-1-->
      <section xml:id="tc.DEVICE-8-1-1">
        <title>AUXILIARY COMMANDS</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-8-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Auxiliary operation (ONVIF Core Specification)
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> SendAuxiliaryCommand, tt:Wiper, tt:Washer, tt:WashingProcedure, tt:IRLamp
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT accepts requests for Device Management Service with different namespaces definition.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> GetServices command is supported by the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <emphasis role="bold">Test Procedure:</emphasis>
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> request.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Capabilities =: <emphasis role="italic">capabilities</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                For each auxilary command (<emphasis role="italic">aux</emphasis>) from the list {tt:Wiper|On, tt:Wiper|Off, tt:Washer|On, tt:Washer|Off, tt:WashingProcedure|On, tt:WashingProcedure|Off, tt:IRLamp|On, tt:IRLamp|Off, tt:IRLamp|Auto} which are supported according to <emphasis role="italic">capabilities</emphasis>.Misc.AuxiliaryCommands repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SendAuxiliaryCommand</emphasis> request with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            AuxiliaryCommand := <emphasis role="italic">aux</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">SendAuxiliaryCommandResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            AuxiliaryCommandResponse
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">SendAuxiliaryCommandResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
      </section>
    </section>
    <!--Monitoring Events-->
    <section xml:id="tc.device_management.monitoring_events">
      <title>Monitoring Events</title>
      <!--DEVICE-9-1-1-->
      <section xml:id="tc.DEVICE-9-1-1">
        <title>Processor Usage event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-1
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event ProcessorUsage
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Monitoring/ProcessorUsage event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/ProcessorUsage event generation after subscription and to verify tns1:Monitoring/ProcessorUsage event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/ProcessorUsage event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Monitoring/ProcessorUsage</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Monitoring/ProcessorUsage</emphasis> topic (<emphasis role="italic">processorUsageTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">processorUsageTopic</emphasis>.MessageDescription.IsProperty is skipped or equals false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">processorUsageTopic</emphasis> does not contain MessageDescription.Source.SimpleItemDescription item with Name = "Token", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">processorUsageTopic</emphasis>.MessageDescription.Source.SimpleItemDescription with Name = "Token" does not have Type = "tt:ReferenceToken", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">processorUsageTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Value", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">processorUsageTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Value" does not have Type = "xs:float", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/ProcessorUsage"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-1.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis>.Topic does not equal to <emphasis role="bold">tns1:Monitoring/ProcessorUsage</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Source.SimpleItem.Token, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis>.Message.Message.Source.SimpleItem.Token has value type different from tt:ReferenceToken type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Value, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis>.Message.Message.Data.SimpleItem.Value has value type different from xs:float type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis>.Message.Message.Data.SimpleItem.Value value is outside of range 0 to 100, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-1.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-1.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-1.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-2-->
      <section xml:id="tc.DEVICE-9-1-2">
        <title>Last Reset event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-2
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastReset
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Monitoring/OperatingTime/LastReset event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/OperatingTime/LastReset event generation after subscription and to verify tns1:Monitoring/OperatingTime/LastReset event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastReset event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReset</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReset</emphasis> topic (<emphasis role="italic">lastResetTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastResetTopic</emphasis> MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastResetTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Status", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastResetTopic</emphasis> MessageDescription.Data.SimpleItemDescription with Name = "Status" does not have Type = "xs:dateTime", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastReset"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-2.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReset</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-2.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-2.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-2.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-2.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-2.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-2.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-2.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-3-->
      <section xml:id="tc.DEVICE-9-1-3">
        <title>Last Reboot event</title>
        <para>
          Test Label: Last Reboot event
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-3
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastReboot
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Monitoring/OperatingTime/LastReboot event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/OperatingTime/LastReboot event generation after subscription and to verify tns1:Monitoring/OperatingTime/LastReboot event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastReboot event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReboot</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReboot</emphasis> topic (<emphasis role="italic">lastRebootTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastRebootTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastRebootTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Status", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastRebootTopic</emphasis>.MessageDescription.Data.SimpleItemDescription with Name = "Status" does not have Type = "xs:dateTime", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastReboot"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-3.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastReboot</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-3.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-3.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-3.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-3.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-3.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-3.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-3.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-4-->
      <section xml:id="tc.DEVICE-9-1-4">
        <title>Last Reboot event (Status change)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-4
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastReboot
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> CreatePullPointSubscription, PullMessages, SystemReboot, Monitoring/OperatingTime/LastReboot event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify that the last reboot event signals correct values.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastReboot event is supported by the DUT as indicated by the GetEventPropertiesResponse. NTP server in network and configured on the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem xml:id="tc.DEVICE-9-1-4.1">
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.2">
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-4.3">
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastReboot"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-4.4">
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.5">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.6">6</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.17">17</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Set <emphasis role="italic">lastRebootTime</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-4.6">6</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-4.5">5</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.17">17</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.6">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>. The test should not FAIL even if Unsubscribe fails.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.7">
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message. The test should not FAIL even if <emphasis role="bold">UnsubscribeResponse</emphasis> message is not received.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.8">
              <para>
                ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.9">
              <para>
                The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Message
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.10">
              <para>
                Until <emphasis role="italic">timeout2</emphasis> timeout expires repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If DUT supports Discovery:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            The DUT will send Multicast <emphasis role="bold">Hello</emphasis> message after it is successfully rebooted with parameters:
                            <itemizedlist>
                              <listitem>
                                <para>
                                  EndpointReference.Address equal to unique endpoint reference of the DUT
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  Types list
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  Scopes list
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  XAddrs list := <emphasis role="italic">xaddrsList</emphasis>
                                </para>
                              </listitem>
                              <listitem>
                                <para>
                                  MetadataVersion
                                </para>
                              </listitem>
                            </itemizedlist>
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">xaddrsList</emphasis> contains URI address with not a LinkLocal IPv4 address from ONVIF Client subnet, go to step <link linkend="tc.DEVICE-9-1-4.12">12</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If DUT does not support Discovery:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>                  
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.11">
              <para>
                If Discovery is supported and <emphasis role="italic">timeout2</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-4.10">10</link> without <emphasis role="bold">Hello</emphasis> with URI address with not a LinkLocal IPv4 address from ONVIF Client subnet, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.12">
              <para>
                ONVIF client waits for 5 seconds after <emphasis role="bold">Hello</emphasis> was received.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.13">
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastReboot"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.14">
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.15">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.16">16</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.17">17</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Set <emphasis role="italic">updatedRebootTime</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-4.16">16</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-4.15">15</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-4.17">17</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.16">
              <para>
                If <emphasis role="italic">updatedRebootTime</emphasis> &lt;= <emphasis role="italic">lastRebootTime</emphasis>, FAIL the test and go to the next step.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.17">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-4.18">
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout2</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> IPv4 address from Hello shall be used for further test cases. Previous Device service address will be selected if it is present on the XAddrs list of Hello message.
        </para>
      </section>
      <!--DEVICE-9-1-5-->
      <section xml:id="tc.DEVICE-9-1-5">
        <title>Last Clock Synchronization event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-5
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastClockSynchronication
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Monitoring/OperatingTime/LastClockSynchronization event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/OperatingTime/LastClockSynchronization event generation after subscription and to verify tns1:Monitoring/OperatingTime/LastClockSynchronization event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastClockSynchronization event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis> topic (<emphasis role="italic">lastClockSynchronizationTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastClockSynchronizationTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastClockSynchronizationTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Status", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastClockSynchronizationTopic</emphasis>.MessageDescription.Data.SimpleItemDescription with Name = "Status" does not have Type = "xs:dateTime", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastClockSynchronization"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-5.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value time in format different from utc format with including the 'Z' indicator, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-5.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-5.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-5.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-6-->
      <section xml:id="tc.DEVICE-9-1-6">
        <title>Last Clock Synchronization change event (SetSystemDateAndTime)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-6
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastClockSynchronication
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, CreatePullPointSubscription, PullMessages, SetSystemDateAndTime, Monitoring/OperatingTime/LastClockSynchronization event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/OperatingTime/LastClockSynchronization event generation after property was changed via SetSystemDateAndTime call and to verify tns1:Monitoring/OperatingTime/LastClockSynchronization event format. To verify that the clock synchronization event signals correct values.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastClockSynchronization event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem xml:id="tc.DEVICE-9-1-6.1">
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.2">
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.3">
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastClockSynchronization"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.4">
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.5">
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.6">
              <para>
                The DUT responds with a <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">initialSystemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.7">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> TopicDialect does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-6.8">8</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-6.7">7</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.8">
              <para>
                Set <emphasis role="italic">initialClockSynchronization</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.9">
              <para>
                ONVIF Client waits for 1 second.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.10">
              <para>
                ONVIF Client  invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := Manual
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := false
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime := <emphasis role="italic">initialSystemDateAndTime</emphasis>.UTCDateTime received from DUT on step <link linkend="tc.DEVICE-9-1-6.6">6</link>. If <emphasis role="italic">initialSystemDateAndTime</emphasis>.UTCDateTime is empty, then system date and time should be used to populate this parameter.
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.11">
              <para>
                The DUT responds with a <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.12">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation="Changed" ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> TopicDialect does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Set <emphasis role="italic">lastClockSynchronization</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-6.13">13</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-6.11">11</link> without Notification with PropertyOperation="Changed", FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-6.14">14</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.13">
              <para>
                If <emphasis role="italic">lastClockSynchronization</emphasis> is less or equal to <emphasis role="italic">initialClockSynchronization</emphasis>, FAIL the test and go to the next step.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.14">
              <para>
                ONVIF Client restores Default System Date and Time by following the procedure mentioned in <link linkend="Annex_HelperRestoreSystemDateAndTime">Annex A.20</link> with the following input and output parameters<itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">initialSystemDateAndTime</emphasis> - initial system date and time settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.15">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-6.16">
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-7-->
      <section xml:id="tc.DEVICE-9-1-7">
        <title>Last Clock Synchronization change event (NTP message)</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-7
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event LastClockSynchronication
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, CreatePullPointSubscription, PullMessages, SetSystemDateAndTime, SetNTP, Monitoring/OperatingTime/LastClockSynchronization event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/OperatingTime/LastClockSynchronization event generation after property was changed via an NTP message and to verify tns1:Monitoring/OperatingTime/LastClockSynchronization event format. To verify that the clock synchronization event signals correct values.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/OperatingTime/LastClockSynchronization event is supported by the DUT as indicated by the GetEventPropertiesResponse. NTP is supported by the DUT as indicated by the Network.NTP capability. A valid NTP server address should be configured in the DUT.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem  xml:id="tc.DEVICE-9-1-7.1">
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-7.2">
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-7.3">
              <para>
                ONVIF Client invokes <emphasis role="bold">GetSystemDateAndTime</emphasis>.
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-7.4">
              <para>
                The DUT responds with a <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SystemDateAndTime =: <emphasis role="italic">initialSystemDateAndTime</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem  xml:id="tc.DEVICE-9-1-7.5">
              <para>
                ONVIF Client invokes <emphasis role="bold">GetNTP</emphasis>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.6">
              <para>
                The DUT responds with a <emphasis role="bold">GetNTPResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      NTPInformation =: <emphasis role="italic">initialNTPInformation</emphasis>
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.7">
              <para>
                If <emphasis role="italic">initialSystemDateAndTime</emphasis>.DataTimeType = NTP, ONVIF Client  invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := Manual
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := false
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone skipped
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime := <emphasis role="italic">initialSystemDateAndTime</emphasis>.UTCDateTime received from DUT on step <link linkend="tc.DEVICE-9-1-7.4">4</link>. If <emphasis role="italic">initialSystemDateAndTime</emphasis>.UTCDateTime is empty, then system date and time should be used to populate this parameter.
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.8">
              <para>
                The DUT responds with a <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.9">
              <para>
                ONVIF Client configures DUT with proper NTP server by following the procedure mentioned in <link linkend="Annex_HelperSetNTP">Annex A.21</link>.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/OperatingTime/LastClockSynchronization"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.11">
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.12">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.17">17</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.17">17</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-7.13">13</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-7.12">12</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.17">17</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.13">
              <para>
                Set <emphasis role="italic">initialClockSynchronization</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.14">
              <para>
                ONVIF Client waits for 1 second.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.15">
              <para>
                ONVIF Client  invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      DateTimeType := NTP
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DaylightSavings := false
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TimeZone := POSIX 1003.1
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      UTCDateTime skipped
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.16">
              <para>
                The DUT responds with a <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.17">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation="Changed" ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> TopicDialect does not equal to <emphasis role="bold">tns1:Monitoring/OperatingTime/LastClockSynchronization</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.19">19</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.19">19</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.19">19</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Set <emphasis role="italic">lastClockSynchronization</emphasis> := <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-7.18">18</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-7.10">10</link> without Notification with PropertyOperation="Changed", FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-7.19">19</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.18">
              <para>
                If <emphasis role="italic">lastClockSynchronization</emphasis> is less or equal to <emphasis role="italic">initialClockSynchronization</emphasis>, FAIL the test and go to the next step.
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.19">
              <para>
                ONVIF Client restores Default System Date and Time by following the procedure mentioned in <link linkend="Annex_HelperRestoreSystemDateAndTime">Annex A.20</link> with the following input and output parameters<itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">initialSystemDateAndTime</emphasis> - initial system date and time settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.20">
              <para>
                ONVIF Client configures DUT with proper NTP server by following the procedure mentioned in <link linkend="Annex_HelperRestoreNTP">Annex A.22</link> with the following input and output parameters<itemizedlist>
                  <listitem>
                    <para>
                      in <emphasis role="italic">initialNTPInformation</emphasis> - initial NTP settings
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.21">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-7.22">
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetNTPResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-8-->
      <section xml:id="tc.DEVICE-9-1-8">
        <title>Last Backup event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-8
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event Last Backup
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Monitoring/Backup/Last event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Monitoring/Backup/Last intial event generation and to verify tns1:Monitoring/Backup/Last event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Monitoring/Backup/Last event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Monitoring/Backup/Last</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Monitoring/Backup/Last</emphasis> topic (<emphasis role="italic">lastBackupTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastBackupTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastBackupTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Status", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">lastBackupTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Status" does not have Type = "xs:dateTime", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Monitoring/Backup/Last"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-8.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Monitoring/Backup/Last</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-8.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Status, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-8.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Status has value type different from xs:dateTime type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-8.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-8.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-8.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-8.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-8.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-9-->
      <section xml:id="tc.DEVICE-9-1-9">
        <title>Fan Failure event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-9
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event Fan Failure
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Device/HardwareFailure/FanFailure event format
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Device/HardwareFailure/FanFailure event generation and to verify tns1:Device/HardwareFailure/FanFailure event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Device/HardwareFailure/FanFailure event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Device/HardwareFailure/FanFailure</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Device/HardwareFailure/FanFailure</emphasis> topic (<emphasis role="italic">fanFailureTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">fanFailureTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">fanFailureTopic</emphasis> does not contain MessageDescription.Source.SimpleItemDescription item with Name = "Token", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">fanFailureTopic</emphasis>.MessageDescription.Source.SimpleItemDescription item with Name = "Token" does not have Type = "tt:ReferenceToken", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">fanFailureTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Failed", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">fanFailureTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Failed" does not have Type = "xs:boolean", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Device/HardwareFailure/FanFailure"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-9.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Device/HardwareFailure/FanFailure</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Source.SimpleItem.Token, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Source.SimpleItem.Token has value type different from tt:ReferenceToken type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Failed, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Failed has value type different from xs:boolean type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-9.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-9.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-9.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-10-->
      <section xml:id="tc.DEVICE-9-1-10">
        <title>Power Supply Failure event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-10
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event Power Supply Failure
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Device/HardwareFailure/PowerSupplyFailure event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Device/HardwareFailure/PowerSupplyFailure event generation and to verify tns1:Device/HardwareFailure/PowerSupplyFailure event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Device/HardwareFailure/PowerSupplyFailure event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Device/HardwareFailure/PowerSupplyFailure</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Device/HardwareFailure/PowerSupplyFailure</emphasis> topic (<emphasis role="italic">powerSupplyFailureTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">powerSupplyFailureTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">powerSupplyFailureTopic</emphasis> does not contain MessageDescription.Source.SimpleItemDescription item with Name = "Token", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">powerSupplyFailureTopic</emphasis>.MessageDescription.Source.SimpleItemDescription item with Name = "Token" does not have Type = "tt:ReferenceToken", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If powerSupplyFailedTopic does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Failed", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">powerSupplyFailureTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Failed" does not have Type = "xs:boolean", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Device/HardwareFailure/PowerSupplyFailure"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-10.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Device/HardwareFailure/PowerSupplyFailure</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Source.SimpleItem.Token, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Source.SimpleItem.Token has value type different from tt:ReferenceToken type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Failed, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Failed has value type different from xs:boolean type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-10.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-10.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-10.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-11-->
      <section xml:id="tc.DEVICE-9-1-11">
        <title>Storage Failure event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-11
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event Storage Failure
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Device/HardwareFailure/StorageFailure event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Device/HardwareFailure/StorageFailure event generation and to verify tns1:Device/HardwareFailure/StorageFailure event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Device/HardwareFailure/StorageFailure event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Device/HardwareFailure/StorageFailure</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Device/HardwareFailure/StorageFailure</emphasis> topic (<emphasis role="italic">storageFailureTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">storageFailureTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">storageFailureTopic</emphasis> does not contain MessageDescription.Source.SimpleItemDescription item with Name = "Token", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">storageFailureTopic</emphasis>.MessageDescription.Source.SimpleItemDescription item with Name = "Token" does not have Type = "tt:ReferenceToken", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">storageFailureTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Failed", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">storageFailureTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Failed" does not have Type = "xs:boolean", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Device/HardwareFailure/StorageFailure"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-11.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Device/HardwareFailure/StorageFailure</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Source.SimpleItem.Token, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Source.SimpleItem.Token has value type different from tt:ReferenceToken type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Failed, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Failed has value type different from xs:boolean type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-11.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-11.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-11.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
      <!--DEVICE-9-1-12-->
      <section xml:id="tc.DEVICE-9-1-12">
        <title>Critical Temperature event</title>
        <para>
          <emphasis role="bold">Test Case ID:</emphasis> DEVICE-9-1-12
        </para>
        <para>
          <emphasis role="bold">Specification Coverage:</emphasis> Monitoring Event Critical Temperature
        </para>
        <para>
          <emphasis role="bold">Feature Under Test:</emphasis> GetServices, GetEventProperties, CreatePullPointSubscription, PullMessages, Device/HardwareFailure/TemperatureCritical event
        </para>
        <para>
          <emphasis role="bold">WSDL Reference:</emphasis> devicemgmt.wsdl and event.wsdl
        </para>
        <para>
          <emphasis role="bold">Test Purpose:</emphasis> To verify tns1:Device/HardwareFailure/TemperatureCritical event generation and to verify tns1:Device/HardwareFailure/TemperatureCritical event format.
        </para>
        <para>
          <emphasis role="bold">Pre-Requisite:</emphasis> Event Service was received from the DUT. tns1:Device/HardwareFailure/TemperatureCritical event is supported by the DUT as indicated by the GetEventPropertiesResponse.
        </para>
        <para>
          <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
        </para>
        <para>
          <orderedlist>
            <?dbfo label-width="1.5em"?>
            <listitem>
              <para>
                Start an ONVIF Client.
              </para>
            </listitem>
            <listitem>
              <para>
                Start the DUT.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">GetEventProperties</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">GetEventPropertiesResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      TopicNamespaceLocation list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      FixedTopicSet
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicSet =: <emphasis role="italic">topicSet</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TopicExpressionDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentFilterDialect list
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      MessageContentSchemaLocation list
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                If <emphasis role="italic">topicSet</emphasis> does not contain <emphasis role="bold">tns1:Device/HardwareFailure/TemperatureCritical</emphasis> topic, FAIL the test and skip other steps.
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client verifies <emphasis role="bold">tns1:Device/HardwareFailure/TemperatureCritical</emphasis> topic (<emphasis role="italic">criticalTemperatureTopic</emphasis>) from <emphasis role="italic">topicSet</emphasis>:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      If <emphasis role="italic">criticalTemperatureTopic</emphasis>.MessageDescription.IsProperty is skipped or equals to false, FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">criticalTemperatureTopic</emphasis> does not contain MessageDescription.Data.SimpleItemDescription item with Name = "Critical", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">criticalTemperatureTopic</emphasis>.MessageDescription.Data.SimpleItemDescription item with Name = "Critical" does not have Type = "xs:boolean", FAIL the test and skip other steps.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                ONVIF Client invokes <emphasis role="bold">CreatePullPointSubscription</emphasis> with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      Filter.TopicExpression := "tns1:Device/HardwareFailure/TemperatureCritical"
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      Filter.TopicExpression.@Dialect := "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet"
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with a <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message with parameters
                <itemizedlist>
                  <listitem>
                    <para>
                      SubscriptionReference =: <emphasis role="italic">s</emphasis>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      CurrentTime
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      TerminationTime
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-12.9">
              <para>
                Until <emphasis role="italic">timeout1</emphasis> timeout expires, repeat the following steps:
                <orderedlist numeration="arabic" inheritnum="inherit">
                  <?dbfo label-width="2.5em"?>
                  <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">PullMessages</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis> with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            Timeout := PT60S
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            MessageLimit := 1
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      The DUT responds with <emphasis role="bold">PullMessagesResponse</emphasis> message with parameters
                      <itemizedlist>
                        <listitem>
                          <para>
                            CurrentTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            TerminationTime
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            NotificationMessage =: <emphasis role="italic">m</emphasis>
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">m</emphasis> is not null and <emphasis role="italic">m</emphasis> Message.Message.PropertyOperation = Initialized ONVIF Client verifies <emphasis role="italic">m</emphasis>:
                      <orderedlist numeration="arabic" inheritnum="inherit">
                        <?dbfo label-width="3.5em"?>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Topic does not equal to <emphasis role="bold">tns1:Device/HardwareFailure/TemperatureCritical</emphasis>, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-12.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> does not contain Message.Message.Data.SimpleItem.Critical, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-12.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            If <emphasis role="italic">m</emphasis> Message.Message.Data.SimpleItem.Critical has value type different from xs:boolean type, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-12.10">10</link>.
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Go to the step <link linkend="tc.DEVICE-9-1-12.10">10</link>.
                          </para>
                        </listitem>
                      </orderedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      If <emphasis role="italic">timeout1</emphasis> timeout expires for step <link linkend="tc.DEVICE-9-1-12.9">9</link> without Notification with PropertyOperation = Initialized, FAIL the test and go to the step <link linkend="tc.DEVICE-9-1-12.10">10</link>.
                    </para>
                  </listitem>
                </orderedlist>
              </para>
            </listitem>
            <listitem xml:id="tc.DEVICE-9-1-12.10">
              <para>
                ONVIF Client invokes <emphasis role="bold">Unsubscribe</emphasis> to the subscription endpoint <emphasis role="italic">s</emphasis>.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT responds with <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </orderedlist>
        </para>
        <para>
          <emphasis role="bold">Test Result:</emphasis>
        </para>
        <para>
          <emphasis role="bold">PASS –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                DUT passes all assertions.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">FAIL –</emphasis>
          <itemizedlist>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">GetEventPropertiesResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">CreatePullPointSubscriptionResponse</emphasis> message.
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">PullMessagesResponse</emphasis> message(s).
              </para>
            </listitem>
            <listitem>
              <para>
                The DUT did not send <emphasis role="bold">UnsubscribeResponse</emphasis> message.
              </para>
            </listitem>
          </itemizedlist>
        </para>
        <para>
          <emphasis role="bold">Note:</emphasis> <emphasis role="italic">timeout1</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
        </para>
      </section>
    </section>
  </chapter>
  <!--Security Test Cases-->
  <chapter xml:id="tc.security">
    <title>Security Test Cases</title>
    <!--SECURITY-1-1-1-->
    <section xml:id="tc.SECURITY-1-1-1" version="?">
      <title>USER TOKEN PROFILE</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> SECURITY-1-1-1
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Message level security
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> WS-Security Username token authentication
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT supports the User Token Profile for Message level security.
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              A user with Administrator rights (and password set) is needed in this test case. If such a user does not exist, then one shall be created before the test is executed. Similarly, if there exists such a user but the password has not been set, then the password shall be set before the test is executed. If any such changes to user settings are needed for this test case, then they should be done before starting the test sequence and the DUT should be reset to its original settings when the test sequence is finished.
            </para>
          </listitem>
          <listitem>
            <para>
              At least one operation that requires authentication is needed in this test case. If the example given in this test case (GetUsers) does not require authentication, then the test operator shall choose another operation that does require authentication.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client sends a request that requires authentication (e.g. GetUsers) to the DUT with incorrectly implemented UsernameToken. Each of the following shall be tested:
              <itemizedlist>
                <listitem>
                  <para>
                    Missing nonce.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Missing timestamp.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Incorrect password type.
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT rejects all incorrect requests.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client sends a request (e.g. GetUsers) to the DUT with correctly formatted UsernameToken.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT accepts the correct request.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT does not support Username Token profile.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT accepts Username Token without nonce.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT accepts Username Token without timestamp.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT accepts Username Token without password type "PasswordDigest".
            </para>
          </listitem>
          <listitem>
            <para>
              DUT rejects Username Token with nonce and timestamp.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> Below is an example of a correctly formed UsernameToken for message level security, with nonce, timestamp and correct password type. For further details, refer to [ONVIF Network Interface Specs] and [WS-Security].
        <programlisting>
          <![CDATA[
<SOAP:Envelope xmlns:SOAP="..." xmlns:wsse="..." xmlns:wsu= "..."> 
    <SOAP:Header>
    ...
    <wsse:Security>
      <wsse:UsernameToken>
        <wsse:Username>...</wsse:Username>
        <wsse:Password Type="...#PasswordDigest">…</wsse:Password>
        <wsse:Nonce>…</wsse:Nonce>
        <wsu:Created>…</wsu:Created>
      </wsse:UsernameToken>
    </wsse:Security>
    ...
  </SOAP:Header>
  ...
</SOAP:Envelope>]]>
        </programlisting>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> Other types of authentication shall not be used during this test.
      </para>
    </section>
    <!--SECURITY-1-1-2-->
    <section xml:id="tc.SECURITY-1-1-2" version="?">
      <title>DIGEST AUTHENTICATION</title>
      <para>
        <emphasis role="bold">Test Case ID:</emphasis> SECURITY-1-1-2
      </para>
      <para>
        <emphasis role="bold">Specification Coverage:</emphasis> Security
      </para>
      <para>
        <emphasis role="bold">Feature Under Test:</emphasis> HTTP Digest authentication
      </para>
      <para>
        <emphasis role="bold">WSDL Reference:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Test Purpose:</emphasis> To verify that the DUT supports the HTTP Digest Authentication for HTTP level security.
      </para>
      <para>
        <emphasis role="bold">Pre-Requisite:</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              A user with Administrator rights (and password set) is needed in this test case. If such a user does not exist, then one shall be created before the test is executed. Similarly, if there exists such a user but the password has not been set, then the password shall be set before the test is executed. If any such changes to user settings are needed for this test case, then they should be done before starting the test sequence and the DUT should be reset to its original settings when the test sequence is finished.
            </para>
          </listitem>
          <listitem>
            <para>
              At least one operation that requires authentication is needed in this test case. If the example given in this test case (GetUsers) does not require authentication, then the test operator shall choose another operation that does require authentication.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Test Configuration:</emphasis> ONVIF Client and DUT
      </para>
      <para>
        <emphasis role="bold">Test Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Start an ONVIF Client.
            </para>
          </listitem>
          <listitem>
            <para>
              Start the DUT.
            </para>
          </listitem>
          <listitem xml:id="tc.SECURITY-1-1-2.3">
            <para>
              ONVIF Client sends a request that requires authentication (e.g. GetUsers) to the DUT without any authentication.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT rejects the request with HTTP error code 401.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that DUT returns the required information in HTTP Response Header.
            </para>
          </listitem>
          <listitem>
            <para>
              Send a valid request with HTTP Digest Authentication.
            </para>
          </listitem>
          <listitem>
            <para>
              Verify that the DUT accepts the correct request.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Test Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              The DUT did not send HTTP error code 401 at step <link linkend="tc.SECURITY-1-1-2.3">3</link>.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT did not send valid WWW-Authenticate Header at step <link linkend="tc.SECURITY-1-1-2.3">3</link> (there are no Digest indications, no realm or no nonce).
            </para>
          </listitem>
          <listitem>
            <para>
              DUT rejects request with a valid HTTP digest authentication.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> No WS-UsernameToken authentication will be used in requests for this test.
      </para>
    </section>
  </chapter>
  <appendix>
    <title>Helper Procedures and Additional Notes</title>
    <!--A.1-->
    <section xml:id="Annex_InvalidDeviceTypeAndScope">
      <title>Invalid Device Type and Scope Type</title>
      <para>
        Device Type in the &lt;d:Types&gt; declaration:
        <itemizedlist>
          <listitem>
            <para>
              &lt;d:Types&gt; list shall include "dn:NetworkVideoTransmitter" or "tds:Device" depending on supported types, otherwise it is considered as invalid &lt;d:Types&gt; value.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        Device Type namespaces shall also be declared in a message:
        <itemizedlist>
          <listitem>
            <para>
              http://www.onvif.org/ver10/network/wsdl for "dn:NetworkVideoTransmitter"
            </para>
          </listitem>
          <listitem>
            <para>
              http://www.onvif.org/ver10/device/wsdl for "tds:Device"
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        Invalid Scope Type:
        <itemizedlist>
          <listitem>
            <para>
              Scope URI is not formed according to the rules of [RFC 3986].
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.2-->
    <section xml:id="Annex_InvalidHostname">
      <title>Invalid Hostname, DNSname</title>
      <para>
        A string which is not formed according to the rules of [RFC 952] and [RFC 1123] is considered as an invalid string.
      </para>
    </section>
    <!--A.3-->
    <section xml:id="Annex_InvalidTimeZone">
      <title>Invalid TimeZone</title>
      <para>
        The Time Zone format is specified by POSIX, refer to POSIX 1003.1 section 8.3.
      </para>
      <para>
        <emphasis role="bold">Example:</emphasis> Europe, Paris TZ=CET-1CEST,M3.5.0/2,M10.5.0/3
        <itemizedlist>
          <listitem>
            <para>
              CET - designation for standard time when daylight saving is not in force
            </para>
          </listitem>
          <listitem>
            <para>
              -1 - offset in hours = negative so 1 hour east of Greenwich meridian
            </para>
          </listitem>
          <listitem>
            <para>
              CEST - designation when daylight saving is in force ("Central European Summer Time")
            </para>
          </listitem>
          <listitem>
            <para>
              , - no offset number between code and comma, so default to one hour ahead for daylight saving
            </para>
          </listitem>
          <listitem>
            <para>
              M3.5.0 - when daylight saving starts = the last Sunday in March (the "5th" week means the last in the month)
            </para>
          </listitem>
          <listitem>
            <para>
              /2, - the local time when the switch occurs = 2 a.m. in this case
            </para>
          </listitem>
          <listitem>
            <para>
              M10.5.0 - when daylight saving ends = the last Sunday in October
            </para>
          </listitem>
          <listitem>
            <para>
              /3, - the local time when the switch occurs = 3 a.m. in this case
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        A TimeZone token which is not formed according to the rules of POSIX 1003.1 section 8.3 is considered as an invalid time zone.
      </para>
    </section>
    <!--A.4-->
    <section xml:id="Annex_InvalidFault">
      <title>Invalid SOAP 1.2 Fault Message</title>
      <para>
        A SOAP 1.2 fault message which is not formed according to the rules defined in SOAP 1.2, Part 1 Section 5.4 is considered as invalid.
      </para>
    </section>
    <!--A.5-->
    <section xml:id="Annex_invalid_wsdl_url">
      <title>Invalid WSDL URL</title>
      <para>
        An URL which is not formed according to the rules of [RFC 3986] is considered as an invalid WSDL URL.
      </para>
    </section>
    <!--A.6-->
    <section xml:id="Annex_ipv4_address">
      <title>Valid/Invalid IPv4 Address</title>
      <para>
        IPv4 Address token is represented in dotted decimal notation (32 bit internet address is divided into four 8-bit fields and each field is represented in decimal number separated by a dot).
      </para>
      <para>
        Valid IPv4 addresses are in the range 0.0.0.0 to 255.255.255.255 excluding 0/8, 255/8, and 127/8, as defined in [RFC 758], and 169.254/16 as defined in [RFC 3927].
      </para>
      <para>
        Valid IPv4 addresses for a device shall be valid according to the defined network mask and gateway (the gateway shall be reachable and shall not be identical to the assigned IPv4 address).
      </para>
      <para>
        Reserved addresses such as 240.0.0.0 through 255.255.255.254, as defined in [RFC 2780] are prohibited for IPv4 devices.
      </para>
    </section>
    <!--A.7-->
    <section xml:id="Annex_discovery_timeout_value">
      <title>WS-Discovery Timeout Value</title>
      <para>
        The ONVIF Client will use a hard coded timeout value (DISCOVERY_TIMEOUT) when waiting for discovery responses. The value for this timeout in the respective Test result steps is:
        <itemizedlist>
          <listitem>
            <para>
              DISCOVERY_TIMEOUT = 5 sec.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.8-->
    <section xml:id="Annex_HelperRestoreNetworkSettings">
      <title>Restore Network Settings</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperRestoreNetworkSettings
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to restore the original default network settings.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Network Configuration is supported.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> Original default network settings (<emphasis role="italic">defaultNetworkSettings</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem xml:id="tc.Annex_HelperRestoreNetworkSettings.NetworkRestore"
                    xreflabel="1">
            <para>
              ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkInterface.Enabled := <emphasis role="italic">defaultNetworkSettings</emphasis>.Enabled
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkInterface.Link := <emphasis role="italic">defaultNetworkSettings</emphasis>.Link
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">defaultNetworkSettings</emphasis>.Info.MTU is specified:
                    <itemizedlist>
                      <listitem>
                        <para>
                          NetworkInterface.MTU := <emphasis role="italic">defaultNetworkSettings</emphasis>.Info.MTU
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                  <para>otherwise NetworkInterface.MTU - skipped.</para>
                </listitem>
                <listitem>
                  <para>
                    NetworkInterface.IPv4 := <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv4
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkInterface.IPv6 := <emphasis role="italic">defaultNetworkSettings</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkInterface.Extension - skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">rebootNeeded</emphasis> = true:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          Message
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>          
          <listitem>
            <para>
              If DUT supports Discovery:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    The DUT sends <emphasis role="bold">Hello</emphasis> message from the default network interface during <emphasis role="italic">rebootTimeout</emphasis>.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If DUT does not support Discovery:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If manual IP was set at step <xref linkend="tc.Annex_HelperRestoreNetworkSettings.NetworkRestore"/>, ONVIF Client uses set IP as IP of the DUT for further test cases.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If DHCP IP was set at step <xref linkend="tc.Annex_HelperRestoreNetworkSettings.NetworkRestore"/>, ONVIF Client uses initial IP of the DUT for further test cases.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>

        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.9-->
    <section xml:id="Annex_subscribe_example">
      <title>Subscribe and CreatePullPointSubscription for Receiving All Events</title>
      <para>
        When subscribing for events an ONVIF Client might be interested in receiving all or some of the Events produced by the DUT.
      </para>
      <para>
        If an ONVIF Client is interested in receiving some events it includes a filter tag in the CreatePullPointSubscription or Subscribe requests describing the events which the ONVIF Client is interested in (see examples in the [ONVIF Core Specs]).
      </para>
      <para>
        If an ONVIF Client is interested in receiving all events from a device it does not include the Filter sub tag in the Subscribe or CreatePullPointSubscription request.
      </para>
      <para>
        <emphasis role="bold">Example:</emphasis>
      </para>
      <para>
        The following Subscribe and CreatePullPointSubscription requests can be used if an ONVIF Client is interested in receiving all events.
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Subscribe request:
            </para>
            <programlisting>
              <![CDATA[
<m:Subscribe xmlns:m="http://docs.oasis-open.org/wsn/b-2"
  xmlns:m0="http://www.w3.org/2005/08/addressing">
  <m:ConsumerReference>
    <m0:Address>
      http://192.168.0.1/events
    </m0:Address>
  </m:ConsumerReference>
</m:Subscribe>]]>
            </programlisting>
          </listitem>
          <listitem>
            <para>
              CreatePullPointSubscription request
            </para>
            <programlisting>
              <![CDATA[
<m:CreatePullPointSubscription
  xmlns:m="http://www.onvif.org/ver10/events/wsdl"/>]]>
            </programlisting>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <!--A.10-->
    <section xml:id="Annex_empty_ip_address">
      <title>Valid Expression Indicating Empty IP Address</title>
      <para>
        If a certain IP Address is not set (e.g. an NTP or a DNS Address) the device can use one of the following three possibilities:
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Use 0.0.0.0 as empty IP Address
              <programlisting>
                <![CDATA[<IPAddress>0.0.0.0</IPAddress>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Use an empty IP Address tag
              <programlisting>
                <![CDATA[<IPAddress/>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Omit the IP Address tag (if it is an optional element)
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        Example:
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Use 0.0.0.0
              <programlisting>
                <![CDATA[
<m:GetDNSResponse xmlns:m="http://www.onvif.org/ver10/device/wsdl"
  xmlns:m0="http://www.onvif.org/ver10/schema">
  <m:DNSInformation>
    <m0:FromDHCP>false</m0:FromDHCP>
    <m0:DNSManual>
      <m0:Type>IPv4</m0:Type>
      <m0:IPv4Address>0.0.0.0</m0:IPv4Address>
    </m0:DNSManual>
  </m:DNSInformation>
</m:GetDNSResponse>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Use an empty tag
              <programlisting>
                <![CDATA[
<m:GetDNSResponse xmlns:m="http://www.onvif.org/ver10/device/wsdl"
  xmlns:m0="http://www.onvif.org/ver10/schema">
  <m:DNSInformation>
    <m0:FromDHCP>false</m0:FromDHCP>
    <m0:DNSManual>
      <m0:Type>IPv4</m0:Type>
      <m0:IPv4Address/>
    </m0:DNSManual>
  </m:DNSInformation>
</m:GetDNSResponse>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Omit tag
              <programlisting>
                <![CDATA[
<m:GetDNSResponse xmlns:m="http://www.onvif.org/ver10/device/wsdl"
  xmlns:m0="http://www.onvif.org/ver10/schema">
  <m:DNSInformation>
    <m0:FromDHCP>false</m0:FromDHCP>
    <m0:DNSManual>
      <m0:Type>IPv4</m0:Type>
    </m0:DNSManual>
  </m:DNSInformation>
</m:GetDNSResponse>]]>
              </programlisting>
            </para>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <!--A.11-->
    <section xml:id="Annex_namespaces_examples">
      <title>Example of Requests for Namespaces Test Cases</title>
      <para>
        For the execution of namespaces test cases, ONVIF Client shall send a request with specific namespaces definition. Examples of how this request shall look like are the following.
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              Defaults Namespaces Definition in Each Tag Examples
            </para>
            <para>
              GetDNS request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header xmlns="http://www.w3.org/2003/05/soap-envelope">
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
      01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken xmlns="http://docs.oasis-open.org/wss/2004/01/
        oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <Username xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd">
           user</Username>
        <Password xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd" Type=
           "http://docs.oasis-open.org/wss/2004/01/oasis-200401-
           wss-username-token-profile-1.0#PasswordDigest">
           5zjIbmvWxVevGlpqg6Qnt9h8Fmo=</Password>
        <Nonce xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd">
           ikcoiK+AmJvA5UpfxTzG8Q==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-utility-1.0.xsd">
           2011-04-25T09:27:48Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body xmlns="http://www.w3.org/2003/05/soap-envelope">
    <GetDNS xmlns="http://www.onvif.org/ver10/device/wsdl" />
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              SetDNS request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header xmlns="http://www.w3.org/2003/05/soap-envelope">
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
      01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken xmlns="http://docs.oasis-open.org/wss/2004/01/
        oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <Username xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd">
           service</Username>
        <Password xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd" Type=
           "http://docs.oasis-open.org/wss/2004/01/oasis-200401-
           wss-username-token-profile-1.0#PasswordDigest">
           znYLkZuoGqC5RrFD4KDs529JvHI=</Password>
        <Nonce xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-secext-1.0.xsd">
           7L0dq2/ZF3zWYEpQpFhcHA==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
           oasis-200401-wss-wssecurity-utility-1.0.xsd">
           2011-04-25T09:27:49Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body xmlns="http://www.w3.org/2003/05/soap-envelope">
    <SetDNS xmlns="http://www.onvif.org/ver10/device/wsdl">
      <FromDHCP xmlns="http://www.onvif.org/ver10/device/wsdl">
         false</FromDHCP>
      <DNSManual xmlns="http://www.onvif.org/ver10/device/wsdl">
        <Type xmlns="http://www.onvif.org/ver10/schema">IPv4</Type>
        <IPv4Address xmlns="http://www.onvif.org/ver10/schema">
          10.1.1.1</IPv4Address>
      </DNSManual>
    </SetDNS>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              GetCapabilities request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header xmlns="http://www.w3.org/2003/05/soap-envelope">
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
	01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken xmlns="http://docs.oasis-open.org/wss/2004/01/
        oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <Username xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-secext-1.0.xsd">
          service</Username>
        <Password xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-secext-1.0.xsd" Type=
          "http://docs.oasis-open.org/wss/2004/01/oasis-200401-
          wss-username-token-profile-1.0#PasswordDigest">
          tg6EnHtyMWW8eUfntHO6XpPjOsg=</Password>
        <Nonce xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-secext-1.0.xsd">
          iBIGpSuHtNPbdSWGzG48ng==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T10:54:34Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body xmlns="http://www.w3.org/2003/05/soap-envelope">
    <GetCapabilities 
      xmlns="http://www.onvif.org/ver10/device/wsdl">
      <Category 
        xmlns="http://www.onvif.org/ver10/device/wsdl">
        Events</Category>
    </GetCapabilities>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              Probe request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header xmlns="http://www.w3.org/2003/05/soap-envelope">
    <MessageID xmlns="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">uuid:9c35aca0-d1cc-41bf-a932-2dd0fe45cc87
      </MessageID>
    <To xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing">
      urn:schemas-xmlsoap-org:ws:2005:04:discovery</To>
    <Action xmlns="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">http://schemas.xmlsoap.org/ws/2005/04/
      discovery/Probe</Action>
  </Header>
  <Body xmlns="http://www.w3.org/2003/05/soap-envelope">
    <Probe xmlns="http://schemas.xmlsoap.org/ws/2005/04/discovery">
      <Types xmlns="http://schemas.xmlsoap.org/ws/2005/04
        /discovery" xmlns:dn="http://www.onvif.org/ver10/
        network/wsdl">dn:NetworkVideoTransmitter</Types>
      <Scopes xmlns="http://schemas.xmlsoap.org/ws/2005/04
        /discovery">onvif://www.onvif.org/type 
        onvif://www.onvif.org/location 
        onvif://www.onvif.org/hardware 
        onvif://www.onvif.org/name</Scopes>
    </Probe>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Defaults Namespaces Definition in Parent Tag Examples
            </para>
            <para>
              GetDNS request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header>
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken>
        <Username>user</Username>
        <Password Type="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">5zjIbmvWxVevGlpqg6Qnt9h8Fmo=</Password>
        <Nonce>ikcoiK+AmJvA5UpfxTzG8Q==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:48Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body>
    <GetDNS xmlns="http://www.onvif.org/ver10/device/wsdl" />
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              SetDNS request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header>
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken>
        <Username>service</Username>
        <Password Type="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">znYLkZuoGqC5RrFD4KDs529JvHI=</Password>
        <Nonce>7L0dq2/ZF3zWYEpQpFhcHA==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:49Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body>
    <SetDNS xmlns="http://www.onvif.org/ver10/device/wsdl">
      <FromDHCP>false</FromDHCP>
      <DNSManual>
        <Type xmlns="http://www.onvif.org/ver10/schema">IPv4</Type>
        <IPv4Address xmlns="http://www.onvif.org/ver10/schema">
          10.1.1.1</IPv4Address>
      </DNSManual>
    </SetDNS>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              GetCapabilities request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header>
    <Security xmlns="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken>
        <Username>service</Username>
        <Password Type="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">tg6EnHtyMWW8eUfntHO6XpPjOsg=</Password>
        <Nonce>iBIGpSuHtNPbdSWGzG48ng==</Nonce>
        <Created xmlns="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T10:54:34Z</Created>
      </UsernameToken>
    </Security>
  </Header>
  <Body>
    <GetCapabilities 
      xmlns="http://www.onvif.org/ver10/device/wsdl">
      <Category>Events</Category>
    </GetCapabilities>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
            <para>
              Probe request example:
              <programlisting>
                <![CDATA[
<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope">
  <Header>
    <MessageID xmlns="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">uuid:9c35aca0-d1cc-41bf-a932-2dd0fe45cc87
      </MessageID>
    <To xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing">
      urn:schemas-xmlsoap-org:ws:2005:04:discovery</To>
    <Action xmlns="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">http://schemas.xmlsoap.org/ws/2005/04/
      discovery/Probe</Action>
  </Header>
  <Body>
    <Probe xmlns="http://schemas.xmlsoap.org/ws/2005/04/discovery">
      <Types xmlns:dn="http://www.onvif.org/ver10/network/wsdl">
        dn:NetworkVideoTransmitter</Types>
      <Scopes>onvif://www.onvif.org/type 
        onvif://www.onvif.org/location 
        onvif://www.onvif.org/hardware 
        onvif://www.onvif.org/name</Scopes>
    </Probe>
  </Body>
</Envelope>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Namespaces Definition with non-Standard Prefixes Examples
            </para>
            <para>
              GetDNS request example:
              <programlisting>
                <![CDATA[
<prefix1:Envelope
  xmlns:prefix1="http://www.w3.org/2003/05/soap-envelope"
  xmlns:prefix2="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-secext-1.0.xsd"
  xmlns:prefix3="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-utility-1.0.xsd"
  xmlns:prefix4="http://www.onvif.org/ver10/device/wsdl">
  <prefix1:Header>
    <prefix2:Security>
      <prefix2:UsernameToken>
        <prefix2:Username>user</prefix2:Username>
        <prefix2:Password Type="http://docs.oasis-open.org/wss/
		2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">5zjIbmvWxVevGlpqg6Qnt9h8Fmo=
          </prefix2:Password>
        <prefix2:Nonce>ikcoiK+AmJvA5UpfxTzG8Q==</prefix2:Nonce>
        <prefix3:Created>2011-04-25T09:27:48Z</prefix3:Created>
      </prefix2:UsernameToken>
    </prefix2:Security>
  </prefix1:Header>
  <prefix1:Body>
    <prefix4:GetDNS/>
  </prefix1:Body>
</prefix1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              SetDNS request example:
              <programlisting>
                <![CDATA[
<prefix2:Envelope
  xmlns:prefix2="http://www.w3.org/2003/05/soap-envelope"
  xmlns:prefix1="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-secext-1.0.xsd"
  xmlns:prefix4="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-utility-1.0.xsd"
  xmlns:prefix3="http://www.onvif.org/ver10/device/wsdl"
  xmlns:wsu="http://www.onvif.org/ver10/schema">
  <prefix2:Header>
    <prefix1:Security>
      <prefix1:UsernameToken>
        <prefix1:Username>service</prefix1:Username>
        <prefix1:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">znYLkZuoGqC5RrFD4KDs529JvHI=
          </prefix1:Password>
        <prefix1:Nonce>7L0dq2/ZF3zWYEpQpFhcHA==</prefix1:Nonce>
        <prefix4:Created>2011-04-25T09:27:49Z</prefix4:Created>
      </prefix1:UsernameToken>
    </prefix1:Security>
  </prefix2:Header>
  <prefix2:Body>
    <prefix3:SetDNS>
      <prefix3:FromDHCP>false</prefix3:FromDHCP>
      <prefix3:DNSManual>
        <wsu:Type>IPv4</wsu:Type>
        <wsu:IPv4Address>10.1.1.1</wsu:IPv4Address>
      </prefix3:DNSManual>
    </prefix3:SetDNS>
  </prefix2:Body>
</prefix2:Envelope>]]>
              </programlisting>
            </para>
            <para>
              GetCapabilities request example:
              <programlisting>
                <![CDATA[
<prefix1:Envelope
  xmlns:prefix4="http://www.onvif.org/ver10/device/wsdl"
  xmlns:prefix3="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-utility-1.0.xsd"
  xmlns:prefix1="http://www.w3.org/2003/05/soap-envelope"
  xmlns:prefix2="http://docs.oasis-open.org/wss/2004/01/
    oasis-200401-wss-wssecurity-secext-1.0.xsd">
  <prefix1:Header>
    <prefix2:Security>
      <prefix2:UsernameToken>
        <prefix2:Username>service</prefix2:Username>
        <prefix2:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">tg6EnHtyMWW8eUfntHO6XpPjOsg=
          </prefix2:Password>
        <prefix2:Nonce>iBIGpSuHtNPbdSWGzG48ng==</prefix2:Nonce>
        <prefix3:Created>2011-04-25T10:54:34Z</prefix3:Created>
      </prefix2:UsernameToken>
    </prefix2:Security>
  </prefix1:Header>
  <prefix1:Body>
    <prefix4:GetCapabilities>
      <prefix4:Category>Events</prefix4:Category>
    </prefix4:GetCapabilities>
  </prefix1:Body>
</prefix1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              Probe request example:
              <programlisting>
                <![CDATA[
<prefix2:Envelope
  xmlns:prefix1="http://www.onvif.org/ver10/network/wsdl"
  xmlns:prefix2="http://www.w3.org/2003/05/soap-envelope"
  xmlns:prefix3="http://schemas.xmlsoap.org/ws/2004/08/addressing"
  xmlns:prefix4="http://schemas.xmlsoap.org/ws/2005/04/discovery">
  <prefix2:Header>
    <prefix3:MessageID>uuid:9c35aca0-d1cc-41bf-a932-2dd0fe45cc87
      </prefix3:MessageID>
    <prefix3:To>urn:schemas-xmlsoap-org:ws:2005:04:discovery
      </prefix3:To>
    <prefix3:Action>http://schemas.xmlsoap.org/ws/2005/04/
      discovery/Probe</prefix3:Action>
  </prefix2:Header>
  <prefix2:Body>
    <prefix4:Probe>
      <prefix4:Types>prefix1:NetworkVideoTransmitter
        </prefix4:Types>
      <prefix4:Scopes>onvif://www.onvif.org/type 
        onvif://www.onvif.org/location 
        onvif://www.onvif.org/hardware 
        onvif://www.onvif.org/name</prefix4:Scopes>
    </prefix4:Probe>
  </prefix2:Body>
</prefix2:Envelope>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Namespaces Definition with Different Prefixes for the Same Namespace Examples
            </para>
            <para>
              GetDNS request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p2:Header xmlns:p2="http://www.w3.org/2003/05/soap-envelope">
    <p3:Security xmlns:p3="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <p4:UsernameToken xmlns:p4="http://docs.oasis-open.org/wss/
        2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <p5:Username xmlns:p5="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">user
          </p5:Username>
        <p6:Password xmlns:p6="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" Type
          ="http://docs.oasis-open.org/wss/2004/01/oasis-200401-
          wss-username-token-profile-1.0#PasswordDigest">
          5zjIbmvWxVevGlpqg6Qnt9h8Fmo=</p6:Password>
        <p7:Nonce xmlns:p7="http://docs.oasis-open.org/wss/2004/01/
          oasis-200401-wss-wssecurity-secext-1.0.xsd">
          ikcoiK+AmJvA5UpfxTzG8Q==</p7:Nonce>
        <p8:Created xmlns:p8="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:48Z</p8:Created>
      </p4:UsernameToken>
    </p3:Security>
  </p2:Header>
  <p9:Body xmlns:p9="http://www.w3.org/2003/05/soap-envelope">
    <p10:GetDNS xmlns:p10=
      "http://www.onvif.org/ver10/device/wsdl" />
  </p9:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              SetDNS request example:
              <programlisting>
                <![CDATA[
<q1:Envelope xmlns:q1="http://www.w3.org/2003/05/soap-envelope">
  <q2:Header xmlns:q2="http://www.w3.org/2003/05/soap-envelope">
    <q3:Security xmlns:q3="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <q4:UsernameToken xmlns:q4="http://docs.oasis-open.org/wss/
        2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <q3:Username>service</q3:Username>
        <q4:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">znYLkZuoGqC5RrFD4KDs529JvHI=
          </q4:Password>
        <q3:Nonce>7L0dq2/ZF3zWYEpQpFhcHA==</q3:Nonce>
        <q5:Created xmlns:q5="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:49Z</q5:Created>
      </q4:UsernameToken>
    </q3:Security>
  </q2:Header>
  <q1:Body>
    <q6:SetDNS xmlns:q6="http://www.onvif.org/ver10/device/wsdl">
      <q7:FromDHCP xmlns:q7="http://www.onvif.org/ver10/
        device/wsdl">false</q7:FromDHCP>
      <q6:DNSManual>
        <q8:Type xmlns:q8="http://www.onvif.org/ver10/schema">
          IPv4</q8:Type>
        <q9:IPv4Address 
          xmlns:q9="http://www.onvif.org/ver10/schema">
          10.1.1.1</q9:IPv4Address>
      </q6:DNSManual>
    </q6:SetDNS>
  </q1:Body>
</q1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              GetCapabilities request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p2:Header xmlns:p2="http://www.w3.org/2003/05/soap-envelope">
    <p4:Security xmlns:p4="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <p5:UsernameToken xmlns:p5="http://docs.oasis-open.org/wss/
        2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <p6:Username xmlns:p6="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
          service</p6:Username>
        <p7:Password xmlns:p7="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" Type
          ="http://docs.oasis-open.org/wss/2004/01/oasis-200401-
          wss-username-token-profile-1.0#PasswordDigest">
          tg6EnHtyMWW8eUfntHO6XpPjOsg=</p7:Password>
        <p8:Nonce xmlns:p8="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
          iBIGpSuHtNPbdSWGzG48ng==</p8:Nonce>
        <p9:Created xmlns:p9="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T10:54:34Z</p9:Created>
      </p5:UsernameToken>
    </p4:Security>
  </p2:Header>
  <p3:Body xmlns:p3="http://www.w3.org/2003/05/soap-envelope">
    <p10:GetCapabilities 
      xmlns:p10="http://www.onvif.org/ver10/device/wsdl">
      <p11:Category xmlns:p11="http://www.onvif.org/ver10/
        device/wsdl">Events</p11:Category>
    </p10:GetCapabilities>
  </p3:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              Probe request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p2:Header xmlns:p2="http://www.w3.org/2003/05/soap-envelope">
    <p3:MessageID xmlns:p3="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">uuid:9c35aca0-d1cc-41bf-a932-2dd0fe45cc87
      </p3:MessageID>
    <p4:To xmlns:p4="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">urn:schemas-xmlsoap-org:ws:2005:04:discovery
      </p4:To>
    <p5:Action xmlns:p5="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">http://schemas.xmlsoap.org/ws/2005/04/
      discovery/Probe</p5:Action>
  </p2:Header>
  <p6:Body xmlns:p6="http://www.w3.org/2003/05/soap-envelope">
    <p7:Probe xmlns:p7="http://schemas.xmlsoap.org/ws/2005/04/
      discovery">
      <p8:Types xmlns:p8="http://schemas.xmlsoap.org/ws/2005/04/
        discovery" xmlns:dn="http://www.onvif.org/ver10/
        network/wsdl">dn:NetworkVideoTransmitter</p8:Types>
      <p9:Scopes xmlns:p9="http://schemas.xmlsoap.org/ws/2005/04/
        discovery">onvif://www.onvif.org/type 
        onvif://www.onvif.org/location
        onvif://www.onvif.org/hardware 
        onvif://www.onvif.org/name</p9:Scopes>
    </p7:Probe>
  </p6:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
          </listitem>
          <listitem>
            <para>
              Namespaces Definition with the Same Prefixes for Different Namespaces Examples
            </para>
            <para>
              GetDNS request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p1:Header>
    <p1:Security xmlns:p1="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <p1:UsernameToken>
        <p1:Username>user</p1:Username>
        <p1:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">5zjIbmvWxVevGlpqg6Qnt9h8Fmo=
          </p1:Password>
        <p1:Nonce>ikcoiK+AmJvA5UpfxTzG8Q==</p1:Nonce>
        <p1:Created xmlns:p1="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:48Z</p1:Created>
      </p1:UsernameToken>
    </p1:Security>
  </p1:Header>
  <p1:Body>
    <p1:GetDNS xmlns:p1="http://www.onvif.org/ver10/device/wsdl" />
  </p1:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              SetDNS request example:
              <programlisting>
                <![CDATA[
<q1:Envelope xmlns:q1="http://www.w3.org/2003/05/soap-envelope">
  <q1:Header>
    <q1:Security xmlns:q1="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <q1:UsernameToken>
        <q1:Username>service</q1:Username>
        <q1:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">znYLkZuoGqC5RrFD4KDs529JvHI=
          </q1:Password>
        <q1:Nonce>7L0dq2/ZF3zWYEpQpFhcHA==</q1:Nonce>
        <q1:Created xmlns:q1="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T09:27:49Z</q1:Created>
      </q1:UsernameToken>
    </q1:Security>
  </q1:Header>
  <q1:Body>
    <q1:SetDNS xmlns:q1="http://www.onvif.org/ver10/device/wsdl">
      <q1:FromDHCP>false</q1:FromDHCP>
      <q1:DNSManual>
        <q1:Type xmlns:q1="http://www.onvif.org/ver10/schema">
          IPv4</q1:Type>
        <q1:IPv4Address xmlns:q1="http://www.onvif.org/ver10/
          schema">10.1.1.1</q1:IPv4Address>
      </q1:DNSManual>
    </q1:SetDNS>
  </q1:Body>
</q1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              GetCapabilities request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p1:Header>
    <p1:Security xmlns:p1="http://docs.oasis-open.org/wss/2004/
	  01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <p1:UsernameToken>
        <p1:Username>service</p1:Username>
        <p1:Password Type="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-username-token-profile-1.0
          #PasswordDigest">tg6EnHtyMWW8eUfntHO6XpPjOsg=
          </p1:Password>
        <p1:Nonce>iBIGpSuHtNPbdSWGzG48ng==</p1:Nonce>
        <p1:Created xmlns:p1="http://docs.oasis-open.org/wss/
          2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
          2011-04-25T10:54:34Z</p1:Created>
      </p1:UsernameToken>
    </p1:Security>
  </p1:Header>
  <p1:Body>
    <p1:GetCapabilities 
      xmlns:p1="http://www.onvif.org/ver10/device/wsdl">
      <p1:Category>Events</p1:Category>
    </p1:GetCapabilities>
  </p1:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
            <para>
              Probe request example:
              <programlisting>
                <![CDATA[
<p1:Envelope xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
  <p1:Header xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
    <p1:MessageID xmlns:p1="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">uuid:9c35aca0-d1cc-41bf-a932-2dd0fe45cc87
      </p1:MessageID>
    <p1:To xmlns:p1="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">urn:schemas-xmlsoap-org:ws:2005:04:discovery
      </p1:To>
    <p1:Action xmlns:p1="http://schemas.xmlsoap.org/ws/2004/08/
      addressing">http://schemas.xmlsoap.org/ws/2005/04/
      discovery/Probe</p1:Action>
  </p1:Header>
  <p1:Body xmlns:p1="http://www.w3.org/2003/05/soap-envelope">
    <p1:Probe 
      xmlns:p1="http://schemas.xmlsoap.org/ws/2005/04/discovery">
      <p1:Types xmlns:p1="http://schemas.xmlsoap.org/ws/2005/04/
        discovery" xmlns:dn="http://www.onvif.org/ver10/
        network/wsdl">dn:NetworkVideoTransmitter</p1:Types>
      <p1:Scopes xmlns:p1="http://schemas.xmlsoap.org/ws/2005/04/
        discovery">onvif://www.onvif.org/type 
        onvif://www.onvif.org/location 
        onvif://www.onvif.org/hardware
        onvif://www.onvif.org/name</p1:Scopes>
    </p1:Probe>
  </p1:Body>
</p1:Envelope>]]>
              </programlisting>
            </para>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <!--A.12-->
    <section xml:id="Annex_HelperTurnOnIPv4DHCP">
      <title>Procedure to Turn On IPv4 DHCP</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperTurnOnIPv4DHCP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to turn on IPv4 DHCP.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Network Configuration is supported. Discovery is supported.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Original default network settings (<emphasis role="italic">defaultNetworkSettings</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">defaultNetworkSettings</emphasis> := current interface from <emphasis role="italic">networkInterfacesList</emphasis>.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv4.Config.DHCP = false:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Enabled skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Link skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.MTU skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.Enabled := true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.Manual skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.DHCP := true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6 skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Extension - skipped
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">rebootNeeded</emphasis> = true:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                          <itemizedlist>
                            <listitem>
                              <para>
                                Message
                              </para>
                            </listitem>
                          </itemizedlist>
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT sends <emphasis role="bold">Hello</emphasis> message from the default network interface.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.13-->
    <section xml:id="Annex_HelperTurnOffIPv4DHCP">
      <title>Procedure to Turn Off IPv4 DHCP</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperTurnOffIPv4DHCP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to turn off IPv4 DHCP.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Network Configuration is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Original default network settings (<emphasis role="italic">defaultNetworkSettings</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">defaultNetworkSettings</emphasis> := current interface from <emphasis role="italic">networkInterfacesList</emphasis>.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv4.Config.DHCP = true:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Enabled skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Link skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.MTU skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.Enabled := true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.Manual.Address := current IPv4 address of the DUT
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.Manual.PrefixLength := current IPv4 prefix of the DUT
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4.DHCP := false
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6 skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Extension skipped
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">rebootNeeded</emphasis> = true:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                          <itemizedlist>
                            <listitem>
                              <para>
                                Message
                              </para>
                            </listitem>
                          </itemizedlist>
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If DUT supports Discovery:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          The DUT sends <emphasis role="bold">Hello</emphasis> message from the default network interface during <emphasis role="italic">rebootTimeout</emphasis>.
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If DUT does not support Discovery:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis> if Discovery is supported.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.14-->
    <section xml:id="Annex_HelperTurnOnIPv6DHCP">
      <title>Procedure to Turn On IPv6 DHCP</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperTurnOnIPv6DHCP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to turn on IPv6 DHCP.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> IPv6 is supported. Network Configuration is supported. Discovery is supported.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Original default network settings (<emphasis role="italic">defaultNetworkSettings</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList</emphasis> with IPv6 support.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv6.Config.DHCP = Off:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Enabled = true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Link skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.MTU skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4 skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.Enabled := true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.AcceptRouterAdvert skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.Manual skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.DHCP := Auto
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Extension - skipped
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">rebootNeeded</emphasis> = true:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                          <itemizedlist>
                            <listitem>
                              <para>
                                Message
                              </para>
                            </listitem>
                          </itemizedlist>
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT sends <emphasis role="bold">Hello</emphasis> message from the default network interface.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.15-->
    <section xml:id="Annex_HelperTurnOffIPv6DHCP">
      <title>Procedure to Turn Off IPv6 DHCP</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperTurnOffIPv6DHCP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to turn off IPv6 DHCP.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> IPv6 is supported by DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Original default network settings (<emphasis role="italic">defaultNetworkSettings</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetNetworkInterfaces</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkInterfaces list =: <emphasis role="italic">networkInterfacesList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">defaultNetworkSettings</emphasis> := interface from <emphasis role="italic">networkInterfacesList</emphasis> with IPv6 support.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv6.Config.DHCP != Off:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">SetNetworkInterfaces</emphasis> request with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          InterfaceToken := <emphasis role="italic">defaultNetworkSettings</emphasis>.@token
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Enabled = true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Link skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.MTU skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv4 skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.Enabled := true
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.AcceptRouterAdvert skipped
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          If <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv6.Config.FromDHCP is specified:
                          <itemizedlist>
                            <listitem>
                              <para>
                                NetworkInterface.IPv6.Manual := <emphasis role="italic">defaultNetworkSettings</emphasis>.IPv6.Config.FromDHCP
                              </para>
                            </listitem>
                          </itemizedlist>
                        </para>
                        <para>otherwise NetworkInterface.IPv6.Manual skipped.</para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.IPv6.DHCP := Auto
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          NetworkInterface.Extension - skipped
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          RebootNeeded =: <emphasis role="italic">rebootNeeded</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">rebootNeeded</emphasis> = true:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client invokes <emphasis role="bold">SystemReboot</emphasis> request.
                        </para>
                      </listitem>
                      <listitem>
                        <para>
                          The DUT responds with <emphasis role="bold">SystemRebootResponse</emphasis> message with parameters
                          <itemizedlist>
                            <listitem>
                              <para>
                                Message
                              </para>
                            </listitem>
                          </itemizedlist>
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If DUT supports Discovery:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          The DUT sends <emphasis role="bold">Hello</emphasis> message from the default network interface during <emphasis role="italic">rebootTimeout</emphasis>.
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If DUT does not support Discovery:
                    <orderedlist numeration="arabic" inheritnum="inherit">
                      <?dbfo label-width="3.5em"?>
                      <listitem>
                        <para>
                          ONVIF Client waits during <emphasis role="italic">rebootTimeout</emphasis>.
                        </para>
                      </listitem>
                    </orderedlist>
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkInterfacesResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SystemRebootResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">Hello</emphasis> message during <emphasis role="italic">rebootTimeout</emphasis>.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">rebootTimeout</emphasis> will be taken from Reboot Timeout field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.16 (old A.18)-->
    <section xml:id="Annex_name_max_len">
      <title>Name and Token Parameters Maximum Length</title>
      <para>
        There are the following limitations on maximum length of Name and Token parameters that shall be used during tests by ONVIF Device Test Tool to prevent faults from the DUT:
        <itemizedlist>
          <listitem>
            <para>
              Name shall be less than or equal to 64 characters (only readable characters are accepted).
            </para>
          </listitem>
          <listitem>
            <para>
              Token shall be less than or equal to 64 characters (only readable characters are accepted).
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        UTF-8 character set shall be used for Name and Token.
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> these limitations will not be used if ONVIF Device Test Tool re-uses values that were received from the DUT.
      </para>
    </section>
    <!--A.17 (old A.20)-->
    <section xml:id="Annex_HelperTooManyUsersFaultCheck">
      <title>TooManyUsers Fault Check</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperTooManyUsersFaultCheck
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to check if the DUT correctly returns TooManyUsers fault to CreateUsers request.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> Current number of users (<emphasis role="italic">usersNumber</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              If DUT does not support GetServices, skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Capabilities =: <emphasis role="italic">capabilities</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">capabilities</emphasis>.Security.MaxUsers is not specified, skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">capabilities</emphasis>.Security.MaxUsers != <emphasis role="italic">usersNumber</emphasis>, FAIL the test and skip other steps.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.18 (old A.21)-->
    <section xml:id="Annex_HelperGetServiceCapabilities">
      <title>Get Service Capabilities (Device Management)</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperGetServiceCapabilities
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to retrieve Device Management Service Capabilities.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> GetServices command is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Device Management Service Capabilities (<emphasis role="italic">cap</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Capabilities =: <emphasis role="italic">cap</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.19 (old A.22)-->
    <section xml:id="Annex_HelperGetDeviceCapabilities">
      <title>Get Capabilities (Device Management)</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperGetDeviceCapabilities
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to retrieve Device Management Capabilities.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> GetCapabilities command is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Device Management Capabilities (<emphasis role="italic">deviceManagementCap</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetCapabilities</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetCapabilitiesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Capabilities =: <emphasis role="italic">cap</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">deviceManagementCap</emphasis> := <emphasis role="italic">cap</emphasis>.Device.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetCapabilitiesResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.20 (old A.23)-->
    <section xml:id="Annex_HelperRestoreSystemDateAndTime">
      <title>Restoring System Date and Time</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperRestoreSystemDateAndTime
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to restoring System Date and Time.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> The SystemDateAndTime (<emphasis role="italic">initialSystemDateAndTime</emphasis>) to restore.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">SetSystemDateAndTime</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    DateTimeType := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DataTimeType
                  </para>
                </listitem>
                <listitem>
                  <para>
                    DaylightSavings := <emphasis role="italic">initialSystemDateAndTime</emphasis>.DaylightSavings
                  </para>
                </listitem>
                <listitem>
                  <para>
                    TimeZone := <emphasis role="italic">initialSystemDateAndTime</emphasis>.TimeZone
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">initialSystemDateAndTime</emphasis>.DataTimeType = Manual:
                    <itemizedlist>
                      <listitem>
                        <para>
                          UTCDateTime := current UTC date and dime
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                  <para>
                    otherwise <emphasis role="italic">initialSystemDateAndTime</emphasis>.DataTimeType skipped.
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetSystemDateAndTimeResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.21 (old A.24)-->
    <section xml:id="Annex_HelperSetNTP">
      <title>Set NTP Settings</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperSetNTP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to configure DUT with proper NTP server.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> NTP is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">SetNTP</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    FromDHCP := false
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual[0].Type := IPv4
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual[0].IPv4Address := <emphasis role="italic">validNTPServerAaddress</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual[0].IPv6Address skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual[0].DNSname skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual[0].Extension skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">SetNTPResponse</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNTPResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">validNTPServerAaddress</emphasis> will be taken from NTP IPv4 field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.22 (old A.25)-->
    <section xml:id="Annex_HelperRestoreNTP">
      <title>Restoring NTP Settings</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperRestoreNTP
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to restoring NTP settings.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> NTP is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> The initial NTP settings (<emphasis role="italic">initialNTPInformation</emphasis>) to restore.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">SetNTP</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    FromDHCP := <emphasis role="italic">initialNTPInformation</emphasis>.FromDHCP
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NTPManual := <emphasis role="italic">initialNTPInformation</emphasis>.NTPManual
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">SetNTPResponse</emphasis> message.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNTPResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">validNTPServerAaddress</emphasis> will be taken from NTP IPv4 field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.23-->
    <section xml:id="Annex_HelperCheckXAddr" xreflabel="Annex A.23">
      <title>Check XAddr</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperCheckXAddr
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to check XAddr uri.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> XAddr to check (<emphasis role="italic">xAddr</emphasis>), expected Uri Scheme (<emphasis role="italic">uriScheme</emphasis>), expected Uri host (<emphasis role="italic">uriHost</emphasis>), expected Uri host port (<emphasis role="italic">uriHostPort</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              If <emphasis role="italic">xAddr</emphasis> uri scheme part is not equal to <emphasis role="italic">uriScheme</emphasis>, FAIL the test and skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">xAddr</emphasis> uri does not contain authority component, FAIL the test and skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              If host subcomponent of authority component of <emphasis role="italic">xAddr</emphasis> uri is not equal to <emphasis role="italic">uriHost</emphasis>, FAIL the test and skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">xAddrHostport</emphasis>:= hostport subcomponent of authority component of <emphasis role="italic">xAddr</emphasis> uri.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">xAddrHostport</emphasis> is skipped
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    If <emphasis role="italic">uriScheme</emphasis> = "http", set <emphasis role="italic">xAddrHostport</emphasis> := 80.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">uriScheme</emphasis> = "https", set <emphasis role="italic">xAddrHostport</emphasis> := 443.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">xAddrHostport</emphasis> is not equal to <emphasis role="italic">uriHostPort</emphasis>, FAIL the test and skip other steps.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              None.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> see [RFC3986] for details of uri syntax.
      </para>
    </section>
    <!--A.24-->
    <section xml:id="Annex_HelperCheckAndConfigureHTTPS" xreflabel="Annex A.24">
      <title>Configuring HTTPS if Required</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperCheckAndConfigureHTTPS
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper Procedure to check and configure HTTPS using Security Configuration if required.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> HTTPS feature is supported by DUT. HTTPS is configured on the DUT, if TLS Server is not supported by DUT. Security Configuration Service is received from the DUT, if TLS Server is supported by DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetNetworkProtocols</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkProtocols list =: <emphasis role="italic">networkProtocolsList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">networkProtocolsList</emphasis> contains item with Name = HTTPS and Enabled = true, return to the test and skip other procedure steps.
            </para>
          </listitem>
          <listitem>
            <para>
              If the DUT does not support TLS Server, FAIL the test and skip other steps.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client configures HTTPS by following the procedure mentioned in <xref linkend="Annex_HelperConfigureHTTPS"/>.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetNetworkProtocolsResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.25-->
    <section xml:id="Annex_HelperConfigureHTTPS" xreflabel="Annex A.25">
      <title>Configuring HTTPS using Security Configuration Service</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperConfigureHTTPS
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper Procedure to configure HTTPS using Security Configuration Service.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Security Configuration Service is received from the DUT. TLS Server is supported by the DUT.
        The DUT shall have enough free storage capacity for one additional RSA key pair.
        The DUT shall have enough free storage capacity for one additional certificate.
        The DUT shall have enough free storage capacity for one additional certification path.
        The DUT shall have enough free storage capacity for one additional server certificate assignment.
        Current time of the DUT shall be at least Jan 01, 1970.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetAssignedServerCertificates</emphasis>.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with a <emphasis role="bold">GetAssignedServerCertificatesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificationPathID list =: <emphasis role="italic">initialCertificationPathList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If number of items in <emphasis role="italic">initialCertificationPathList</emphasis> >= 1, go to the step <xref linkend="Annex_HelperConfigureHTTPS.3"/>.
            </para>
          </listitem>
          <listitem>
            <para>
              If Create self-signed certificate is supported by the DUT:
              <orderedlist  numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client adds server certification assignment and creates related certification path, the self-signed certificate and the RSA key pair by following the procedure mentioned in <xref linkend="Annex_HelperAddServerCertAssign_SSCertificate"/>.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Go to the step <xref linkend="Annex_HelperConfigureHTTPS.3"/>.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client creates a certification path based on CA-signed certificate and related RSA key pair and a corresponding CA certificate and related RSA key pair by following the procedure mentioned in <xref linkend="Annex_HelperAddServerCertAssign_CACertificate"/>.
            </para>
          </listitem>
          <listitem xml:id="Annex_HelperConfigureHTTPS.3">
            <para>
              ONVIF Client invokes <emphasis role="bold">SetNetworkProtocols</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    NetworkProtocols[0].Name := HTTPS
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkProtocols[0].Enabled := true
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkProtocols[0].Port := 443
                  </para>
                </listitem>
                <listitem>
                  <para>
                    NetworkProtocols[0].Extension skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">SetNetworkProtocolsResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits until <emphasis role="italic">operationDelay</emphasis> timeout expires.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client checks that HTTPS protocol Port 443 is open. If HTTPS protocol port 443 is not open, FAIL the test and skip other steps.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetNetworkProtocolsResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">operationDelay</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.26-->
    <section xml:id="Annex_HelperAddServerCertAssign_SSCertificate" xreflabel="Annex A.26">
      <title>Add server certificate assignment with corresponding certification path, self-signed certificate and RSA key pair</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperAddServerCertAssign_SSCertificate
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper Procedure to configure HTTPS using Security Configuration Service.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Security Configuration Service is received from the DUT. TLS Server is supported by the DUT.
        Create self-signed certificate is supported by the DUT. RSA key pair generation is supported by the DUT.
        The DUT shall have enough free storage capacity for one additional RSA key pair.
        The DUT shall have enough free storage capacity for one additional certificate.
        The DUT shall have enough free storage capacity for one additional certification path.
        The DUT shall have enough free storage capacity for one additional server certificate assignment.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> The identifiers of the new certification path (<emphasis role="italic">certPathID</emphasis>), certificate (<emphasis role="italic">certID</emphasis>) and RSA key pair (<emphasis role="italic">keyID</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client creates an RSA key pair by following the procedure mentioned in <xref linkend="Annex_HelperCreateRSAKeyPair"/> with the following input and output parameters
              <itemizedlist>
                <listitem>
                  <para>
                    out <emphasis role="italic">keyID</emphasis> - RSA key pair
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">CreateSelfSignedCertificate</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    X509Version skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    KeyID := <emphasis role="italic">keyID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Subject := subject (see <xref linkend="Annex_HelperSubjectForServerCertificate"/>)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Alias skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    notValidBefore skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    notValidAfter skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    SignatureAlgorithm.algorithm := 1.2.840.113549.1.1.5 (OID of SHA-1 with RSA Encryption algorithm)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    SignatureAlgorithm.parameters skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    SignatureAlgorithm.anyParameters skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Extension skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with a <emphasis role="bold">CreateSelfSignedCertificateResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificateID =: <emphasis role="italic">certID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">CreateCertificationPath</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertficateIDs.CertificateID[0] := <emphasis role="italic">certID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Alias := "ONVIF_Test"
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with a <emphasis role="bold">CreateCertificationPathResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificationPathID =: <emphasis role="italic">certPathID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">AddServerCertificateAssignment</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificationPathID := <emphasis role="italic">certPathID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with an <emphasis role="bold">AddServerCertificateAssignmentResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for time <emphasis role="italic">operationDelay</emphasis>.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">CreateSelfSignedCertificateResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">CreateCertificationPathResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">AddServerCertificateAssignmentResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">operationDelay</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.27-->
    <section xml:id="Annex_HelperAddServerCertAssign_CACertificate" xreflabel="Annex A.27">
      <title>Add server certificate assignment with corresponding certification path, CA certificate and RSA key pair</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperAddServerCertAssign_CACertificate
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper Procedure to configure HTTPS using Security Configuration Service.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Security Configuration Service is received from the DUT. TLS Server is supported by the DUT.
        Create PCKS#10 supported by the DUT. RSA key pair generation is supported by the DUT.
        The DUT shall have enough free storage capacity for one additional RSA key pair.
        The DUT shall have enough free storage capacity for one additional certificate.
        The DUT shall have enough free storage capacity for one additional certification path.
        The DUT shall have enough free storage capacity for one additional server certificate assignment.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> The identifiers of the new certification path (<emphasis role="italic">certPathID</emphasis>), certificate (<emphasis role="italic">certID</emphasis>) and RSA key pair (<emphasis role="italic">keyID</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client creates an RSA key pair by following the procedure mentioned in <xref linkend="Annex_HelperCreateRSAKeyPair"/> with the following input and output parameters
              <itemizedlist>
                <listitem>
                  <para>
                    out <emphasis role="italic">keyID</emphasis> - RSA key pair
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">CreatePKCS10CSR</emphasis> with parameter
              <itemizedlist>
                <listitem>
                  <para>
                    Subject := subject (see <xref linkend="Annex_HelperSubjectForServerCertificate"/>)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    KeyID := <emphasis role="italic">keyID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    CSRAttribute skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    SignatureAlgorithm.algorithm := 1.2.840.113549.1.1.5 (OID of SHA-1 with RSA Encryption algorithm)
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">CreatePKCS10CSRResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    PKCS10CSR =: <emphasis role="italic">pkcs10</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client creates an CA certificate by following the procedure mentioned in <xref linkend="Annex_HelperCreateCACertificate"/> with the following input and output parameters
              <itemizedlist>
                <listitem>
                  <para>
                    out <emphasis role="italic">CAcert</emphasis> - CA certificate
                  </para>
                </listitem>
                <listitem>
                  <para>
                    out <emphasis role="italic">privateKey</emphasis> - private key for the CA certificate
                  </para>
                </listitem>
                <listitem>
                  <para>
                    out <emphasis role="italic">publicKey</emphasis> - public key for the CA certificate
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Create an [RFC5280] compliant X.509 certificate (<emphasis role="italic">cert</emphasis>) from the PKCS#10 request (<emphasis role="italic">pkcs10</emphasis>) with the following properties:
              <itemizedlist>
                <listitem>
                  <para>
                    version:= v3
                  </para>
                </listitem>
                <listitem>
                  <para>
                    signature := sha1-WithRSAEncryption
                  </para>
                </listitem>
                <listitem>
                  <para>
                    subject := subject from the PKCS#10 request (<emphasis role="italic">pkcs10</emphasis>)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    subject public key := subject public key in the PKCS#10 request (<emphasis role="italic">pkcs10</emphasis>)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    validity := not before 19700101000000Z and not after 99991231235959Z
                  </para>
                </listitem>
                <listitem>
                  <para>
                    certificate signature is generated with the private key (<emphasis role="italic">privateKey</emphasis>) in the CA certificate (<emphasis role="italic">CAcert</emphasis>)
                  </para>
                </listitem>
                <listitem>
                  <para>
                    certificate extensions := the X.509v3 extensions from the PKCS#10 request (<emphasis role="italic">pkcs10</emphasis>)
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">UploadCertificate</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Certificate := <emphasis role="italic">cert</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Alias := "ONVIF_Test1"
                  </para>
                </listitem>
                <listitem>
                  <para>
                    PrivateKeyRequired := true
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with a <emphasis role="bold">UploadCertificateResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificateID =: <emphasis role="italic">certID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    KeyID =: <emphasis role="italic">keyID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">CreateCertificationPath</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertficateIDs.CertificateID[0] := <emphasis role="italic">certID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    Alias := "ONVIF_Test2"
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with a <emphasis role="bold">CreateCertificationPathResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificationPathID =: <emphasis role="italic">certPathID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">AddServerCertificateAssignment</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    CertificationPathID := <emphasis role="italic">certPathID</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with an <emphasis role="bold">AddServerCertificateAssignmentResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client waits for time <emphasis role="italic">operationDelay</emphasis>.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">CreatePKCS10CSRResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">UploadCertificateResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">CreateCertificationPathResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">AddServerCertificateAssignmentResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">operationDelay</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.28-->
    <section xml:id="Annex_HelperCreateRSAKeyPair" xreflabel="Annex A.28">
      <title>Create an RSA key pair</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperCreateRSAKeyPair
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to create an RSA key pair.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Security Configuration Service is received from the DUT. RSA key pair generation is supported by the DUT.
        The DUT shall have enough free storage capacity for one additional RSA key pair.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> The identifier of the new and RSA key pair (<emphasis role="italic">keyID</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetServiceCapabilities</emphasis> request.
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Capabilities =: <emphasis role="italic">cap</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              Set <emphasis role="italic">keyLength</emphasis> := the smallest supported key length at <emphasis role="italic">cap</emphasis>.RSAKeyLengths.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">CreateRSAKeyPair</emphasis> with parameter
              <itemizedlist>
                <listitem>
                  <para>
                    KeyLength := <emphasis role="italic">length</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">CreateRSAKeyPairResponse</emphasis> message with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    KeyID =: <emphasis role="italic">keyID</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    EstimatedCreationTime =: <emphasis role="italic">duration</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem xml:id="Annex_HelperCreateRSAKeyPair.6">
            <para>
              Until <emphasis role="italic">duration</emphasis> + <emphasis role="italic">operationDelay</emphasis> expires repeat the following steps:
              <orderedlist numeration="arabic" inheritnum="inherit">
                <?dbfo label-width="2.5em"?>
                <listitem>
                  <para>
                    ONVIF Client waits for 5 seconds.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    ONVIF Client invokes <emphasis role="bold">GetKeyStatus</emphasis> with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          KeyID := <emphasis role="italic">keyID</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    The DUT responds with <emphasis role="bold">GetKeyStatusResponse</emphasis> message with parameters
                    <itemizedlist>
                      <listitem>
                        <para>
                          KeyStatus =: <emphasis role="italic">keyStatus</emphasis>
                        </para>
                      </listitem>
                    </itemizedlist>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">keyStatus</emphasis> is equal to "ok", skip other steps of the procedure.
                  </para>
                </listitem>
                <listitem>
                  <para>
                    If <emphasis role="italic">keyStatus</emphasis> is equal to "corrupt", FAIL the test and skip other steps.
                  </para>
                </listitem>
              </orderedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">duration</emphasis> + <emphasis role="italic">operationDelay</emphasis> expires for step <xref linkend="Annex_HelperCreateRSAKeyPair.6"/> and the last <emphasis role="italic">keyStatus</emphasis> is other than "ok", FAIL the test and skip other steps.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetKeyStatusResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">CreateRSAKeyPairResponse</emphasis> message.
            </para>
          </listitem>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetServiceCapabilitiesResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> <emphasis role="italic">operationDelay</emphasis> will be taken from Operation Delay field of ONVIF Device Test Tool.
      </para>
    </section>
    <!--A.29-->
    <section xml:id="Annex_HelperSubjectForServerCertificate" xreflabel="Annex A.29">
      <title>Subject for a server certificate</title>
      <para>
        Use the following subject for test cases:
        <itemizedlist>
          <listitem>
            <para>
              Subject.Country := "US"
            </para>
          </listitem>
          <listitem>
            <para>
              Subject.CommonName := DUT IP-address
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <!--A.30-->
    <section xml:id="Annex_HelperCreateCACertificate" xreflabel="Annex A.30">
      <title>Provide CA certificate</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperCreateCACertificate
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to create an X.509 CA certificate.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> The subject (<emphasis role="italic">subject</emphasis>) of certificate(optional input parameter, could be skipped).
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> An X.509 CA certificate (<emphasis role="italic">CAcert</emphasis>) that is compliant to [RFC5280] and a corresponding private key (<emphasis role="italic">privateKey</emphasis>) and public key (<emphasis role="italic">publicKey</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client determines the length of the key to generate (out <emphasis role="italic">length</emphasis>) by following the procedure mentioned in <xref linkend="Annex_HelperDetermineRSAKeyLength"/>.
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">subject</emphasis> is skipped set:
              <itemizedlist>
                <listitem>
                  <para>
                    <emphasis role="italic">subject</emphasis> := "CN=ONVIF TT,C=US"

                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client creates an X.509 self-signed CA certificate that is compliant to [RFC5280] and has the following properties:
              <itemizedlist>
                <listitem>
                  <para>
                    version := v3
                  </para>
                </listitem>
                <listitem>
                  <para>
                    signature := sha1-WithRSAEncryption
                  </para>
                </listitem>
                <listitem>
                  <para>
                    validity := not before 19700101000000Z and not after 99991231235959Z
                  </para>
                </listitem>
                <listitem>
                  <para>
                    subject := <emphasis role="italic">subject</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    length of the key to be used := <emphasis role="italic">length</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              None.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              None.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">Note:</emphasis> ONVIF Client may return the same CA certificate in subsequent invocations of this procedure for the same subject.
      </para>
    </section>
    <!--A.31-->
    <section xml:id="Annex_HelperDetermineRSAKeyLength" xreflabel="Annex A.31">
      <title>Determine RSA key length</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperDetermineRSAKeyLength
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to determine the RSA key length to use during testing.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Security Configuration Service is received from the DUT. On-board RSA key pair generation is supported by the DUT as indicated by the RSAKeyPairGeneration capability.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> The smallest supported RSA key length (<emphasis role="italic">keyLength</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
            <para>
              ONVIF Client gets the service capabilities (out <emphasis role="italic">cap</emphasis>) by the following the procedure mentioned in <xref linkend="Annex_HelperGetServiceCapabilities"/>.
            </para>
          </listitem>
          <listitem>
            <para>
              ONVIF Client loops through the supported Key length list (<emphasis role="italic">cap</emphasis>.RSAKeyLengths) and selects the smallest supported key length (<emphasis role="italic">keyLength</emphasis>).
            </para>
          </listitem>

        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              No supported key length was found at step 2.
            </para>
          </listitem>

        </itemizedlist>
      </para>
    </section>
    <!--A.32-->
    <section xml:id="Annex_HelperGetMetadataConfigurationsList" xreflabel="Annex A.32">
      <title>Get Metadata Configurations List</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperGetMetadataConfigurationsList
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to retrieve Metadata Configurations List.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Media2 Service is received from the DUT. Metadata feature under Media2 Service is supported by the DUT. Option for namespaces declartion.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Metadata Configurations List (<emphasis role="italic">metadataConfList</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
                          <para>                            
                            All requests to the DUT shall have requested namespaces definition (see corresponding option in <link linkend="Annex_namespaces_examples">Annex A.11</link>)
                          </para>
                        </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetMetadataConfigurations</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    ConfigurationToken skipped
                  </para>
                </listitem>
                <listitem>
                  <para>
                    ProfileToken skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetMetadataConfigurationsResponse</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Configurations list =: <emphasis role="italic">metadataConfList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">metadataConfList</emphasis> is empty, FAIL the test.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetMetadataConfigurationsResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
  <!--A.33-->
  <section xml:id="Annex_HelperGetMetadataConfiguration" xreflabel="Annex A.33">
      <title>Get Metadata Configuration</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperGetMetadataConfiguration
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to retrieve Metadata Configuration.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Media2 Service is received from the DUT. Metadata feature under Media2 Service is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> Token of Metadata Configuration (<emphasis role="italic">configurationToken</emphasis>). Option for namespaces declartion.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> Metadata Configuration (<emphasis role="italic">metadataConf</emphasis>).
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>
          <listitem>
                          <para>                            
                            All requests to the DUT shall have requested namespaces definition (see corresponding option in <link linkend="Annex_namespaces_examples">Annex A.11</link>)
                          </para>
                        </listitem>
          <listitem>
            <para>
              ONVIF Client invokes <emphasis role="bold">GetMetadataConfigurations</emphasis> request with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    ConfigurationToken := <emphasis role="italic">configurationToken</emphasis>
                  </para>
                </listitem>
                <listitem>
                  <para>
                    ProfileToken skipped
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              The DUT responds with <emphasis role="bold">GetMetadataConfigurationsResponse</emphasis> with parameters
              <itemizedlist>
                <listitem>
                  <para>
                    Configurations list =: <emphasis role="italic">metadataConfList</emphasis>
                  </para>
                </listitem>
              </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
              If <emphasis role="italic">metadataConfList</emphasis> is empty, FAIL the test.
            </para>
          </listitem>
         <listitem>
            <para>
              Set <emphasis role="italic">metadataConfList</emphasis>[0] =: <emphasis role="italic">metadataConf</emphasis>.
            </para>
          </listitem>
         <listitem>
            <para>
              If <emphasis role="italic">metadataConf</emphasis>.token != <emphasis role="italic">configurationToken</emphasis>, FAIL the test.
            </para>
          </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">GetMetadataConfigurationsResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
  <!--A.34-->
<section xml:id="Annex_HelperSetMetadataConfiguration" xreflabel="Annex A.34">
      <title>Set Metadata Configuration For Namespace Handling Test Cases</title>
      <para>
        <emphasis role="bold">Name:</emphasis> HelperSetMetadataConfigurationForNamespaceHandling
      </para>
      <para>
        <emphasis role="bold">Procedure Purpose:</emphasis> Helper procedure to change Metadata Configuration with different namespaces definition.
      </para>
      <para>
        <emphasis role="bold">Pre-requisite:</emphasis> Media2 Service is received from the DUT. Metadata feature under Media2 Service is supported by the DUT.
      </para>
      <para>
        <emphasis role="bold">Input:</emphasis> Metadata Configuration (<emphasis role="italic">metadataConf</emphasis>). Option for namespaces declartion.
      </para>
      <para>
        <emphasis role="bold">Returns:</emphasis> None.
      </para>
      <para>
        <emphasis role="bold">Procedure:</emphasis>
      </para>
      <para>
        <orderedlist>
          <?dbfo label-width="1.5em"?>          
           <listitem>
                          <para>                            
                            All requests to the DUT shall have requested namespaces definition (see corresponding option in <link linkend="Annex_namespaces_examples">Annex A.11</link>)
                          </para>
                        </listitem>
          <listitem>
                    <para>
                      ONVIF Client invokes <emphasis role="bold">SetMetadataConfiguration</emphasis> request with parameters
                      <itemizedlist>
                        <listitem>
                          <para>                            
                            Configuration.@token := <emphasis role="italic">metadataConfList</emphasis>[0].@token
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.Name := "TestName1"
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.UseCount := <emphasis role="italic">metadataConfList</emphasis>[0].UseCount
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.CompressionType := <emphasis role="italic">metadataConfList</emphasis>[0].CompressionType
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.GeoLocation := <emphasis role="italic">metadataConfList</emphasis>[0].GeoLocation
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.ShapePolygon := <emphasis role="italic">metadataConfList</emphasis>[0].ShapePolygon
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.PTZStatus := <emphasis role="italic">metadataConfList</emphasis>[0].PTZStatus
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.Events := <emphasis role="italic">metadataConfList</emphasis>[0].Events
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.Analytics := <emphasis role="italic">metadataConfList</emphasis>[0].Analytics
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.Multicast := <emphasis role="italic">metadataConfList</emphasis>[0].Multicast
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.SessionTimeout := <emphasis role="italic">metadataConfList</emphasis>[0].SessionTimeout
                          </para>
                        </listitem>
                        <listitem>
                          <para>
                            Configuration.AnalyticsEngineConfiguration := <emphasis role="italic">metadataConfList</emphasis>[0].AnalyticsEngineConfiguration
                          </para>
                        </listitem>
                      </itemizedlist>
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      DUT responds with <emphasis role="bold">SetMetadataConfigurationResponse</emphasis> message.
                    </para>
                  </listitem>
        </orderedlist>
      </para>
      <para>
        <emphasis role="bold">Procedure Result:</emphasis>
      </para>
      <para>
        <emphasis role="bold">PASS –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT passes all assertions.
            </para>
          </listitem>
        </itemizedlist>
      </para>
      <para>
        <emphasis role="bold">FAIL –</emphasis>
        <itemizedlist>
          <listitem>
            <para>
              DUT did not send <emphasis role="bold">SetMetadataConfigurationResponse</emphasis> message.
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
  </appendix>
</book>